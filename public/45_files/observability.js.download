!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("UserExperior",[],t):"object"==typeof exports?exports.UserExperior=t():e.UserExperior=t()}(self,(()=>(()=>{"use strict";var e={733:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});const n={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},s={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},o={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},i={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},a={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class l{static getFirstMatch(e,t){const r=t.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,t){const r=t.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,t,r){if(e.test(t))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const t=e.split(".").splice(0,2).map((e=>parseInt(e,10)||0));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const t=e.split(".").splice(0,2).map((e=>parseInt(e,10)||0));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,r=!1){const n=l.getVersionPrecision(e),s=l.getVersionPrecision(t);let o=Math.max(n,s),i=0;const a=l.map([e,t],(e=>{const t=o-l.getVersionPrecision(e),r=e+new Array(t+1).join(".0");return l.map(r.split("."),(e=>new Array(20-e.length).join("0")+e)).reverse()}));for(r&&(i=o-Math.min(n,s)),o-=1;o>=i;){if(a[0][o]>a[1][o])return 1;if(a[0][o]===a[1][o]){if(o===i)return 0;o-=1}else if(a[0][o]<a[1][o])return-1}}static map(e,t){const r=[];let n;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r}static find(e,t){let r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){const n=e[r];if(t(n,r))return n}}static assign(e,...t){const r=e;let n,s;if(Object.assign)return Object.assign(e,...t);for(n=0,s=t.length;n<s;n+=1){const e=t[n];if("object"==typeof e&&null!==e){Object.keys(e).forEach((t=>{r[t]=e[t]}))}}return e}static getBrowserAlias(e){return n[e]}static getBrowserTypeByAlias(e){return s[e]||""}}const c=/version\/(\d+(\.?_?\d+)+)/i,d=[{test:[/googlebot/i],describe(e){const t={name:"Googlebot"},r=l.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/opera/i],describe(e){const t={name:"Opera"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe(e){const t={name:"Opera"},r=l.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe(e){const t={name:"Samsung Internet for Android"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe(e){const t={name:"NAVER Whale Browser"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe(e){const t={name:"MZ Browser"},r=l.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/focus/i],describe(e){const t={name:"Focus"},r=l.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/swing/i],describe(e){const t={name:"Swing"},r=l.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/coast/i],describe(e){const t={name:"Opera Coast"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(e){const t={name:"Opera Touch"},r=l.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe(e){const t={name:"Yandex Browser"},r=l.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe(e){const t={name:"UC Browser"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe(e){const t={name:"Maxthon"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe(e){const t={name:"Epiphany"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe(e){const t={name:"Puffin"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe(e){const t={name:"Sleipnir"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe(e){const t={name:"K-Meleon"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe(e){const t={name:"WeChat"},r=l.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe(e){const t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=l.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe(e){const t={name:"Internet Explorer"},r=l.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe(e){const t={name:"Microsoft Edge"},r=l.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe(e){const t={name:"Microsoft Edge"},r=l.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe(e){const t={name:"Vivaldi"},r=l.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe(e){const t={name:"SeaMonkey"},r=l.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe(e){const t={name:"Sailfish"},r=l.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe(e){const t={name:"Amazon Silk"},r=l.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe(e){const t={name:"PhantomJS"},r=l.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe(e){const t={name:"SlimerJS"},r=l.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t={name:"BlackBerry"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe(e){const t={name:"WebOS Browser"},r=l.getFirstMatch(c,e)||l.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe(e){const t={name:"Bada"},r=l.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe(e){const t={name:"Tizen"},r=l.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe(e){const t={name:"QupZilla"},r=l.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe(e){const t={name:"Firefox"},r=l.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe(e){const t={name:"Electron"},r=l.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe(e){const t={name:"Chromium"},r=l.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe(e){const t={name:"Chrome"},r=l.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe(e){const t={name:"Google Search"},r=l.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test(e){const t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe(e){const t={name:"Android Browser"},r=l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe(e){const t={name:"PlayStation 4"},r=l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe(e){const t={name:"Safari"},r=l.getFirstMatch(c,e);return r&&(t.version=r),t}},{test:[/.*/i],describe(e){const t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:l.getFirstMatch(t,e),version:l.getSecondMatch(t,e)}}}],u=d,h=[{test:[/Roku\/DVP/],describe(e){const t=l.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.Roku,version:t}}},{test:[/windows phone/i],describe(e){const t=l.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.WindowsPhone,version:t}}},{test:[/windows /i],describe(e){const t=l.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=l.getWindowsVersionName(t);return{name:i.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(e){const t={name:i.iOS},r=l.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe(e){const t=l.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=l.getMacOSVersionName(t),n={name:i.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe(e){const t=l.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.iOS,version:t}}},{test(e){const t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe(e){const t=l.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=l.getAndroidVersionName(t),n={name:i.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe(e){const t=l.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:i.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t=l.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||l.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||l.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.BlackBerry,version:t}}},{test:[/bada/i],describe(e){const t=l.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.Bada,version:t}}},{test:[/tizen/i],describe(e){const t=l.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.Tizen,version:t}}},{test:[/linux/i],describe:()=>({name:i.Linux})},{test:[/CrOS/],describe:()=>({name:i.ChromeOS})},{test:[/PlayStation 4/],describe(e){const t=l.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.PlayStation4,version:t}}}],p=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(e){const t=l.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:o.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:o.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:o.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:o.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:o.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:o.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:o.tablet})},{test(e){const t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe(e){const t=l.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:o.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:o.mobile})},{test:e=>"blackberry"===e.getBrowserName(!0),describe:()=>({type:o.mobile,vendor:"BlackBerry"})},{test:e=>"bada"===e.getBrowserName(!0),describe:()=>({type:o.mobile})},{test:e=>"windows phone"===e.getBrowserName(),describe:()=>({type:o.mobile,vendor:"Microsoft"})},{test(e){const t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:()=>({type:o.tablet})},{test:e=>"android"===e.getOSName(!0),describe:()=>({type:o.mobile})},{test:e=>"macos"===e.getOSName(!0),describe:()=>({type:o.desktop,vendor:"Apple"})},{test:e=>"windows"===e.getOSName(!0),describe:()=>({type:o.desktop})},{test:e=>"linux"===e.getOSName(!0),describe:()=>({type:o.desktop})},{test:e=>"playstation 4"===e.getOSName(!0),describe:()=>({type:o.tv})},{test:e=>"roku"===e.getOSName(!0),describe:()=>({type:o.tv})}],m=[{test:e=>"microsoft edge"===e.getBrowserName(!0),describe(e){if(/\sedg\//i.test(e))return{name:a.Blink};const t=l.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:a.EdgeHTML,version:t}}},{test:[/trident/i],describe(e){const t={name:a.Trident},r=l.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:e=>e.test(/presto/i),describe(e){const t={name:a.Presto},r=l.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test(e){const t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe(e){const t={name:a.Gecko},r=l.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:a.Blink})},{test:[/(apple)?webkit/i],describe(e){const t={name:a.WebKit},r=l.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];const f=class{constructor(e,t=!1){if(null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=l.find(u,(e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some((e=>this.test(e)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=l.find(h,(e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some((e=>this.test(e)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};const e=l.find(p,(e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some((e=>this.test(e)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=l.find(m,(e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some((e=>this.test(e)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return l.assign({},this.parsedResult)}satisfies(e){const t={};let r=0;const n={};let s=0;if(Object.keys(e).forEach((o=>{const i=e[o];"string"==typeof i?(n[o]=i,s+=1):"object"==typeof i&&(t[o]=i,r+=1)})),r>0){const e=Object.keys(t),r=l.find(e,(e=>this.isOS(e)));if(r){const e=this.satisfies(t[r]);if(void 0!==e)return e}const n=l.find(e,(e=>this.isPlatform(e)));if(n){const e=this.satisfies(t[n]);if(void 0!==e)return e}}if(s>0){const e=Object.keys(n),t=l.find(e,(e=>this.isBrowser(e,!0)));if(void 0!==t)return this.compareVersion(n[t])}}isBrowser(e,t=!1){const r=this.getBrowserName().toLowerCase();let n=e.toLowerCase();const s=l.getBrowserTypeByAlias(n);return t&&s&&(n=s.toLowerCase()),n===r}compareVersion(e){let t=[0],r=e,n=!1;const s=this.getBrowserVersion();if("string"==typeof s)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(l.compareVersions(s,r,n))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e){return this.isBrowser(e)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some((e=>this.is(e)))}};const g=class{static getParser(e,t=!1){if("string"!=typeof e)throw new Error("UserAgent should be a string");return new f(e,t)}static parse(e){return new f(e).getResult()}static get BROWSER_MAP(){return s}static get ENGINE_MAP(){return a}static get OS_MAP(){return i}static get PLATFORMS_MAP(){return o}}},207:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(593),o=r(789),i=r(605),a=r(902),l=r(495),c=n(r(737));async function d(e,t={},r=0,n=0){try{const r=await fetch(e,t);if(422===r.status)return r;if(!r.ok&&401!==r.status)throw new Error(`HTTP error! status: ${r.status}`);return r}catch(s){if(r>0)return await new Promise((e=>setTimeout(e,n))),d(e,t,r-1,n);throw s}}t.default=class{constructor(e,t,r,n,s,o,i){this.projectKey=e,this.sessionId=t,this.tabId=r,this.releaseVersion=n,this.domNavigationTimingsSent=!1,this.resetSessionDetails=s,this.baseUrl=o,this.revuToken=i}async createSession(e){const t=await this.sendRequest(s.INITILIZE_SESSION_PATH,e);return!(t<200||t>=300)||(422===t?(this.resetSessionDetails(),!1):(console.error("Session creation failed because API did not give 2xx response!"),!1))}sendUser(e){this.sendRequest(s.INITILIZE_USER_PATH,{...e,releaseVersion:this.releaseVersion})}sendCustomMetaData(e){this.sendRequest(s.SEND_CUSTOM_METADATA,e)}sendLogs(e=!1,t){let r={sessionReplay:l.sessionEvents,consoleLogs:o.consoleLogs,networkLogs:i.networkLogs,eventLogs:a.eventLogs,events:l.logEvents,sequence:l.sequenceNumber,releaseVersion:this.releaseVersion};if("complete"===document.readyState&&!this.domNavigationTimingsSent){performance.getEntriesByType("navigation").forEach((e=>{r={...r,domNavigationTimings:e.toJSON()}}))}(r.sessionReplay.length>0||r.consoleLogs.length>0||r.networkLogs.length>0||r.eventLogs.length>0||r.events.length>0||e)&&(r.hasOwnProperty("domNavigationTimings")&&(this.domNavigationTimingsSent=!0),this.sendRequest(s.SEND_LOGS_PATH,r,"POST",0).then((e=>{401===e?(t(),console.warn("UserExperior: the recording has been stopped, the version key is invalid or your session limit has reached.")):422===e&&this.resetSessionDetails()})).catch((e=>{console.log(e)})),(0,l.setLastUploadedTime)(),(0,l.resetSessionEvents)(),(0,o.resetConsoleData)(),(0,i.resetNetworkData)(),(0,a.resetEventData)(),(0,l.resetLogEvents)(),(0,l.increaseSequenceNumber)())}async sendRequest(e,t,r="POST",n=3){if(null==t||0===Object.keys(t).length)return-1;let s={versionKey:this.projectKey,sessionId:this.sessionId,tabId:this.tabId,timestamp:Math.floor((new Date).getTime()),releaseVersion:this.releaseVersion,...t},o={"Content-Type":"application/json","ue-vk":this.projectKey,"ue-session-id":this.sessionId};this.revuToken&&(o.Authorization=this.revuToken);const i=await(0,c.default)(JSON.stringify(s));i.length>0&&(o={...o,"Content-Encoding":"gzip"},s=i);try{o.hasOwnProperty("Content-Encoding")||(s=JSON.stringify(s));return(await d(this.baseUrl+e,{method:r,headers:o,body:s},n)).status}catch(e){return console.log(e),-1}}}},495:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.increaseSequenceNumber=t.setLastUploadedTime=t.resetLogEvents=t.resetSessionEvents=t.sequenceNumber=t.lastUploadedTime=t.logEvents=t.sessionEvents=t.isRecording=void 0;const s=r(614),o=r(408),i=r(789),a=r(605),l=r(214),c=n(r(207)),d=r(593),u=r(569),h=r(48),p=r(552),m=r(902),f=r(674);t.isRecording=!1,t.sessionEvents=[],t.logEvents=[],t.sequenceNumber=0;t.resetSessionEvents=()=>{t.sessionEvents=[]};t.resetLogEvents=()=>{t.logEvents=[]};t.setLastUploadedTime=()=>{t.lastUploadedTime=Math.floor(Date.now()/1e3),localStorage.setItem(d.UE_LAST_UPLOAD,t.lastUploadedTime.toString())};t.increaseSequenceNumber=()=>{t.sequenceNumber=t.sequenceNumber+1};t.default=class{constructor(e,t,r,n,o){var i,a;this.checkInputSessionDetails=()=>{var e,t;const r=null===(e=this.options.sessionDetails)||void 0===e?void 0:e.sessionId,n=null===(t=this.options.sessionDetails)||void 0===t?void 0:t.tabId;r&&(localStorage.setItem(d.UE_LAST_UPLOAD,Math.floor(Date.now()/1e3).toString()),localStorage.setItem(d.UE_SESSION_ID,r),sessionStorage.setItem(d.UE_SESSION_ID,r)),n&&sessionStorage.setItem(d.UE_TAB,n)},this.resetSessionDetails=()=>{this.options.sessionDetails=void 0,localStorage.removeItem(d.UE_SESSION_ID),sessionStorage.removeItem(d.UE_SESSION_ID),sessionStorage.removeItem(d.UE_TAB),this.startRecording()},this.projectKey=e,this.sessionToken="",this.userId=null,this.userProperties={},this.tabId=(0,s.v4)(),this.options=t,this.startSessionHandler=this.startRecording.bind(this),this.stopSessionHandler=this.stopRecording.bind(this),this.captureMouseMove=!!t.sessionReplay.captureMouseMove&&t.sessionReplay.captureMouseMove,this.captureConsoleLogs=0!=t.sessionReplay.captureConsoleLogs,this.captureNetworkLogs=0!=t.sessionReplay.captureNetworkLogs,this.capturePerformance=null===(i=t.sessionReplay.capturePerformance)||void 0===i||i,this.enableUserId=t.sessionReplay.enableUserId||!1,this.recordCrossOriginIframes=t.sessionReplay.recordCrossOriginIframes||!0,this.releaseVersion=r||null,this.captureConsoleLogTypes=t.sessionReplay.captureConsoleLogTypes,this.isChildIframe=null!==(a=t.sessionReplay.isChildIframe)&&void 0!==a&&a,this.revuToken=n||null,this.ingestionHost=o||null}async startRecording(){if(!t.isRecording){if(this.isChildIframe)return void this.initalizeSessionRecording();this.checkInputSessionDetails(),this.sessionToken=(0,s.v4)(),this.tabId=(0,s.v4)();const e=localStorage.getItem(d.UE_SESSION_ID)||sessionStorage.getItem(d.UE_SESSION_ID),t=localStorage.getItem(d.UE_LAST_UPLOAD),r=Math.floor(Date.now()/1e3);let n="Anonymous";const o=`${window.navigator.userAgent}-${window.navigator.platform}-${window.innerHeight}-${window.innerWidth}-${Date.now()}-${this.sessionToken.split("-")[0]}`;if(this.enableUserId){n=`Anon-${(0,p.hashFunction)(o)}`}!e||t&&r-parseInt(t)>=d.DEFAULT_SESSION_THROTTLE?(localStorage.setItem(d.UE_SESSION_ID,this.sessionToken),sessionStorage.setItem(d.UE_SESSION_ID,this.sessionToken)):this.sessionToken=e;const i=sessionStorage.getItem(d.UE_TAB);i?this.tabId=i:sessionStorage.setItem(d.UE_TAB,this.tabId);const a=this.ingestionHost?this.ingestionHost+"/api/ingest":d.DEFAULT_BASE_URL;this.api=new c.default(this.projectKey,this.sessionToken,this.tabId,this.releaseVersion,this.resetSessionDetails,a,this.revuToken);await this.api.createSession({sessionMetaData:(0,l.getBrowserData)(),identifier:(0,d.getDurableStorageItem)(d.USER_IDENTIFIER)||n,userProperties:JSON.parse((0,d.getDurableStorageItem)(d.USER_PROPERTIES)||"null"),customMetadata:JSON.parse((0,d.getDurableStorageItem)(d.CUSTOM_METADATA)||"null"),sdkVersion:d.SDK_VERSION,releaseVersion:this.releaseVersion})?this.initalizeSessionRecording():console.error("Failed to create session, recording not initialized.")}}setUserIdentifier(e,t={}){if(null==e||"string"!=typeof e)return void console.error("UserExperior: user id is missing or wrong type (string is expected). Please check documentation for more information.");Object.keys(t).length>0&&Object.keys(t).length!==Object.keys(t).filter((e=>"string"==typeof e)).length?console.error("UserExperior: user properties expect key value pairs of string only. Please check documentation for more information."):setTimeout((()=>{var r;e&&(this.userId=e,this.userProperties=t,null===(r=this.api)||void 0===r||r.sendUser({user:this.userId,userProperties:this.userProperties}),(0,d.setDurableStorageItem)(d.USER_IDENTIFIER,e),(0,d.setDurableStorageItem)(d.USER_PROPERTIES,JSON.stringify(t)))}),1)}setUserProperties(e){var t;Object.keys(e).length&&(null===(t=this.api)||void 0===t||t.sendUser({user:this.userId,userProperties:e}))}initalizeSessionRecording(){t.isRecording=!0,this.isChildIframe||(this.userIdleTrackerInstance=new u.UserIdleTracker(this.startSessionHandler,this.stopSessionHandler),(0,t.setLastUploadedTime)(),this.captureConsoleLogs&&(0,i.initalizeConsoleLog)(this.captureConsoleLogTypes),this.captureNetworkLogs&&(0,a.initalizeNetworkLog)(),this.capturePerformance&&(0,f.initPerformanceCapturing)(),(0,m.initPageChangeTracking)()),this.recorderInstance=(0,o.record)({emit(e){(0,h.processEvent)(e),t.sessionEvents.push(e)},recordCrossOriginIframes:this.recordCrossOriginIframes,blockClass:d.DEFAULT_SESSION_REPLAY_BLOCK_CLASS,maskTextClass:d.DEFAULT_SESSION_REPLAY_MASK_CLASS,maskAllInputs:this.options.sessionReplay.maskAllInputs,maskInputOptions:this.options.sessionReplay.maskInputOptions,inlineImages:d.CAPTURE_IMAGES_INLINE,inlineStylesheet:d.CAPTURE_INLINE_STYLESHEET,maskInputClass:d.MASK_INPUT_CLASS,sampling:{input:"last",mousemove:this.captureMouseMove},maskTextFn:this.options.sessionReplay.maskTextFn}),this.isChildIframe||(this.options.sessionReplay.livePolling?this.logIntervalInstance=setInterval((()=>{var e;return null===(e=this.api)||void 0===e?void 0:e.sendLogs(!1,this.stopRecording.bind(this))}),d.LIVE_POLL_FREQUENCY):this.logIntervalInstance=setInterval((()=>{var e;return null===(e=this.api)||void 0===e?void 0:e.sendLogs(!1,this.stopRecording.bind(this))}),d.NORMAL_POLL_FREQUENCY))}addMetaData(e={}){var t;Object.keys(e).length>0&&Object.keys(e).length!==Object.keys(e).filter((e=>"string"==typeof e)).length?console.error("UserExperior: metadata properties expect key value pairs of string only. Please check documentation for more information."):(null===(t=this.api)||void 0===t||t.sendCustomMetaData({properties:e}),setTimeout((()=>{(0,d.setDurableStorageItem)(d.CUSTOM_METADATA,JSON.stringify(e))}),1))}logEvent(e,r={}){t.logEvents.push({event:e,event_details:r,epochTime:Math.floor(Date.now()/1e3),timestamp:Date.now()})}unsetUserIdentifier(){this.clearIdentifier()}stopRecording(e=!0){t.isRecording&&(localStorage.removeItem(d.UE_SESSION_ID),sessionStorage.removeItem(d.UE_SESSION_ID),this.recorderInstance&&this.recorderInstance(),t.isRecording=!1,this.logIntervalInstance&&clearInterval(this.logIntervalInstance),this.userIdleTrackerInstance&&this.userIdleTrackerInstance.cleanUpTracker(),e&&this.clearIdentifier(),this.capturePerformance&&(0,f.uninitPerformanceCapturing)(),(0,m.uninitPageChangeTracking)())}restartSession(e=!1){var r;t.isRecording&&(null===(r=this.api)||void 0===r||r.sendLogs(!0,this.stopRecording.bind(this)),localStorage.removeItem(d.UE_SESSION_ID),sessionStorage.removeItem(d.UE_SESSION_ID),this.recorderInstance&&this.recorderInstance(),t.isRecording=!1,this.logIntervalInstance&&clearInterval(this.logIntervalInstance),this.userIdleTrackerInstance&&this.userIdleTrackerInstance.cleanUpTracker(),e&&this.clearIdentifier(),this.capturePerformance&&(0,f.uninitPerformanceCapturing)(),(0,m.uninitPageChangeTracking)(),this.startRecording())}getSessionDetails(){return{sessionId:this.sessionToken,tabId:this.tabId,versionKey:this.projectKey}}triggerStopRecording(){var e;t.isRecording&&((0,m.pushRecordingStopped)(document.location.href,document.title),null===(e=this.api)||void 0===e||e.sendLogs(!0,(()=>{})),this.stopRecording())}clearIdentifier(){this.userId&&(this.userId=null),(0,d.clearDurableStorageItem)(d.USER_IDENTIFIER),(0,d.clearDurableStorageItem)(d.USER_PROPERTIES),(0,d.clearDurableStorageItem)(d.CUSTOM_METADATA)}}},569:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserIdleTracker=void 0;const n=r(593);t.UserIdleTracker=class{constructor(e,t){this.activityTimeout=n.DEFAULT_INACTIVITY_THROTTLE,this.visiblityTimeout=n.DEFAULT_VISIBILITY_THROTTLE,this.interval=void 0,this.activeInterval=void 0,this.startSession=e,this.stopSession=t,this.handleActivityEvent=this.updateSessionExpireTime.bind(this),this.handlePageVisiblityEvent=this.pageVisibilityEventHandler.bind(this),this.handleResumeActivityEvent=this.resumeActivityTracker.bind(this),this.initalizeTracker(),this.startActivityTracker()}updateSessionExpireTime(){this.timeOutTracker&&clearTimeout(this.timeOutTracker),this.timeOutTracker=setTimeout((()=>{(0,n.setSessionStorageItem)(n.UE_SESSION_EXPIRE,(Date.now()+1e3*this.activityTimeout).toString())}),n.DEFAULT_INACTIVITY_COOLING_PERIOD)}startActivityTracker(){this.updateSessionExpireTime(),this.interval=setInterval((()=>{parseInt((0,n.getSessionStorageItem)(n.UE_SESSION_EXPIRE)||"0",10)<Date.now()&&((0,n.setSessionStorageItem)(n.RESTART_SESSION,"true"),this.stopSession(!1),this.initalizeActivityResumeTracker())}),n.ONE_MINUTE),this.activeInterval=setInterval((()=>{document.hidden||(0,n.setSessionStorageItem)(n.UE_SESSION_ACTIVE,Date.now().toString())}),n.ONE_MINUTE)}pageVisibilityEventHandler(){if(document.hidden)this.pageVisibleTimeout=setTimeout((()=>{const e=parseInt((0,n.getSessionStorageItem)(n.UE_SESSION_ACTIVE)||"0",10);Math.floor((Date.now()-e)/1e3)>=this.visiblityTimeout&&((0,n.setSessionStorageItem)(n.RESTART_SESSION,"true"),this.stopSession(!1),this.initalizeActivityResumeTracker())}),1e3*this.visiblityTimeout);else{const e=parseInt((0,n.getSessionStorageItem)(n.UE_SESSION_ACTIVE)||"0",10);Math.floor((Date.now()-e)/1e3)<this.visiblityTimeout&&clearTimeout(this.pageVisibleTimeout)}}resumeActivityTracker(){if(!document.hidden){const e=(0,n.getSessionStorageItem)(n.RESTART_SESSION);e&&"true"===e&&(sessionStorage.removeItem(n.RESTART_SESSION),this.cleanUpActivityResumeTracker(),this.startSession())}}initalizeTracker(){window.addEventListener("click",this.handleActivityEvent),window.addEventListener("scroll",this.handleActivityEvent),window.addEventListener("keydown",this.handleActivityEvent),window.addEventListener("visibilitychange",this.handlePageVisiblityEvent)}cleanUpTracker(){clearInterval(this.interval),clearInterval(this.activeInterval),clearTimeout(this.pageVisibleTimeout),window.removeEventListener("click",this.handleActivityEvent),window.removeEventListener("scroll",this.handleActivityEvent),window.removeEventListener("keydown",this.handleActivityEvent),window.removeEventListener("visibilitychange",this.handlePageVisiblityEvent)}initalizeActivityResumeTracker(){window.addEventListener("visibilitychange",this.handleResumeActivityEvent),window.addEventListener("click",this.handleResumeActivityEvent),window.addEventListener("scroll",this.handleResumeActivityEvent),window.addEventListener("keydown",this.handleResumeActivityEvent)}cleanUpActivityResumeTracker(){window.removeEventListener("visibilitychange",this.handleResumeActivityEvent),window.removeEventListener("click",this.handleResumeActivityEvent),window.removeEventListener("scroll",this.handleResumeActivityEvent),window.removeEventListener("keydown",this.handleResumeActivityEvent)}}},607:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const s=n(r(495)),o=r(214),i=r(593),a=r(699),l=[a.CONSOLE_LOG_TYPES.WARN,a.CONSOLE_LOG_TYPES.ERROR];class c{constructor(e,t){this.app=null,this.UE_NOT_INITIALIZED="UserExperior is not initialized. Please check documentation for more information.",this.defaultOptions={sessionReplay:{maskAllInputs:i.MASK_ALL_INPUTS,maskInputOptions:i.DEFAULT_MASK_INPUT_OPTIONS,recordCrossOriginIframes:!0,captureConsoleLogTypes:l}},this.sessionUrl=(0,o.getSessionUrl)(),this.revuToken=e,this.ingestionHost=t}startRecording(e,t=this.defaultOptions,r=null){var n;if(!i.IN_BROWSER)return console.error("UserExperior: You are trying to start UserExperior on a node.js environment."),Promise.reject("UserExperior: You are trying to start UserExperior on a node.js environment.");if(!e||"string"!=typeof e)return console.error("UserExperior: version-key is missing or wrong (string is expected). Please check documentation for more information."),Promise.reject("UserExperior: version-key is missing or wrong (string is expected). Please check documentation for more information.");if(null===t||t.constructor!==Object)return console.error("UserExperior: options is wrong (object is expected). Please check documentation for more information."),Promise.reject("UserExperior: options is wrong (object is expected). Please check documentation for more information.");if(Object.keys(t).includes("sessionReplay")?t.sessionReplay={...this.defaultOptions.sessionReplay,...t.sessionReplay}:t={...this.defaultOptions,...t},t.sessionDetails&&t.sessionDetails.sessionId&&"string"!=typeof t.sessionDetails.sessionId)return console.error("UserExperior: session id is wrong (string is expected). Please check documentation for more information."),Promise.reject("UserExperior: session id is wrong (string is expected). Please check documentation for more information.");if(t.sessionDetails&&t.sessionDetails.tabId&&"string"!=typeof t.sessionDetails.tabId)return console.error("UserExperior: tab id is wrong (string is expected). Please check documentation for more information."),Promise.reject("UserExperior: tab id is wrong (string is expected). Please check documentation for more information.");if("string"!=typeof r&&null!==r)return console.error("UserExperior: release version is wrong (string is expected). Please check documentation for more information."),Promise.reject("UserExperior: release version is wrong (string is expected).Please check documentation for more information.");if(null===(n=t.sessionReplay.captureConsoleLogTypes)||void 0===n?void 0:n.length){const e=[],r=[];for(const n of t.sessionReplay.captureConsoleLogTypes)this.isValidLogType(n)?(t.sessionReplay.captureConsoleLogTypes=l,e.push(n)):r.push(n);const n=Object.values(a.CONSOLE_LOG_TYPES).join(", ");r.length&&console.warn(`Invalid log type '${r.join(", ")}' passed to captureConsoleLogTypes. Allowed types are: ${n}`),t.sessionReplay.captureConsoleLogTypes=e}return this.app=new s.default(e,t,r,this.revuToken,this.ingestionHost),this.app.startRecording()}setUserIdentifier(e,t){e&&"string"==typeof e&&null!==this.app?this.app.setUserIdentifier(e,t):console.error(this.app?"UserExperior: user id is missing or wrong type (string is expected). Please check documentation for more information.":this.UE_NOT_INITIALIZED)}addMetaData(e){null!==this.app&&null!=e&&e.constructor===Object?this.app.addMetaData(e):console.error(this.app?"UserExperior: metadata is missing or wrong type (object is expected). Please check documentation for more information.":this.UE_NOT_INITIALIZED)}setUserProperties(e){null!==this.app&&e&&null!==e&&e.constructor===Object?this.app.setUserProperties(e):console.error(this.app?"UserExperior: user properties is missing or wrong type (object is expected). Please check documentation for more information.":this.UE_NOT_INITIALIZED)}logEvent(e,t){null!==this.app&&e&&"string"==typeof e?null===t||void 0!==t&&t.constructor!==Object?console.error("UserExperior: event props is wrong type (object is expected). Please check documentation for more information."):this.app.logEvent(e,t):console.error(this.app?"UserExperior: log event is missing or wrong type (string is expected). Please check documentation for more information.":this.UE_NOT_INITIALIZED)}getSessionDetails(){if(null!==this.app)return this.app.getSessionDetails()}unsetUserIdentifier(){null!==this.app&&this.app.unsetUserIdentifier()}restartSession(){null!==this.app&&this.app.restartSession(!0)}getNormalizedUrl(){return this.getNormalizedUrl()}isValidLogType(e){return Object.values(a.CONSOLE_LOG_TYPES).includes(e)}stopRecording(){if(null!==this.app)return this.app.triggerStopRecording()}}t.default=c,t.init=c},435:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeDeadClick=void 0;const n=r(902);t.removeDeadClick=()=>{n.lastClickArrayIndex&&n.eventLogs[n.lastClickArrayIndex]&&n.eventLogs[n.lastClickArrayIndex].hasOwnProperty("isDead")&&delete n.eventLogs[n.lastClickArrayIndex].isDead}},902:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uninitPageChangeTracking=t.initPageChangeTracking=t.newListener=t.pushRecordingStopped=t.resetEventData=t.lastClickArrayIndex=t.eventLogs=void 0;const n=r(593),s=r(674);t.eventLogs=[];let o,i=document.location.href,a=document.title;t.resetEventData=()=>{t.eventLogs=[]};const l=(e,r)=>{const s={event_type:"nav",pageUrl:e,normalizedUrl:(0,n.getNormalizedUrl)(e),pageName:r,timestamp:Date.now()};t.eventLogs.push(s),i=e,a=r},c=()=>{const e=(0,s.getPerformanceData)(),r={event_type:"perf-capture",pageUrl:i,normalizedUrl:(0,n.getNormalizedUrl)(i),pageName:a,timestamp:Date.now(),performance:e};t.eventLogs.push(r),(0,s.resetPerformanceData)()};t.pushRecordingStopped=(e,r)=>{const s={event_type:"recording-stopped",pageUrl:e,pageName:r,normalizedUrl:(0,n.getNormalizedUrl)(e),timestamp:Date.now()};t.eventLogs.push(s)};const d=e=>{let t=null;try{const r=e.getAttribute("id");if(t=e.getAttribute("data-plug-label")||e.getAttribute("label")||e.getAttribute("aria-label"),t)return t;if(r){const t=document.querySelector(`[for='${r}']`)||document.querySelector(`[aria-labelledby='${r}']`);if(t)return t.innerText||e.tagName}return t=e.getAttribute("placeholder")||e.getAttribute("id")||e.getAttribute("alt")||e.getAttribute("title")||e.getAttribute("name"),t?t:(t=e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement?e.innerText||e.value||e.tagName:e.innerText||e.tagName,u(t,25))}catch(e){return console.warn("Error in fetching label"),"Unknown Element"}},u=(e,t)=>e&&e.length>t?`${e.substring(0,t)}...`:e;t.newListener=(e,r,s,i)=>{if("click"==s){const i={event_type:s,target:(null==e?void 0:e.nodeName)||"",label:(e?d(e):"")||"",value:u((null==e?void 0:e.innerText)||"",50)||"",timestamp:r,epochTime:Math.floor(Date.now()/1e3),isDead:!0,pageUrl:document.location.href,normalizedUrl:(0,n.getNormalizedUrl)(document.location.href),pageName:document.title};!t.eventLogs.length&&i.hasOwnProperty("isDead")&&delete i.isDead,o&&r-o<=n.DEFAULT_RAGE_THROTTLE&&(i.isRage=!0),o=r;const a=t.eventLogs.push(i);t.lastClickArrayIndex=a-1}if("form-change"==s&&i&&"on"!==i){const n={event_type:s,target:(null==e?void 0:e.nodeName)||"",label:(e?d(e):"")||"",value:i,timestamp:r,epochTime:Math.floor(Date.now()/1e3)};t.eventLogs.push(n)}};let h,p,m=!1;t.initPageChangeTracking=()=>{if(!m){l(document.location.href,document.title);try{h=history.pushState,p=history.replaceState,history.pushState=function(...e){const t=h.apply(history,e);return c(),l(document.location.href,document.title),t},history.replaceState=function(...e){const t=p.apply(history,e);return c(),l(document.location.href,document.title),t},m=!0}catch(e){console.error("Failed to initialize page change tracking:",e)}}};t.uninitPageChangeTracking=()=>{if(m)try{history.pushState=h,history.replaceState=p,m=!1}catch(e){console.error("Failed to uninitialize SPA page change tracking:",e)}}},789:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initalizeConsoleLog=t.isErrorLog=t.resetConsoleData=t.consoleLogs=void 0;const n=r(495),s=r(699),o=r(593);t.consoleLogs=[];let i=[];t.resetConsoleData=()=>{t.consoleLogs=[]};t.isErrorLog=e=>!!e&&(e.toLowerCase().includes("error")||e.toLowerCase().includes("fail"));const a=e=>null===e?"null":e.includes("TypeError")?"TypeError":e.includes("ReferenceError")||e.includes("cannot read property")||e.includes("undefined")?"ReferenceError":e.includes("SyntaxError")?"SyntaxError":e.includes("RangeError")?"RangeError":e.includes("URIError")?"URIError":e.includes("AggregateError")?"AggregateError":e.includes("EvalError")?"EvalError":"Error";function l(e){const t=["TypeError","ReferenceError","SyntaxError","RangeError","URIError","EvalError","AggregateError","ERROR"];function r(e,t){const r=e.indexOf("\n",t);let n=-1===r?e.substring(t).trim():e.substring(t,r).trim();return n.startsWith("ERROR")&&(n=n.toLocaleLowerCase().replace(/^ERROR\s+/,"")),n.toLocaleLowerCase().startsWith("Fail")&&(n=n.replace(/^Fail\s+/,"")),n}const n=-1!==e.toLowerCase().indexOf("error")?e.toLowerCase().indexOf("error"):e.toLowerCase().indexOf("fail");if(-1!==n){const t=e.indexOf(":",n);let s;return s=-1!==t?t+1:n,r(e,s)}for(const n of t){const t=e.indexOf(n);if(0===t){return r(e,t+n.length).trim()}if(t>0)return r(e,0)}return r(e,0)}const c=e=>{let t=e.substr(e.lastIndexOf("/")+1).split(":").splice(0,2).join(":");return 0==t.lastIndexOf(":")&&(t="(index)"+t),t},d=e=>`${null==e?void 0:e.message} \n ${null==e?void 0:e.stack}`,u=e=>void 0===e?"undefined":null===e?"null":e instanceof Error?d(e):Array.isArray(e)?`Array(${e.length})`:String(e),h=e=>{if(void 0===e)return"undefined";if(null===e)return"null";if(e instanceof Error)return d(e);if(Array.isArray(e)){return`Array(${e.length})[${e.slice(0,10).map(u).join(", ")}]`}if("object"==typeof e){const t=[];let r=0;for(const n in e){if(10==++r)break;const s=e[n];t.push(n+": "+u(s))}return"{"+t.join(", ")+"}"}return e.toString()},p=e=>{try{"string"==typeof e[0]&&e.unshift(e.shift().replace(/%(o|s|f|d|i)/g,((t,r)=>{const n=e.shift();if(void 0===n)return t;switch(r){case"o":return h(n);case"s":return u(n);case"f":return(e=>"number"!=typeof e?"NaN":e.toString())(n);case"d":case"i":return(e=>"number"!=typeof e?"NaN":Math.floor(e).toString())(n);default:return t}})));let t=e.map(h).join(" ");return t?t.length>o.CONSOLE_MESSAGE_MAX_LENGTH&&(t=(0,o.truncateString)(t)):t="",t}catch(e){return""}},m=(e,r)=>{if(e||(e="log"),n.isRecording){const n=(()=>{try{throw new Error}catch(e){let t=e.stack.substr(e.stack.lastIndexOf("at ")+3);return t&&t.length>o.CONSOLE_MESSAGE_MAX_LENGTH&&(t=(0,o.truncateString)(t)),{full_url:t,short_url:c(t)}}})();let s=p(r);null==s&&(s="");const i={type:e,datetime:Date().toLocaleString(),value:s,epochTime:Math.floor(Date.now()/1e3),properties:{pageUrl:window.location.href,normalizedUrl:(0,o.getNormalizedUrl)(window.location.href),pageName:document.title},...n};"log"===e.toLowerCase()&&(0,t.isErrorLog)(s)||"error"===e.toLowerCase()?t.consoleLogs.push({...i,extra:{errorType:a(s),msg:s,shortMsg:l(s)}}):t.consoleLogs.push(i)}},f=(e,r,s,i,d)=>{let u=`${r} : ${s} : ${i}`;u.length>o.CONSOLE_MESSAGE_MAX_LENGTH&&(u=(0,o.truncateString)(u));const h=c(u);"string"==typeof e?e.length>o.CONSOLE_MESSAGE_MAX_LENGTH&&(e=(0,o.truncateString)(e)):"object"==typeof e&&(e=JSON.stringify(e)).length>o.CONSOLE_MESSAGE_MAX_LENGTH&&(e=(0,o.truncateString)(e));let p="";"object"==typeof d&&(p=JSON.stringify(d),p.length>o.CONSOLE_MESSAGE_MAX_LENGTH&&(p=(0,o.truncateString)(p)));const m=a(e),f=l(e);return n.isRecording&&t.consoleLogs.push({type:"exception",datetime:Date().toLocaleString(),value:e,extra:{errorType:m,msg:e,shortMsg:f,url:r,normalizedUrl:(0,o.getNormalizedUrl)((null==r?void 0:r.toString())||""),lineNo:s,columnNo:i,error:p},epochTime:Math.floor(Date.now()/1e3),full_url:u,short_url:h}),!1},g=e=>{i.forEach((t=>{const r=e[t];e[t]=function(...e){r.apply(this,e),m(t,e)}})),window.onerror=f};let y=!1;t.initalizeConsoleLog=e=>{y||(e.includes(s.CONSOLE_LOG_TYPES.ALL)&&(e=Object.values(s.CONSOLE_LOG_TYPES).filter((e=>e!==s.CONSOLE_LOG_TYPES.ALL))),i=e,g(window.console),y=!0)}},605:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initalizeNetworkLog=t.resetNetworkData=t.networkLogs=void 0;const n=r(593),s=r(495);let o=0;const i=e=>{const t=window.XMLHttpRequest.prototype,r=t.send,s=t.open;return t.open=function(t,o,i,a,l){const c={};return c.method=t,c.url=(0,n.urlToString)((0,n.convertToCompleteUrl)((0,n.urlToString)(o))),c.normalizedUrl=(0,n.getNormalizedUrl)(c.url),c.startTime=(new Date).toISOString(),this.send=function(t){return this.addEventListener("loadend",(function(t,r={...c}){var n;const s=(new Date).toISOString();if(e){if(null===(n=r.url)||void 0===n?void 0:n.toLowerCase()){const t={status:this.status,endTime:s};e({request:r,response:t,type:"xhr"})}}})),r.apply(this,[t])},s.apply(this,[t,o,void 0===i||i,a,l])},null},a=e=>{(e=e.filter((e=>!("fetch"===(null==e?void 0:e.initiatorType)||"xmlhttprequest"===(null==e?void 0:e.initiatorType))))).map((e=>{if((null==e?void 0:e.initiatorType)&&(null==e?void 0:e.responseEnd)){const t=new Date(o+e.startTime),r=new Date(o+(null==e?void 0:e.responseEnd));l({type:e.initiatorType,request:{url:e.name,normalizedUrl:(0,n.getNormalizedUrl)(e.name),method:"GET",startTime:t.toISOString()},response:{status:200,endTime:r.toISOString()}})}}))},l=e=>{var r,o;s.isRecording&&(e.epochTime=Math.floor(Date.now()/1e3),(null===(o=null===(r=e.request)||void 0===r?void 0:r.url)||void 0===o?void 0:o.includes(n.UE_API_SUBDOMAIN))||t.networkLogs.push(e))};t.networkLogs=[];t.resetNetworkData=()=>{t.networkLogs=[]};let c=!1;t.initalizeNetworkLog=()=>{c||(i(l),(e=>{const{fetch:t}=window;window.fetch=async(...r)=>{const[s,o]=r,i={url:"",normalizedUrl:"",method:"GET",startTime:(new Date).toISOString()};try{if("string"==typeof s)i.url=s.toString();else if(s instanceof Request){const e=s.clone();i.url=e.url?e.url.toString():"",i.normalizedUrl=(0,n.getNormalizedUrl)(i.url),i.method=(e.method?e.method:"GET").toUpperCase()}o&&o.method&&(i.method=o.method.toUpperCase())}catch(e){}const a=await t(...r);try{const t=(new Date).toISOString(),r=a.clone(),s={status:r.status,endTime:t,extra:{type:r.type,redirected:r.redirected,statusText:r.statusText,url:r.url,normalizedUrl:(0,n.getNormalizedUrl)(r.url)}},o=r.text().then((e=>e)).catch((()=>!1));Promise.all([o]).then((t=>{t.length&&e({request:i,response:s,type:"fetch"})}))}catch(e){}return a}})(l),(()=>{if("performance"in window){o=window.performance.timeOrigin;const e=window.performance.getEntriesByType("resource");e&&a(e),new PerformanceObserver((e=>{const t=e.getEntries();a(t)})).observe({type:"resource",buffered:!0})}})(),c=!0)}},674:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uninitPerformanceCapturing=t.initPerformanceCapturing=t.resetPerformanceData=t.getPerformanceData=void 0;let r=null,n=null,s=0,o=null,i=null,a=0,l=null,c=null;t.getPerformanceData=()=>({lcp:{value:n},fcp:{value:r},cls:{value:s},inp:{value:o}});t.resetPerformanceData=()=>{r=null,n=null,s=0,o=null,a=0,l=null,c=null};t.initPerformanceCapturing=()=>{(0,t.resetPerformanceData)(),i=new PerformanceObserver((e=>{try{e.getEntries().forEach((e=>{if("paint"===e.entryType&&"first-contentful-paint"===e.name&&(r=e.startTime),"layout-shift"===e.entryType){const t=e;t.hadRecentInput||(a&&c&&l&&t.startTime-c.startTime<1e3&&t.startTime-l.startTime<5e3?(a+=t.value,c=t):(a=t.value,l=t,c=t),a>s&&(s=a))}if("largest-contentful-paint"===e.entryType&&(n=e.startTime),"event"===e.entryType){const t=e;t.interactionId&&(null===o||t.duration>o)&&(o=t.duration)}}))}catch(e){}})),i.observe({type:"layout-shift",buffered:!0}),i.observe({type:"largest-contentful-paint",buffered:!0}),i.observe({type:"event",buffered:!0,durationThreshold:0}),i.observe({type:"paint",buffered:!0})};t.uninitPerformanceCapturing=()=>{null==i||i.disconnect()}},737:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const r="CompressionStream",n=r in window;t.default=async function(e){try{if(n){const t=new ReadableStream({async start(t){t.enqueue(e),t.close()}}).pipeThrough(new TextEncoderStream).pipeThrough(new window[r]("gzip"));return new Uint8Array(await async function(e){const t=e.getReader(),r=[];let n=!1,s=[];for(;!n;){if(({done:n,value:s}=await t.read()),n)return r;r.push(...s)}return r}(t))}}catch(e){}return new Uint8Array}},214:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserData=t.getSessionUrl=void 0;const s=n(r(733)),o=r(593),i=(Math.random()+1).toString(36).substring(4),a=()=>{const e=["productSub","vendor","cookieEnabled","appVersion","platform","userAgent"],t={};let r;for(r in navigator)e.indexOf(r)>=0&&(t[r]=navigator[r]);return t};function l(){if("connection"in navigator){const e=navigator.connection;if(e){return e.effectiveType}}else;}function c(){var e;const t=navigator.userAgent,r=t.match(/Android\s[\d\.]+;\s?([^)]*)\)/i);if(r&&r[1]){return(null===(e=r[1].trim().replace(/\s*Build.*$/,"").split(";").pop())||void 0===e?void 0:e.trim())||""||void 0}const n=t.match(/\(BB10;\s([^)]+)\)/i);if(n&&n[1])return n[1].trim();if(t.match(/\(PlayBook;[^)]+\)/i))return"PlayBook";const s=t.match(/\((iPhone|iPad).*?\)/i);return s&&s[1]?s[1]:void 0}t.getSessionUrl=()=>"https://webmonitoring.userexperior.online/e/"+i;t.getBrowserData=()=>{const e=(()=>{const e=navigator.appVersion,t={browserName:"Unknown"},r=e.match(/(firefox|msie|chrome|safari)[/\s]([\d.]+)/gi);r&&(t.browserName=r[0]);let n="Unknown OS";return-1!==e.indexOf("Win")&&(n="Windows"),-1!==e.indexOf("Mac")&&(n="MacOS"),-1!==e.indexOf("X11")&&(n="UNIX"),-1!==e.indexOf("Linux")&&(n="Linux"),t.os=n,t.navigatorInfo=navigator,t.locale=navigator.language,t})(),t=document.getElementsByTagName("title");return{page_title:t.length?t[0].innerHTML:document.title,browser_data:a(),url:window.location.href.split("?")[0],normalizedUrl:(0,o.getNormalizedUrl)(window.location.href.split("?")[0]),browser:e.browserName,bowser_data:s.default.parse(window.navigator.userAgent),os:e.os,locale:navigator.language,viewport:`${window.innerWidth}x${window.innerHeight}`,screen_size:`${screen.width}x${screen.height}`,density:window.devicePixelRatio,tpId:i,networkType:l(),deviceModel:c()}}},552:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hashFunction=void 0,t.hashFunction=function(e,t){let r,n,s,o,i,a,l,c;for("string"==typeof e&&(e=(new TextEncoder).encode(e)),r=3&e.length,n=e.length-r,s=t,i=3432918353,a=461845907,c=0;c<n;)l=255&e[c]|(255&e[++c])<<8|(255&e[++c])<<16|(255&e[++c])<<24,++c,l=(65535&l)*i+(((l>>>16)*i&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295,s^=l,s=s<<13|s>>>19,o=5*(65535&s)+((5*(s>>>16)&65535)<<16)&4294967295,s=27492+(65535&o)+((58964+(o>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&e[c+2])<<16;case 2:l^=(255&e[c+1])<<8;case 1:l^=255&e[c],l=(65535&l)*i+(((l>>>16)*i&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295,s^=l}return s^=e.length,s^=s>>>16,s=2246822507*(65535&s)+((2246822507*(s>>>16)&65535)<<16)&4294967295,s^=s>>>13,s=3266489909*(65535&s)+((3266489909*(s>>>16)&65535)<<16)&4294967295,s^=s>>>16,s>>>0}},509:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(593),s=(e,t)=>t.some((t=>t instanceof RegExp?t.test(e):t===e)),o=new Set(["https:","http:","file:"]),i=e=>{try{const{protocol:t}=new URL(e);return t.endsWith(":")&&!t.includes(".")&&!o.has(t)}catch(e){return!1}},a=(e,{stripHash:t})=>{var r,n;const s=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!s)throw new Error(`Invalid URL: ${e}`);let{type:o,data:i,hash:a}=s.groups;const l=o.split(";");a=t?"":a;let c=!1;"base64"===l[l.length-1]&&(l.pop(),c=!0);const d=null!==(n=null===(r=l.shift())||void 0===r?void 0:r.toLowerCase())&&void 0!==n?n:"",u=[...l.map((e=>{let[t,r=""]=e.split("=").map((e=>e.trim()));return"charset"===t&&(r=r.toLowerCase(),"us-ascii"===r)?"":`${t}${r?`=${r}`:""}`})).filter(Boolean)];return c&&u.push("base64"),(u.length>0||d&&"text/plain"!==d)&&u.unshift(d),`data:${u.join(";")},${c?i.trim():i}${a?`#${a}`:""}`};t.default=function(e,t={}){var r;if("string"!=typeof(t={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!0,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:!0,removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!0,removeExplicitPort:!0,sortQueryParameters:!0,...t}).defaultProtocol||t.defaultProtocol.endsWith(":")||(t.defaultProtocol=`${t.defaultProtocol}:`),e=e.trim(),/^data:/i.test(e))return a(e,t);if(i(e))return e;const o=e.startsWith("//");!o&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,null!==(r=t.defaultProtocol)&&void 0!==r?r:"http"));const l=(0,n.convertToCompleteUrl)(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&"https:"===l.protocol&&(l.protocol="http:"),t.forceHttps&&"http:"===l.protocol&&(l.protocol="https:"),t.stripAuthentication&&(l.username="",l.password=""),t.stripHash?l.hash="":t.stripTextFragment&&(l.hash=l.hash.replace(/#?:~:text.*?$/i,"")),l.pathname){const e=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let t=0,r="";for(;;){const n=e.exec(l.pathname);if(!n)break;const s=n[0],o=n.index;r+=l.pathname.slice(t,o).replace(/\/{2,}/g,"/"),r+=s,t=o+s.length}r+=l.pathname.slice(t,l.pathname.length).replace(/\/{2,}/g,"/"),l.pathname=r}if(l.pathname&&(l.pathname=decodeURI(l.pathname)),!0===t.removeDirectoryIndex&&(t.removeDirectoryIndex=/^index\.[a-z]+$/),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let e=l.pathname.split("/");const r=e[e.length-1];s(r,t.removeDirectoryIndex)&&(e=e.slice(0,-1),l.pathname=e.slice(1).join("/")+"/")}if(l.hostname&&(l.hostname=l.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(l.hostname)&&(l.hostname=l.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(const e of[...l.searchParams.keys()])s(e,t.removeQueryParameters)&&l.searchParams.delete(e);if(Array.isArray(t.keepQueryParameters)||!0!==t.removeQueryParameters||(l.search=""),Array.isArray(t.keepQueryParameters)&&t.keepQueryParameters.length>0)for(const e of[...l.searchParams.keys()])s(e,t.keepQueryParameters)||l.searchParams.delete(e);t.sortQueryParameters&&(l.searchParams.sort(),l.search=decodeURIComponent(l.search)),t.removeTrailingSlash&&(l.pathname=l.pathname.replace(/\/$/,"")),t.removeExplicitPort&&l.port&&(l.port="");const c=e;return e=l.toString(),t.removeSingleSlash||"/"!==l.pathname||c.endsWith("/")||""!==l.hash||(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||"/"===l.pathname)&&""===l.hash&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),o&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}},48:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processEvent=void 0;const n=r(408),s=r(435),o=r(902);let i;t.processEvent=async e=>{if(e.type==n.EventType.IncrementalSnapshot&&e.data.source==n.IncrementalSource.Mutation&&i&&i.type==n.EventType.IncrementalSnapshot&&i.data.source==n.IncrementalSource.MouseInteraction&&(0,s.removeDeadClick)(),e.type==n.EventType.IncrementalSnapshot&&e.data.source==n.IncrementalSource.MouseInteraction&&e.data.type==n.MouseInteractions.Click&&0!==e.data.x&&0!==e.data.y){const t=n.record.mirror.getNode(e.data.id),r=e.timestamp;(0,o.newListener)(t,r,"click")}if(e.type==n.EventType.IncrementalSnapshot&&e.data.source==n.IncrementalSource.Input){const t=n.record.mirror.getNode(e.data.id),r=e.timestamp;(0,o.newListener)(t,r,"form-change",e.data.text),(0,s.removeDeadClick)()}e.data.source==n.IncrementalSource.MediaInteraction&&(e.data.muted=!0),i=e}},699:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CONSOLE_LOG_TYPES=void 0,t.CONSOLE_LOG_TYPES={ALL:"all",INFO:"info",WARN:"warn",ERROR:"error",DEBUG:"debug",LOG:"log",ASSERT:"assert"}},593:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeBase64=t.encodeBase64=t.clearDurableStorageItem=t.setDurableStorageItem=t.getDurableStorageItem=t.clearSessionItem=t.setSessionStorageItem=t.getSessionStorageItem=t.clearItem=t.setStorageItem=t.getStorageItem=t.truncateString=t.CONSOLE_MESSAGE_END_LENGTH=t.CONSOLE_MESSAGE_START_LENGTH=t.CONSOLE_MESSAGE_MAX_LENGTH=t.DEFAULT_MASK_INPUT_OPTIONS=t.MASK_INPUT_CLASS=t.MASK_ALL_INPUTS=t.CAPTURE_INLINE_STYLESHEET=t.CAPTURE_IMAGES_INLINE=t.DEFAULT_SESSION_REPLAY_MASK_CLASS=t.DEFAULT_SESSION_REPLAY_BLOCK_CLASS=t.UE_API_SUBDOMAIN=t.UE_TAB=t.RESTART_SESSION=t.UE_SESSION_ACTIVE=t.UE_SESSION_EXPIRE=t.UE_LAST_UPLOAD=t.UE_SESSION_ID=t.CUSTOM_METADATA=t.USER_PROPERTIES=t.USER_IDENTIFIER=t.NORMAL_POLL_FREQUENCY=t.LIVE_POLL_FREQUENCY=t.ONE_MINUTE=t.DEFAULT_RAGE_THROTTLE=t.DEFAULT_SESSION_THROTTLE=t.DEFAULT_VISIBILITY_THROTTLE=t.DEFAULT_INACTIVITY_COOLING_PERIOD=t.DEFAULT_INACTIVITY_THROTTLE=t.MAX_SIZE_THRESHOLD=t.DEFAULT_POLLING_INTERVAL=t.DEFAULT_NETWORK_BODY_SIZE=t.SEND_LOGS_PATH=t.SEND_CUSTOM_METADATA=t.INITILIZE_USER_PATH=t.INITILIZE_SESSION_PATH=t.DEFAULT_BASE_URL=t.SDK_VERSION=t.IN_BROWSER=void 0,t.convertToCompleteUrl=t.prefixSlash=t.urlToString=t.getNormalizedUrl=void 0;const s=n(r(509));t.IN_BROWSER=!("undefined"==typeof window);t.SDK_VERSION="0.3.25";let o="http://localhost:8080";o="https://webmonitoringapi.userexperior.online",t.DEFAULT_BASE_URL=o+"/api/ingest",t.INITILIZE_SESSION_PATH="/startSession/",t.INITILIZE_USER_PATH="/setIdentifier/",t.SEND_CUSTOM_METADATA="/addMetadata/",t.SEND_LOGS_PATH="/logData/",t.DEFAULT_NETWORK_BODY_SIZE=256,t.DEFAULT_POLLING_INTERVAL=15,t.MAX_SIZE_THRESHOLD=512,t.DEFAULT_INACTIVITY_THROTTLE=1800,t.DEFAULT_INACTIVITY_COOLING_PERIOD=300,t.DEFAULT_VISIBILITY_THROTTLE=1800,t.DEFAULT_SESSION_THROTTLE=20,t.DEFAULT_RAGE_THROTTLE=200,t.ONE_MINUTE=6e4,t.LIVE_POLL_FREQUENCY=1e3,t.NORMAL_POLL_FREQUENCY=4e3,t.USER_IDENTIFIER="userIdentifier",t.USER_PROPERTIES="userProperties",t.CUSTOM_METADATA="customMetadata",t.UE_SESSION_ID="ue_session",t.UE_LAST_UPLOAD="ue_last_upload",t.UE_SESSION_EXPIRE="ue_session_expire",t.UE_SESSION_ACTIVE="ue_session_active",t.RESTART_SESSION="restart_session",t.UE_TAB="ue_tab",t.UE_API_SUBDOMAIN="webmonitoringapi",t.DEFAULT_SESSION_REPLAY_BLOCK_CLASS="ue-block",t.DEFAULT_SESSION_REPLAY_MASK_CLASS="ue-mask",t.CAPTURE_IMAGES_INLINE=!1,t.CAPTURE_INLINE_STYLESHEET=!0,t.MASK_ALL_INPUTS=!1,t.MASK_INPUT_CLASS="ue-input-mask",t.DEFAULT_MASK_INPUT_OPTIONS={password:!0,email:!0,tel:!0},t.CONSOLE_MESSAGE_MAX_LENGTH=500,t.CONSOLE_MESSAGE_START_LENGTH=350,t.CONSOLE_MESSAGE_END_LENGTH=150;t.truncateString=(e,r=t.CONSOLE_MESSAGE_START_LENGTH,n=t.CONSOLE_MESSAGE_END_LENGTH)=>e?e.substring(0,r)+"..."+e.substring(e.length-n):"";t.getStorageItem=e=>localStorage.getItem(e);t.setStorageItem=(e,t)=>{localStorage.setItem(e,t)};t.clearItem=(e,t)=>{localStorage.setItem(e,t)};t.getSessionStorageItem=e=>sessionStorage.getItem(e);t.setSessionStorageItem=(e,t)=>{sessionStorage.setItem(e,t)};t.clearSessionItem=(e,t)=>{sessionStorage.setItem(e,t)};t.getDurableStorageItem=e=>localStorage.getItem(e)||sessionStorage.getItem(e);t.setDurableStorageItem=(e,t)=>{localStorage.setItem(e,t),sessionStorage.setItem(e,t)};t.clearDurableStorageItem=e=>{localStorage.removeItem(e),sessionStorage.removeItem(e)};t.encodeBase64=e=>Buffer.from(e).toString("base64");t.decodeBase64=e=>Buffer.from(e,"base64").toString("ascii");t.getNormalizedUrl=e=>{let t="";return t=(0,s.default)(e,{}),""===t?"null":t};t.urlToString=e=>e?e.toString():"";t.prefixSlash=e=>"/"!==e.charAt(0)?"/"+e:e;t.convertToCompleteUrl=e=>{var r;const n=null===(r=window.location)||void 0===r?void 0:r.origin;let s;if(!e)return s=new URL(n),s;try{return s=new URL(e),s}catch(r){return s=new URL((0,t.prefixSlash)(e),n),s}}},614:(e,t,r)=>{var n;r.r(t),r.d(t,{NIL:()=>L,parse:()=>g,stringify:()=>d,v1:()=>f,v3:()=>O,v4:()=>A,v5:()=>_,validate:()=>a,version:()=>x});var s=new Uint8Array(16);function o(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(s)}const i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const a=function(e){return"string"==typeof e&&i.test(e)};for(var l=[],c=0;c<256;++c)l.push((c+256).toString(16).substr(1));const d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!a(r))throw TypeError("Stringified UUID is invalid");return r};var u,h,p=0,m=0;const f=function(e,t,r){var n=t&&r||0,s=t||new Array(16),i=(e=e||{}).node||u,a=void 0!==e.clockseq?e.clockseq:h;if(null==i||null==a){var l=e.random||(e.rng||o)();null==i&&(i=u=[1|l[0],l[1],l[2],l[3],l[4],l[5]]),null==a&&(a=h=16383&(l[6]<<8|l[7]))}var c=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:m+1,g=c-p+(f-m)/1e4;if(g<0&&void 0===e.clockseq&&(a=a+1&16383),(g<0||c>p)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=c,m=f,h=a;var y=(1e4*(268435455&(c+=122192928e5))+f)%4294967296;s[n++]=y>>>24&255,s[n++]=y>>>16&255,s[n++]=y>>>8&255,s[n++]=255&y;var v=c/4294967296*1e4&268435455;s[n++]=v>>>8&255,s[n++]=255&v,s[n++]=v>>>24&15|16,s[n++]=v>>>16&255,s[n++]=a>>>8|128,s[n++]=255&a;for(var S=0;S<6;++S)s[n+S]=i[S];return t||d(s)};const g=function(e){if(!a(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};var y="6ba7b810-9dad-11d1-80b4-00c04fd430c8",v="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function S(e,t,r){function n(e,n,s,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=g(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var i=new Uint8Array(16+e.length);if(i.set(n),i.set(e,n.length),(i=r(i))[6]=15&i[6]|t,i[8]=63&i[8]|128,s){o=o||0;for(var a=0;a<16;++a)s[o+a]=i[a];return s}return d(i)}try{n.name=e}catch(e){}return n.DNS=y,n.URL=v,n}function b(e){return 14+(e+64>>>9<<4)+1}function E(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function w(e,t,r,n,s,o){return E((i=E(E(t,e),E(n,o)))<<(a=s)|i>>>32-a,r);var i,a}function T(e,t,r,n,s,o,i){return w(t&r|~t&n,e,t,s,o,i)}function I(e,t,r,n,s,o,i){return w(t&n|r&~n,e,t,s,o,i)}function M(e,t,r,n,s,o,i){return w(t^r^n,e,t,s,o,i)}function N(e,t,r,n,s,o,i){return w(r^(t|~n),e,t,s,o,i)}const C=function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){for(var t=[],r=32*e.length,n="0123456789abcdef",s=0;s<r;s+=8){var o=e[s>>5]>>>s%32&255,i=parseInt(n.charAt(o>>>4&15)+n.charAt(15&o),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[b(t)-1]=t;for(var r=1732584193,n=-271733879,s=-1732584194,o=271733878,i=0;i<e.length;i+=16){var a=r,l=n,c=s,d=o;r=T(r,n,s,o,e[i],7,-680876936),o=T(o,r,n,s,e[i+1],12,-389564586),s=T(s,o,r,n,e[i+2],17,606105819),n=T(n,s,o,r,e[i+3],22,-1044525330),r=T(r,n,s,o,e[i+4],7,-176418897),o=T(o,r,n,s,e[i+5],12,1200080426),s=T(s,o,r,n,e[i+6],17,-1473231341),n=T(n,s,o,r,e[i+7],22,-45705983),r=T(r,n,s,o,e[i+8],7,1770035416),o=T(o,r,n,s,e[i+9],12,-1958414417),s=T(s,o,r,n,e[i+10],17,-42063),n=T(n,s,o,r,e[i+11],22,-1990404162),r=T(r,n,s,o,e[i+12],7,1804603682),o=T(o,r,n,s,e[i+13],12,-40341101),s=T(s,o,r,n,e[i+14],17,-1502002290),r=I(r,n=T(n,s,o,r,e[i+15],22,1236535329),s,o,e[i+1],5,-165796510),o=I(o,r,n,s,e[i+6],9,-1069501632),s=I(s,o,r,n,e[i+11],14,643717713),n=I(n,s,o,r,e[i],20,-373897302),r=I(r,n,s,o,e[i+5],5,-701558691),o=I(o,r,n,s,e[i+10],9,38016083),s=I(s,o,r,n,e[i+15],14,-660478335),n=I(n,s,o,r,e[i+4],20,-405537848),r=I(r,n,s,o,e[i+9],5,568446438),o=I(o,r,n,s,e[i+14],9,-1019803690),s=I(s,o,r,n,e[i+3],14,-187363961),n=I(n,s,o,r,e[i+8],20,1163531501),r=I(r,n,s,o,e[i+13],5,-1444681467),o=I(o,r,n,s,e[i+2],9,-51403784),s=I(s,o,r,n,e[i+7],14,1735328473),r=M(r,n=I(n,s,o,r,e[i+12],20,-1926607734),s,o,e[i+5],4,-378558),o=M(o,r,n,s,e[i+8],11,-2022574463),s=M(s,o,r,n,e[i+11],16,1839030562),n=M(n,s,o,r,e[i+14],23,-35309556),r=M(r,n,s,o,e[i+1],4,-1530992060),o=M(o,r,n,s,e[i+4],11,1272893353),s=M(s,o,r,n,e[i+7],16,-155497632),n=M(n,s,o,r,e[i+10],23,-1094730640),r=M(r,n,s,o,e[i+13],4,681279174),o=M(o,r,n,s,e[i],11,-358537222),s=M(s,o,r,n,e[i+3],16,-722521979),n=M(n,s,o,r,e[i+6],23,76029189),r=M(r,n,s,o,e[i+9],4,-640364487),o=M(o,r,n,s,e[i+12],11,-421815835),s=M(s,o,r,n,e[i+15],16,530742520),r=N(r,n=M(n,s,o,r,e[i+2],23,-995338651),s,o,e[i],6,-198630844),o=N(o,r,n,s,e[i+7],10,1126891415),s=N(s,o,r,n,e[i+14],15,-1416354905),n=N(n,s,o,r,e[i+5],21,-57434055),r=N(r,n,s,o,e[i+12],6,1700485571),o=N(o,r,n,s,e[i+3],10,-1894986606),s=N(s,o,r,n,e[i+10],15,-1051523),n=N(n,s,o,r,e[i+1],21,-2054922799),r=N(r,n,s,o,e[i+8],6,1873313359),o=N(o,r,n,s,e[i+15],10,-30611744),s=N(s,o,r,n,e[i+6],15,-1560198380),n=N(n,s,o,r,e[i+13],21,1309151649),r=N(r,n,s,o,e[i+4],6,-145523070),o=N(o,r,n,s,e[i+11],10,-1120210379),s=N(s,o,r,n,e[i+2],15,718787259),n=N(n,s,o,r,e[i+9],21,-343485551),r=E(r,a),n=E(n,l),s=E(s,c),o=E(o,d)}return[r,n,s,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(b(t)),n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};const O=S("v3",48,C);const A=function(e,t,r){var n=(e=e||{}).random||(e.rng||o)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var s=0;s<16;++s)t[r+s]=n[s];return t}return d(n)};function k(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function R(e,t){return e<<t|e>>>32-t}const D=function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var n=unescape(encodeURIComponent(e));e=[];for(var s=0;s<n.length;++s)e.push(n.charCodeAt(s))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,i=Math.ceil(o/16),a=new Array(i),l=0;l<i;++l){for(var c=new Uint32Array(16),d=0;d<16;++d)c[d]=e[64*l+4*d]<<24|e[64*l+4*d+1]<<16|e[64*l+4*d+2]<<8|e[64*l+4*d+3];a[l]=c}a[i-1][14]=8*(e.length-1)/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=8*(e.length-1)&4294967295;for(var u=0;u<i;++u){for(var h=new Uint32Array(80),p=0;p<16;++p)h[p]=a[u][p];for(var m=16;m<80;++m)h[m]=R(h[m-3]^h[m-8]^h[m-14]^h[m-16],1);for(var f=r[0],g=r[1],y=r[2],v=r[3],S=r[4],b=0;b<80;++b){var E=Math.floor(b/20),w=R(f,5)+k(E,g,y,v)+S+t[E]+h[b]>>>0;S=v,v=y,y=R(g,30)>>>0,g=f,f=w}r[0]=r[0]+f>>>0,r[1]=r[1]+g>>>0,r[2]=r[2]+y>>>0,r[3]=r[3]+v>>>0,r[4]=r[4]+S>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};const _=S("v5",80,D),L="00000000-0000-0000-0000-000000000000";const x=function(e){if(!a(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},408:(e,t,r)=>{r.r(t),r.d(t,{EventType:()=>Pe,IncrementalSource:()=>Ue,MouseInteractions:()=>Fe,PLUGIN_NAME:()=>Zr,Replayer:()=>ws,ReplayerEvents:()=>Ve,addCustomEvent:()=>Gt,canvasMutation:()=>un,freezePage:()=>$t,getRecordConsolePlugin:()=>en,getReplayConsolePlugin:()=>sn,mirror:()=>ae,pack:()=>jr,record:()=>zt,unpack:()=>Vr,utils:()=>n});var n={};r.r(n),r.d(n,{StyleSheetMirror:()=>Re,_mirror:()=>ae,closestElementOfNode:()=>fe,getBaseDimension:()=>Ne,getNestedRule:()=>Oe,getPositionsAndIndex:()=>Ae,getRootShadowHost:()=>_e,getShadowHost:()=>De,getWindowHeight:()=>pe,getWindowScroll:()=>he,getWindowWidth:()=>me,hasShadowRoot:()=>Ce,hookSetter:()=>ce,inDom:()=>xe,isAncestorRemoved:()=>Se,isBlocked:()=>ge,isIgnored:()=>ve,isSerialized:()=>ye,isSerializedIframe:()=>Ie,isSerializedStylesheet:()=>Me,iterateResolveTree:()=>Te,legacy_isTouchEvent:()=>be,nowTimestamp:()=>ue,on:()=>oe,patch:()=>de,polyfill:()=>Ee,queueToResolveTrees:()=>we,shadowHostInDom:()=>Le,throttle:()=>le,uniqueTextMutations:()=>ke});var s,o={};function i(e){return e.nodeType===e.ELEMENT_NODE}function a(e){const t=null==e?void 0:e.host;return Boolean((null==t?void 0:t.shadowRoot)===e)}function l(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function c(e){try{const r=e.rules||e.cssRules;return r?((t=Array.from(r,d).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),t):null}catch(e){return null}var t}function d(e){let t;if(function(e){return"styleSheet"in e}(e))try{t=c(e.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const r=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?r.push("layer"):e.layerName&&r.push(`layer(${e.layerName})`),e.supportsText&&r.push(`supports(${e.supportsText})`),e.media.length&&r.push(e.media.mediaText),r.join(" ")+";"}(e)}catch(e){}else if(function(e){return"selectorText"in e}(e)&&e.selectorText.includes(":"))return function(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}(e.cssText);return t||e.cssText}r.r(o),r.d(o,{default:()=>Zn}),function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(s||(s={}));class u{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return-1;const r=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=r?r:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e,t){const r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e,t))),null==t||t(e)}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)}replace(e,t){const r=this.getNode(e);if(r){const e=this.nodeMetaMap.get(r);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function h(){return new u}const p="ue-unmask";function m({element:e,maskInputOptions:t,tagName:r,type:n,value:s,maskInputFn:o}){let i=s||"";const a=n&&f(n);return e.classList.contains(p)||(t[r.toLowerCase()]||a&&t[a])&&(i=o?o(i,e):"*".repeat(i.length)),i}function f(e){return e.toLowerCase()}const g="__rrweb_original__";function y(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?f(t):null}function v(e,t){var r;let n;try{n=new URL(e,null!=t?t:window.location.href)}catch(e){return null}const s=n.pathname.match(/\.([0-9a-z]+)(?:$)/i);return null!==(r=null==s?void 0:s[1])&&void 0!==r?r:null}let S=1;const b=new RegExp("[^a-z0-9-_:]"),E=-2,w="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAABNJREFUCB1jZGBg+A/EDEwgAgQADigBA//q6GsAAAAASUVORK5CYII%3D";function T(){return S++}let I,M;const N=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,C=/^(?:[a-z+]+:)?\/\//i,O=/^www\..*/i,A=/^(data:)([^,]*),(.*)/i;function k(e,t){return(e||"").replace(N,((e,r,n,s,o,i)=>{const a=n||o||i,l=r||s||"";if(!a)return e;if(C.test(a)||O.test(a))return`url(${l}${a}${l})`;if(A.test(a))return`url(${l}${a}${l})`;if("/"===a[0])return`url(${l}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+a}${l})`;const c=t.split("/"),d=a.split("/");c.pop();for(const e of d)"."!==e&&(".."===e?c.pop():c.push(e));return`url(${l}${c.join("/")}${l})`}))}const R=/^[^ \t\n\r\u000c]+/,D=/^[, \t\n\r\u000c]+/;const _=new WeakMap;function L(e,t){return t&&""!==t.trim()?P(e,t):t}function x(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function P(e,t){let r=_.get(e);if(r||(r=e.createElement("a"),_.set(e,r)),t){if(t.startsWith("blob:")||t.startsWith("data:"))return t}else t="";return r.setAttribute("href",t),r.href}function U(e,t,r,n){return n?"src"===r||"href"===r&&("use"!==t||"#"!==n[0])||"xlink:href"===r&&"#"!==n[0]?L(e,n):"background"!==r||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===r?function(e,t){if(""===t.trim())return t;let r=0;function n(e){let n;const s=e.exec(t.substring(r));return s?(n=s[0],r+=n.length,n):""}const s=[];for(;n(D),!(r>=t.length);){let o=n(R);if(","===o.slice(-1))o=L(e,o.substring(0,o.length-1)),s.push(o);else{let n="";o=L(e,o);let i=!1;for(;;){const e=t.charAt(r);if(""===e){s.push((o+n).trim());break}if(i)")"===e&&(i=!1);else{if(","===e){r+=1,s.push((o+n).trim());break}"("===e&&(i=!0)}n+=e,r+=1}}}return s.join(", ")}(e,n):"style"===r?k(n,P(e)):"object"===t&&"data"===r?L(e,n):n:L(e,n):n}function F(e,t,r){return("video"===e||"audio"===e)&&"autoplay"===t}function B(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!r&&B(e.parentNode,t,r);for(let r=e.classList.length;r--;){const n=e.classList[r];if(t.test(n))return!0}return!!r&&B(e.parentNode,t,r)}function j(e,t,r,n){try{const s=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===s)return!1;if("string"==typeof t){if(s.classList.contains(p))return!1;if(n){if(s.closest(`.${t}`))return!0}else if(s.classList.contains(t))return!0}else if(B(s,t,n))return!0;if(r)if(n){if(s.closest(r))return!0}else if(s.matches(r))return!0}catch(e){}return!1}function V(e,t){const{doc:r,mirror:n,blockClass:o,blockSelector:i,maskTextClass:a,needsMask:l,inlineStylesheet:d,maskInputOptions:u={},maskTextFn:h,maskInputFn:p,dataURLOptions:v={},inlineImages:S,recordCanvas:E,keepIframeSrcFn:T,newlyAddedElement:N=!1}=t,C=function(e,t){if(!t.hasNode(e))return;const r=t.getId(e);return 1===r?void 0:r}(r,n);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:s.Document,childNodes:[],compatMode:e.compatMode}:{type:s.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:s.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:C};case e.ELEMENT_NODE:return function(e,t){const{doc:r,blockClass:n,blockSelector:o,inlineStylesheet:i,maskInputOptions:a={},maskInputFn:l,dataURLOptions:d={},inlineImages:u,recordCanvas:h,keepIframeSrcFn:p,newlyAddedElement:v=!1,rootId:S}=t,E=function(e,t,r){try{if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let r=e.classList.length;r--;){const n=e.classList[r];if(t.test(n))return!0}if(r)return e.matches(r)}catch(e){}return!1}(e,n,o),T=function(e){if(e instanceof HTMLFormElement)return"form";const t=f(e.tagName);return b.test(t)?"div":t}(e);let N={};const C=e.attributes.length;for(let t=0;t<C;t++){const n=e.attributes[t];F(T,n.name,n.value)||(N[n.name]=U(r,T,f(n.name),n.value))}if("link"===T&&i){const t=Array.from(r.styleSheets).find((t=>t.href===e.href));let n=null;t&&(n=c(t)),n&&(delete N.rel,delete N.href,N._cssText=k(n,t.href))}if("style"===T&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const t=c(e.sheet);t&&(N._cssText=k(t,P(r)))}if("input"===T||"textarea"===T||"select"===T||"option"===T){const t=e.value,r=e.checked;"radio"!==N.type&&"checkbox"!==N.type&&"submit"!==N.type&&"button"!==N.type&&t?N.value=m({element:e,type:y(e),tagName:"option"===T?"select":T,value:t,maskInputOptions:a,maskInputFn:l}):r&&(N.checked=r)}"option"===T&&e.selected&&!a.select&&(N.selected=!0);if("canvas"===T&&h)if("2d"===e.__context)(function(e){const t=e.getContext("2d");if(!t)return!0;for(let r=0;r<e.width;r+=50)for(let n=0;n<e.height;n+=50){const s=t.getImageData,o=g in s?s[g]:s;if(new Uint32Array(o.call(t,r,n,Math.min(50,e.width-r),Math.min(50,e.height-n)).data.buffer).some((e=>0!==e)))return!1}return!0})(e)||(N.rr_dataURL=e.toDataURL(d.type,d.quality));else if(!("__context"in e)){const t=e.toDataURL(d.type,d.quality),r=document.createElement("canvas");r.width=e.width,r.height=e.height;t!==r.toDataURL(d.type,d.quality)&&(N.rr_dataURL=t)}if("img"===T&&u){I||(I=r.createElement("canvas"),M=I.getContext("2d"));const t=e,n=t.currentSrc||t.getAttribute("src")||"<unknown-src>",s=t.crossOrigin,o=()=>{t.removeEventListener("load",o);try{I.width=t.naturalWidth,I.height=t.naturalHeight,M.drawImage(t,0,0),N.rr_dataURL=I.toDataURL(d.type,d.quality)}catch(e){if("anonymous"!==t.crossOrigin)return t.crossOrigin="anonymous",void(t.complete&&0!==t.naturalWidth?o():t.addEventListener("load",o));console.warn(`Cannot inline img src=${n}! Error: ${e}`)}"anonymous"===t.crossOrigin&&(s?N.crossOrigin=s:t.removeAttribute("crossorigin"))};t.complete&&0!==t.naturalWidth?o():t.addEventListener("load",o)}let O,A=t.maskTextClass;if("img"===T&&N.class&&"string"==typeof N.class&&A&&"string"==typeof A&&N.class.includes(A)){const t=e,r=()=>{N.src=w,N.style&&"string"==typeof N.style?(N.style.includes("width")||(N.style=`${N.style}; width: ${t.width}px;`),N.style.includes("height")||(N.style=`${N.style}; height: ${t.height}px`)):N.style=`width: ${t.width}px; height: ${t.height}px`};t.complete?r():t.onload=r}if("audio"===T||"video"===T){const t=N;t.rr_mediaState=e.paused?"paused":"played",t.rr_mediaCurrentTime=e.currentTime,t.rr_mediaPlaybackRate=e.playbackRate,t.rr_mediaMuted=e.muted,t.rr_mediaLoop=e.loop,t.rr_mediaVolume=e.volume}v||(e.scrollLeft&&(N.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(N.rr_scrollTop=e.scrollTop));if(E){const{width:t,height:r}=e.getBoundingClientRect();N={class:N.class,rr_width:`${t}px`,rr_height:`${r}px`}}"iframe"!==T||p(N.src)||(e.contentDocument||(N.rr_src=N.src),delete N.src);try{customElements.get(T)&&(O=!0)}catch(e){}return{type:s.Element,tagName:T,attributes:N,childNodes:[],isSVG:x(e)||void 0,needBlock:E,rootId:S,isCustom:O}}(e,{doc:r,blockClass:o,blockSelector:i,maskTextClass:a,inlineStylesheet:d,maskInputOptions:u,maskInputFn:p,dataURLOptions:v,inlineImages:S,recordCanvas:E,keepIframeSrcFn:T,newlyAddedElement:N,rootId:C});case e.TEXT_NODE:return function(e,t){var r;const{needsMask:n,maskTextFn:o,rootId:i,maskInputOptions:a,maskInputFn:l}=t,d=e.parentNode&&e.parentNode.tagName;let u=e.textContent;const h="STYLE"===d||void 0,p="SCRIPT"===d||void 0;if(h&&u){try{e.nextSibling||e.previousSibling||(null===(r=e.parentNode.sheet)||void 0===r?void 0:r.cssRules)&&(u=c(e.parentNode.sheet))}catch(t){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${t}`,e)}u=k(u,P(t.doc))}p&&(u="SCRIPT_PLACEHOLDER");!h&&!p&&u&&n&&(u=o?o(u,e.parentElement):u.replace(/[\S]/g,"*"));"OPTION"===d&&(u=m({element:e.parentElement,type:y(e.parentElement),tagName:"select",value:u,maskInputOptions:a,maskInputFn:l}));return{type:s.Text,textContent:u||"",isStyle:h,rootId:i}}(e,{doc:r,needsMask:l,maskTextFn:h,rootId:C,maskInputOptions:u,maskInputFn:p});case e.CDATA_SECTION_NODE:return{type:s.CDATA,textContent:"",rootId:C};case e.COMMENT_NODE:return{type:s.Comment,textContent:e.textContent||"",rootId:C};default:return!1}}function W(e){return null==e?"":e.toLowerCase()}function H(e,t){const{doc:r,mirror:n,blockClass:o,blockSelector:c,maskTextClass:d,maskTextSelector:u,skipChild:h=!1,inlineStylesheet:m=!0,maskInputOptions:f={},maskTextFn:g,maskInputFn:y,slimDOMOptions:S,dataURLOptions:b={},inlineImages:w=!1,recordCanvas:I=!1,onSerialize:M,onIframeLoad:N,iframeLoadTimeout:C=5e3,onStylesheetLoad:O,stylesheetLoadTimeout:A=5e3,keepIframeSrcFn:k=(()=>!1),newlyAddedElement:R=!1}=t;let{needsMask:D}=t,{preserveWhiteSpace:_=!0}=t;if(!D&&e.childNodes){D=j(e,d,u,void 0===D)}D&&(D=function(e){try{const t=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===t)return!1;if(t.classList.contains(p))return!1}catch(e){}return!0}(e));const L=V(e,{doc:r,mirror:n,blockClass:o,blockSelector:c,needsMask:D,maskTextClass:d,inlineStylesheet:m,maskInputOptions:f,maskTextFn:g,maskInputFn:y,dataURLOptions:b,inlineImages:w,recordCanvas:I,keepIframeSrcFn:k,newlyAddedElement:R});if(!L)return console.warn(e,"not serialized"),null;let x;x=n.hasNode(e)?n.getId(e):!function(e,t){if(t.comment&&e.type===s.Comment)return!0;if(e.type===s.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&"js"===v(e.attributes.href)))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(W(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===W(e.attributes.name)||"icon"===W(e.attributes.rel)||"apple-touch-icon"===W(e.attributes.rel)||"shortcut icon"===W(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&W(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(W(e.attributes.property).match(/^(og|twitter|fb):/)||W(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===W(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===W(e.attributes.name)||"googlebot"===W(e.attributes.name)||"bingbot"===W(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===W(e.attributes.name)||"generator"===W(e.attributes.name)||"framework"===W(e.attributes.name)||"publisher"===W(e.attributes.name)||"progid"===W(e.attributes.name)||W(e.attributes.property).match(/^article:/)||W(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===W(e.attributes.name)||"yandex-verification"===W(e.attributes.name)||"csrf-token"===W(e.attributes.name)||"p:domain_verify"===W(e.attributes.name)||"verify-v1"===W(e.attributes.name)||"verification"===W(e.attributes.name)||"shopify-checkout-api-token"===W(e.attributes.name)))return!0}}return!1}(L,S)&&(_||L.type!==s.Text||L.isStyle||L.textContent.replace(/^\s+|\s+$/gm,"").length)?T():E;const P=Object.assign(L,{id:x});if(n.add(e,P),x===E)return null;M&&M(e);let U=!h;if(P.type===s.Element){U=U&&!P.needBlock,delete P.needBlock;const t=e.shadowRoot;t&&l(t)&&(P.isShadowHost=!0)}if((P.type===s.Document||P.type===s.Element)&&U){S.headWhitespace&&P.type===s.Element&&"head"===P.tagName&&(_=!1);const t={doc:r,mirror:n,blockClass:o,blockSelector:c,needsMask:D,maskTextClass:d,maskTextSelector:u,skipChild:h,inlineStylesheet:m,maskInputOptions:f,maskTextFn:g,maskInputFn:y,slimDOMOptions:S,dataURLOptions:b,inlineImages:w,recordCanvas:I,preserveWhiteSpace:_,onSerialize:M,onIframeLoad:N,iframeLoadTimeout:C,onStylesheetLoad:O,stylesheetLoadTimeout:A,keepIframeSrcFn:k};if(P.type===s.Element&&"textarea"===P.tagName&&void 0!==P.attributes.value);else for(const r of Array.from(e.childNodes)){const e=H(r,t);e&&P.childNodes.push(e)}if(i(e)&&e.shadowRoot)for(const r of Array.from(e.shadowRoot.childNodes)){const n=H(r,t);n&&(l(e.shadowRoot)&&(n.isShadow=!0),P.childNodes.push(n))}}return e.parentNode&&a(e.parentNode)&&l(e.parentNode)&&(P.isShadow=!0),P.type===s.Element&&"iframe"===P.tagName&&function(e,t,r){const n=e.contentWindow;if(!n)return;let s,o=!1;try{s=n.document.readyState}catch(e){return}if("complete"!==s){const n=setTimeout((()=>{o||(t(),o=!0)}),r);return void e.addEventListener("load",(()=>{clearTimeout(n),o=!0,t()}))}const i="about:blank";if(n.location.href!==i||e.src===i||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,(()=>{const t=e.contentDocument;if(t&&N){const r=H(t,{doc:t,mirror:n,blockClass:o,blockSelector:c,needsMask:D,maskTextClass:d,maskTextSelector:u,skipChild:!1,inlineStylesheet:m,maskInputOptions:f,maskTextFn:g,maskInputFn:y,slimDOMOptions:S,dataURLOptions:b,inlineImages:w,recordCanvas:I,preserveWhiteSpace:_,onSerialize:M,onIframeLoad:N,iframeLoadTimeout:C,onStylesheetLoad:O,stylesheetLoadTimeout:A,keepIframeSrcFn:k});r&&N(e,r)}}),C),P.type===s.Element&&"link"===P.tagName&&"string"==typeof P.attributes.rel&&("stylesheet"===P.attributes.rel||"preload"===P.attributes.rel&&"string"==typeof P.attributes.href&&"css"===v(P.attributes.href))&&function(e,t,r){let n,s=!1;try{n=e.sheet}catch(e){return}if(n)return;const o=setTimeout((()=>{s||(t(),s=!0)}),r);e.addEventListener("load",(()=>{clearTimeout(o),s=!0,t()}))}(e,(()=>{if(O){const t=H(e,{doc:r,mirror:n,blockClass:o,blockSelector:c,needsMask:D,maskTextClass:d,maskTextSelector:u,skipChild:!1,inlineStylesheet:m,maskInputOptions:f,maskTextFn:g,maskInputFn:y,slimDOMOptions:S,dataURLOptions:b,inlineImages:w,recordCanvas:I,preserveWhiteSpace:_,onSerialize:M,onIframeLoad:N,iframeLoadTimeout:C,onStylesheetLoad:O,stylesheetLoadTimeout:A,keepIframeSrcFn:k});t&&O(e,t)}}),A),P}const z=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function G(e,t={}){let r=1,n=1;function s(e){const t=e.match(/\n/g);t&&(r+=t.length);const s=e.lastIndexOf("\n");n=-1===s?n+e.length:e.length-s}function o(){const e={line:r,column:n};return t=>(t.position=new i(e),p(),t)}class i{constructor(e){this.start=e,this.end={line:r,column:n},this.source=t.source}}i.prototype.content=e;const a=[];function l(s){const o=new Error(`${t.source||""}:${r}:${n}: ${s}`);if(o.reason=s,o.filename=t.source,o.line=r,o.column=n,o.source=e,!t.silent)throw o;a.push(o)}function c(){return h(/^{\s*/)}function d(){return h(/^}/)}function u(){let t;const r=[];for(p(),m(r);e.length&&"}"!==e.charAt(0)&&(t=I()||M());)t&&(r.push(t),m(r));return r}function h(t){const r=t.exec(e);if(!r)return;const n=r[0];return s(n),e=e.slice(n.length),r}function p(){h(/^\s*/)}function m(e=[]){let t;for(;t=f();)t&&e.push(t),t=f();return e}function f(){const t=o();if("/"!==e.charAt(0)||"*"!==e.charAt(1))return;let r=2;for(;""!==e.charAt(r)&&("*"!==e.charAt(r)||"/"!==e.charAt(r+1));)++r;if(r+=2,""===e.charAt(r-1))return l("End of comment missing");const i=e.slice(2,r-2);return n+=2,s(i),e=e.slice(r),n+=2,t({type:"comment",comment:i})}function g(){for(p();"}"==e[0];)l("extra closing bracket"),e=e.slice(1),p();const t=h(/^(((?<!\\)"(?:\\"|[^"])*"|(?<!\\)'(?:\\'|[^'])*'|[^{])+)/);if(!t)return;const r=t[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,(e=>e.replace(/,/g,"‌")));return function(e){const t=[];let r="",n=0,s=0,o=null;for(const i of e){const e=r.endsWith("\\");o?o!==i||e||(o=null):"("===i?n++:")"===i?n--:"["===i?s++:"]"===i?s--:"'\"".includes(i)&&(o=i),","===i&&0===n&&0===s?(t.push(r),r=""):r+=i}r&&t.push(r);return t}(r).map((e=>e.replace(/\u200C/g,",").trim()))}function y(){const e=o(),t=h(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!t)return;const r=$(t[0]);if(!h(/^:\s*/))return l("property missing ':'");const n=h(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),s=e({type:"declaration",property:r.replace(z,""),value:n?$(n[0]).replace(z,""):""});return h(/^[;\s]*/),s}function v(){const e=[];if(!c())return l("missing '{'");let t;for(m(e);t=y();)!1!==t&&(e.push(t),m(e)),t=y();return d()?e:l("missing '}'")}function S(){let e;const t=[],r=o();for(;e=h(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),h(/^,\s*/);if(t.length)return r({type:"keyframe",values:t,declarations:v()})}const b=T("import"),E=T("charset"),w=T("namespace");function T(e){const t=new RegExp("^@"+e+"\\s*((?:"+['(?<!\\\\)"(?:\\\\"|[^"])*"',"(?<!\\\\)'(?:\\\\'|[^'])*'","[^;]"].join("|")+")+);");return()=>{const r=o(),n=h(t);if(!n)return;const s={type:e};return s[e]=n[1].trim(),r(s)}}function I(){if("@"===e[0])return function(){const e=o();let t=h(/^@([-\w]+)?keyframes\s*/);if(!t)return;const r=t[1];if(t=h(/^([-\w]+)\s*/),!t)return l("@keyframes missing name");const n=t[1];if(!c())return l("@keyframes missing '{'");let s,i=m();for(;s=S();)i.push(s),i=i.concat(m());return d()?e({type:"keyframes",name:n,vendor:r,keyframes:i}):l("@keyframes missing '}'")}()||function(){const e=o(),t=h(/^@media *([^{]+)/);if(!t)return;const r=$(t[1]);if(!c())return l("@media missing '{'");const n=m().concat(u());return d()?e({type:"media",media:r,rules:n}):l("@media missing '}'")}()||function(){const e=o(),t=h(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(t)return e({type:"custom-media",name:$(t[1]),media:$(t[2])})}()||function(){const e=o(),t=h(/^@supports *([^{]+)/);if(!t)return;const r=$(t[1]);if(!c())return l("@supports missing '{'");const n=m().concat(u());return d()?e({type:"supports",supports:r,rules:n}):l("@supports missing '}'")}()||b()||E()||w()||function(){const e=o(),t=h(/^@([-\w]+)?document *([^{]+)/);if(!t)return;const r=$(t[1]),n=$(t[2]);if(!c())return l("@document missing '{'");const s=m().concat(u());return d()?e({type:"document",document:n,vendor:r,rules:s}):l("@document missing '}'")}()||function(){const e=o();if(!h(/^@page */))return;const t=g()||[];if(!c())return l("@page missing '{'");let r,n=m();for(;r=y();)n.push(r),n=n.concat(m());return d()?e({type:"page",selectors:t,declarations:n}):l("@page missing '}'")}()||function(){const e=o();if(!h(/^@host\s*/))return;if(!c())return l("@host missing '{'");const t=m().concat(u());return d()?e({type:"host",rules:t}):l("@host missing '}'")}()||function(){const e=o();if(!h(/^@font-face\s*/))return;if(!c())return l("@font-face missing '{'");let t,r=m();for(;t=y();)r.push(t),r=r.concat(m());return d()?e({type:"font-face",declarations:r}):l("@font-face missing '}'")}()}function M(){const e=o(),t=g();return t?(m(),e({type:"rule",selectors:t,declarations:v()})):l("selector missing")}return Y(function(){const e=u();return{type:"stylesheet",stylesheet:{source:t.source,rules:e,parsingErrors:a}}}())}function $(e){return e?e.replace(/^\s+|\s+$/g,""):""}function Y(e,t){const r=e&&"string"==typeof e.type,n=r?e:t;for(const t of Object.keys(e)){const r=e[t];Array.isArray(r)?r.forEach((e=>{Y(e,n)})):r&&"object"==typeof r&&Y(r,n)}return r&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),e}const q={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function X(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const K=/(max|min)-device-(width|height)/,Q=new RegExp(K.source,"g"),J=/([^\\]):hover/,Z=new RegExp(J.source,"g");function ee(e,t){const r=null==t?void 0:t.stylesWithHoverClass.get(e);if(r)return r;const n=G(e,{silent:!0});if(!n.stylesheet)return e;const s=[],o=[];!function e(t){"selectors"in t&&t.selectors&&t.selectors.forEach((e=>{J.test(e)&&s.push(e)})),"media"in t&&t.media&&K.test(t.media)&&o.push(t.media),"rules"in t&&t.rules&&t.rules.forEach(e)}(n.stylesheet);let i=e;if(s.length>0){const e=new RegExp(s.filter(((e,t)=>s.indexOf(e)===t)).sort(((e,t)=>t.length-e.length)).map((e=>X(e))).join("|"),"g");i=i.replace(e,(e=>{const t=e.replace(Z,"$1.\\:hover");return`${e}, ${t}`}))}if(o.length>0){const e=new RegExp(o.filter(((e,t)=>o.indexOf(e)===t)).sort(((e,t)=>t.length-e.length)).map((e=>X(e))).join("|"),"g");i=i.replace(e,(e=>e.replace(Q,"$1-$2")))}return null==t||t.stylesWithHoverClass.set(e,i),i}function te(){return{stylesWithHoverClass:new Map}}function re(e,t){var r;const{doc:n,hackCss:o,cache:i}=t;switch(e.type){case s.Document:return n.implementation.createDocument(null,"",null);case s.DocumentType:return n.implementation.createDocumentType(e.name||"html",e.publicId,e.systemId);case s.Element:{const t=function(e){let t=q[e.tagName]?q[e.tagName]:e.tagName;return"link"===t&&e.attributes._cssText&&(t="style"),t}(e);let s;e.isSVG?s=n.createElementNS("http://www.w3.org/2000/svg",t):(e.isCustom&&(null===(r=n.defaultView)||void 0===r?void 0:r.customElements)&&!n.defaultView.customElements.get(e.tagName)&&n.defaultView.customElements.define(e.tagName,class extends n.defaultView.HTMLElement{}),s=n.createElement(t));const a={};for(const r in e.attributes){if(!Object.prototype.hasOwnProperty.call(e.attributes,r))continue;let l=e.attributes[r];if("option"===t&&"selected"===r&&!1===l)continue;if(null===l)continue;if(!0===l&&(l=""),r.startsWith("rr_")){a[r]=l;continue}const c="textarea"===t&&"value"===r,d="style"===t&&"_cssText"===r;if(d&&o&&"string"==typeof l&&(l=ee(l,i)),!c&&!d||"string"!=typeof l)try{if(e.isSVG&&"xlink:href"===r)s.setAttributeNS("http://www.w3.org/1999/xlink",r,l.toString());else if("onload"===r||"onclick"===r||"onmouse"===r.substring(0,7))s.setAttribute("_"+r,l.toString());else{if("meta"===t&&"Content-Security-Policy"===e.attributes["http-equiv"]&&"content"===r){s.setAttribute("csp-content",l.toString());continue}("link"!==t||"preload"!==e.attributes.rel&&"modulepreload"!==e.attributes.rel||"script"!==e.attributes.as)&&("link"===t&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")||("img"===t&&e.attributes.srcset&&e.attributes.rr_dataURL?s.setAttribute("rrweb-original-srcset",e.attributes.srcset):s.setAttribute(r,l.toString())))}}catch(e){}else s.appendChild(n.createTextNode(l)),e.childNodes=[]}for(const r in a){const n=a[r];if("canvas"===t&&"rr_dataURL"===r){const e=document.createElement("img");e.onload=()=>{const t=s.getContext("2d");t&&t.drawImage(e,0,0,e.width,e.height)},e.src=n.toString(),s.RRNodeType&&(s.rr_dataURL=n.toString())}else if("img"===t&&"rr_dataURL"===r){const t=s;t.currentSrc.startsWith("data:")||(t.setAttribute("rrweb-original-src",e.attributes.src),t.src=n.toString())}if("rr_width"===r)s.style.width=n.toString();else if("rr_height"===r)s.style.height=n.toString();else if("rr_mediaCurrentTime"===r&&"number"==typeof n)s.currentTime=n;else if("rr_mediaState"===r)switch(n){case"played":s.play().catch((e=>console.warn("media playback error",e)));break;case"paused":s.pause()}else"rr_mediaPlaybackRate"===r&&"number"==typeof n?s.playbackRate=n:"rr_mediaMuted"===r&&"boolean"==typeof n?s.muted=n:"rr_mediaLoop"===r&&"boolean"==typeof n?s.loop=n:"rr_mediaVolume"===r&&"number"==typeof n&&(s.volume=n)}if(e.isShadowHost)if(s.shadowRoot)for(;s.shadowRoot.firstChild;)s.shadowRoot.removeChild(s.shadowRoot.firstChild);else s.attachShadow({mode:"open"});return s}case s.Text:return n.createTextNode(e.isStyle&&o?ee(e.textContent,i):e.textContent);case s.CDATA:return n.createCDATASection(e.textContent);case s.Comment:return n.createComment(e.textContent);default:return null}}function ne(e,t){const{doc:r,mirror:n,skipChild:o=!1,hackCss:a=!0,afterAppend:l,cache:c}=t;if(n.has(e.id)){const t=n.getNode(e.id);if(function(e,t){return!(!e||!t||e.type!==t.type)&&(e.type===s.Document?e.compatMode===t.compatMode:e.type===s.DocumentType?e.name===t.name&&e.publicId===t.publicId&&e.systemId===t.systemId:e.type===s.Comment||e.type===s.Text||e.type===s.CDATA?e.textContent===t.textContent:e.type===s.Element&&e.tagName===t.tagName&&JSON.stringify(e.attributes)===JSON.stringify(t.attributes)&&e.isSVG===t.isSVG&&e.needBlock===t.needBlock)}(n.getMeta(t),e))return n.getNode(e.id)}let d=re(e,{doc:r,hackCss:a,cache:c});if(!d)return null;if(e.rootId&&n.getNode(e.rootId)!==r&&n.replace(e.rootId,r),e.type===s.Document&&(r.close(),r.open(),"BackCompat"===e.compatMode&&e.childNodes&&e.childNodes[0].type!==s.DocumentType&&(e.childNodes[0].type===s.Element&&"xmlns"in e.childNodes[0].attributes&&"http://www.w3.org/1999/xhtml"===e.childNodes[0].attributes.xmlns?r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),d=r),n.add(d,e),(e.type===s.Document||e.type===s.Element)&&!o)for(const t of e.childNodes){const o=ne(t,{doc:r,mirror:n,skipChild:!1,hackCss:a,afterAppend:l,cache:c});if(o){if(t.isShadow&&i(d)&&d.shadowRoot)d.shadowRoot.appendChild(o);else if(e.type===s.Document&&t.type==s.Element){const e=o;let t=null;e.childNodes.forEach((e=>{"BODY"===e.nodeName&&(t=e)})),t?(e.removeChild(t),d.appendChild(o),e.appendChild(t)):d.appendChild(o)}else d.appendChild(o);l&&l(o,t.id)}else console.warn("Failed to rebuild",t)}return d}function se(e,t){const{doc:r,onVisit:n,hackCss:o=!0,afterAppend:i,cache:a,mirror:l=new u}=t,c=ne(e,{doc:r,mirror:l,skipChild:!1,hackCss:o,afterAppend:i,cache:a});return function(e,t){for(const n of e.getIds())e.has(n)&&(r=e.getNode(n),t(r));var r}(l,(e=>{n&&n(e),function(e,t){const r=t.getMeta(e);if((null==r?void 0:r.type)!==s.Element)return;const n=e;for(const e in r.attributes){if(!Object.prototype.hasOwnProperty.call(r.attributes,e)||!e.startsWith("rr_"))continue;const t=r.attributes[e];"rr_scrollLeft"===e&&(n.scrollLeft=t),"rr_scrollTop"===e&&(n.scrollTop=t)}}(e,l)})),c}function oe(e,t,r=document){const n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}const ie="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let ae={map:{},getId:()=>(console.error(ie),-1),getNode:()=>(console.error(ie),null),removeNodeFromMap(){console.error(ie)},has:()=>(console.error(ie),!1),reset(){console.error(ie)}};function le(e,t,r={}){let n=null,s=0;return function(...o){const i=Date.now();s||!1!==r.leading||(s=i);const a=t-(i-s),l=this;a<=0||a>t?(n&&(clearTimeout(n),n=null),s=i,e.apply(l,o)):n||!1===r.trailing||(n=setTimeout((()=>{s=!1===r.leading?0:Date.now(),n=null,e.apply(l,o)}),a))}}function ce(e,t,r,n,s=window){const o=s.Object.getOwnPropertyDescriptor(e,t);return s.Object.defineProperty(e,t,n?r:{set(e){setTimeout((()=>{r.set.call(this,e)}),0),o&&o.set&&o.set.call(this,e)}}),()=>ce(e,t,o||{},!0)}function de(e,t,r){try{if(!(t in e))return()=>{};const n=e[t],s=r(n);return"function"==typeof s&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:n}})),e[t]=s,()=>{e[t]=n}}catch(e){return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(ae=new Proxy(ae,{get:(e,t,r)=>("map"===t&&console.error(ie),Reflect.get(e,t,r))}));let ue=Date.now;function he(e){var t,r,n,s,o,i;const a=e.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:(null==a?void 0:a.documentElement.scrollLeft)||(null===(r=null===(t=null==a?void 0:a.body)||void 0===t?void 0:t.parentElement)||void 0===r?void 0:r.scrollLeft)||(null===(n=null==a?void 0:a.body)||void 0===n?void 0:n.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:(null==a?void 0:a.documentElement.scrollTop)||(null===(o=null===(s=null==a?void 0:a.body)||void 0===s?void 0:s.parentElement)||void 0===o?void 0:o.scrollTop)||(null===(i=null==a?void 0:a.body)||void 0===i?void 0:i.scrollTop)||0}}function pe(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function me(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function fe(e){if(!e)return null;return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}function ge(e,t,r,n){if(!e)return!1;const s=fe(e);if(!s)return!1;try{if("string"==typeof t){if(s.classList.contains(t))return!0;if(n&&null!==s.closest("."+t))return!0}else if(B(s,t,n))return!0}catch(e){}if(r){if(s.matches(r))return!0;if(n&&null!==s.closest(r))return!0}return!1}function ye(e,t){return-1!==t.getId(e)}function ve(e,t){return t.getId(e)===E}function Se(e,t){if(a(e))return!1;const r=t.getId(e);return!t.has(r)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||Se(e.parentNode,t))}function be(e){return Boolean(e.changedTouches)}function Ee(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}function we(e){const t={},r=(e,r)=>{const n={value:e,parent:r,children:[]};return t[e.node.id]=n,n},n=[];for(const s of e){const{nextId:e,parentId:o}=s;if(e&&e in t){const o=t[e];if(o.parent){const e=o.parent.children.indexOf(o);o.parent.children.splice(e,0,r(s,o.parent))}else{const e=n.indexOf(o);n.splice(e,0,r(s,null))}}else if(o in t){const e=t[o];e.children.push(r(s,e))}else n.push(r(s,null))}return n}function Te(e,t){t(e.value);for(let r=e.children.length-1;r>=0;r--)Te(e.children[r],t)}function Ie(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function Me(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function Ne(e,t){var r,n;const s=null===(n=null===(r=e.ownerDocument)||void 0===r?void 0:r.defaultView)||void 0===n?void 0:n.frameElement;if(!s||s===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};const o=s.getBoundingClientRect(),i=Ne(s,t),a=o.height/s.clientHeight;return{x:o.x*i.relativeScale+i.x,y:o.y*i.relativeScale+i.y,relativeScale:a,absoluteScale:i.absoluteScale*a}}function Ce(e){return Boolean(null==e?void 0:e.shadowRoot)}function Oe(e,t){const r=e[t[0]];return 1===t.length?r:Oe(r.cssRules[t[1]].cssRules,t.slice(2))}function Ae(e){const t=[...e],r=t.pop();return{positions:t,index:r}}function ke(e){const t=new Set,r=[];for(let n=e.length;n--;){const s=e[n];t.has(s.id)||(r.push(s),t.add(s.id))}return r}/[1-9][0-9]{12}/.test(Date.now().toString())||(ue=()=>(new Date).getTime());class Re{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var t;return null!==(t=this.styleIDMap.get(e))&&void 0!==t?t:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let r;return r=void 0===t?this.id++:t,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function De(e){var t,r;let n=null;return(null===(r=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||void 0===r?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(n=e.getRootNode().host),n}function _e(e){let t,r=e;for(;t=De(r);)r=t;return r}function Le(e){const t=e.ownerDocument;if(!t)return!1;const r=_e(e);return t.contains(r)}function xe(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||Le(e))}var Pe=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(Pe||{}),Ue=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(Ue||{}),Fe=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(Fe||{}),Be=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(Be||{}),je=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(je||{}),Ve=(e=>(e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back",e.Destroy="destroy",e))(Ve||{});function We(e){return"__ln"in e}class He{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let r=0;r<e;r++)t=(null==t?void 0:t.next)||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&We(e.previousSibling)){const r=e.previousSibling.__ln.next;t.next=r,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,r&&(r.previous=t)}else if(e.nextSibling&&We(e.nextSibling)&&e.nextSibling.__ln.previous){const r=e.nextSibling.__ln.previous;t.previous=r,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,r&&(r.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const ze=(e,t)=>`${e}@${t}`;class Ge{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new Set,r=new He,n=e=>{let t=e,r=E;for(;r===E;)t=t&&t.nextSibling,r=t&&this.mirror.getId(t);return r},s=s=>{if(!s.parentNode||!xe(s)||"TEXTAREA"===s.parentNode.tagName)return;const o=a(s.parentNode)?this.mirror.getId(De(s)):this.mirror.getId(s.parentNode),i=n(s);if(-1===o||-1===i)return r.addNode(s);const l=H(s,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{Ie(e,this.mirror)&&this.iframeManager.addIframe(e),Me(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),Ce(s)&&this.shadowDomManager.addShadowRoot(s.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});l&&(e.push({parentId:o,nextId:i,node:l}),t.add(l.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift(),(e=>{Ce(e)&&this.shadowDomManager.removeShadowRoot(e.shadowRoot)}));for(const e of this.movedSet)Ye(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||s(e);for(const e of this.addedSet)Xe(this.droppedSet,e)||Ye(this.removes,e,this.mirror)?Xe(this.movedSet,e)?s(e):this.droppedSet.add(e):s(e);let o=null;for(;r.length;){let e=null;if(o){const t=this.mirror.getId(o.value.parentNode),r=n(o.value);-1!==t&&-1!==r&&(e=o)}if(!e){let t=r.tail;for(;t;){const r=t;if(t=t.previous,r){const t=this.mirror.getId(r.value.parentNode);if(-1===n(r.value))continue;if(-1!==t){e=r;break}{const t=r.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const n=t.parentNode.host;if(-1!==this.mirror.getId(n)){e=r;break}}}}}}if(!e){for(;r.head;)r.removeNode(r.head.value);break}o=e.previous,r.removeNode(e.value),s(e.value)}const i={texts:this.texts.map((e=>{const t=e.node;return t.parentNode&&"TEXTAREA"===t.parentNode.tagName&&this.genTextAreaValueMutation(t.parentNode),{id:this.mirror.getId(t),value:e.value}})).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),attributes:this.attributes.map((e=>{const{attributes:t}=e;if("string"==typeof t.style){const r=JSON.stringify(e.styleDiff),n=JSON.stringify(e._unchangedStyles);r.length<t.style.length&&(r+n).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}})).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),removes:this.removes,adds:e};(i.texts.length||i.attributes.length||i.removes.length||i.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(i))},this.genTextAreaValueMutation=e=>{let t=this.attributeMap.get(e);t||(t={node:e,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(t),this.attributeMap.set(e,t)),t.attributes.value=Array.from(e.childNodes,(e=>e.textContent||"")).join("")},this.processMutation=e=>{if(!ve(e.target,this.mirror))switch(e.type){case"characterData":{const t=e.target.textContent;ge(e.target,this.blockClass,this.blockSelector,!1)||t===e.oldValue||this.texts.push({value:j(e.target,this.maskTextClass,this.maskTextSelector,!0)&&t?this.maskTextFn?this.maskTextFn(t,fe(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let r=e.attributeName,n=e.target.getAttribute(r);if("value"===r){const e=y(t);n=m({element:t,maskInputOptions:this.maskInputOptions,tagName:t.tagName,type:e,value:n,maskInputFn:this.maskInputFn})}if(ge(e.target,this.blockClass,this.blockSelector,!1)||n===e.oldValue)return;let s=this.attributeMap.get(e.target);if("IFRAME"===t.tagName&&"src"===r&&!this.keepIframeSrcFn(n)){if(t.contentDocument)return;r="rr_src"}if(s||(s={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(s),this.attributeMap.set(e.target,s)),"type"===r&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!F(t.tagName,r)&&(s.attributes[r]=U(this.doc,f(t.tagName),f(r),n),"style"===r)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(e){this.unattachedDoc=this.doc}const r=this.unattachedDoc.createElement("span");e.oldValue&&r.setAttribute("style",e.oldValue);for(const e of Array.from(t.style)){const n=t.style.getPropertyValue(e),o=t.style.getPropertyPriority(e);n!==r.style.getPropertyValue(e)||o!==r.style.getPropertyPriority(e)?s.styleDiff[e]=""===o?n:[n,o]:s._unchangedStyles[e]=[n,o]}for(const e of Array.from(r.style))""===t.style.getPropertyValue(e)&&(s.styleDiff[e]=!1)}"src"===e.attributeName&&"IMG"===e.target.nodeName&&this.maskTextClass&&"string"==typeof this.maskTextClass&&t.classList.toString().includes(this.maskTextClass)&&(s.attributes[e.attributeName]=U(this.doc,f(e.target.tagName),e.attributeName,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAABNJREFUCB1jZGBg+A/EDEwgAgQADigBA//q6GsAAAAASUVORK5CYII%3D"));break}case"childList":if(ge(e.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===e.target.tagName)return void this.genTextAreaValueMutation(e.target);e.addedNodes.forEach((t=>this.genAdds(t,e.target))),e.removedNodes.forEach((t=>{const r=this.mirror.getId(t),n=a(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);ge(e.target,this.blockClass,this.blockSelector,!1)||ve(t,this.mirror)||!ye(t,this.mirror)||(this.addedSet.has(t)?($e(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===r||Se(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[ze(r,n)]?$e(this.movedSet,t):this.removes.push({parentId:n,id:r,isShadow:!(!a(e.target)||!l(e.target))||void 0})),this.mapRemoves.push(t))}))}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!this.addedSet.has(e)&&!this.movedSet.has(e)){if(this.mirror.hasNode(e)){if(ve(e,this.mirror))return;this.movedSet.add(e);let r=null;t&&this.mirror.hasNode(t)&&(r=this.mirror.getId(t)),r&&-1!==r&&(this.movedMap[ze(this.mirror.getId(e),r)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);ge(e,this.blockClass,this.blockSelector,!1)||(e.childNodes.forEach((e=>this.genAdds(e))),Ce(e)&&e.shadowRoot.childNodes.forEach((t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)})))}}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((t=>{this[t]=e[t]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function $e(e,t){e.delete(t),t.childNodes.forEach((t=>$e(e,t)))}function Ye(e,t,r){return 0!==e.length&&qe(e,t,r)}function qe(e,t,r){const{parentNode:n}=t;if(!n)return!1;const s=r.getId(n);return!!e.some((e=>e.id===s))||qe(e,n,r)}function Xe(e,t){return 0!==e.size&&Ke(e,t)}function Ke(e,t){const{parentNode:r}=t;return!!r&&(!!e.has(r)||Ke(e,r))}let Qe;function Je(e){Qe=e}function Ze(){Qe=void 0}const et=e=>{if(!Qe)return e;return(...t)=>{try{return e(...t)}catch(e){if(Qe&&!0===Qe(e))return;throw e}}};let tt=[];const rt=()=>{tt=[]};function nt(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch(e){}return e&&e.target}function st(e,t){var r,n;const s=new Ge;tt.push(s),s.init(e);let o=window.MutationObserver||window.__rrMutationObserver;const i=null===(n=null===(r=null===window||void 0===window?void 0:window.Zone)||void 0===r?void 0:r.__symbol__)||void 0===n?void 0:n.call(r,"MutationObserver");i&&window[i]&&(o=window[i]);const a=new o(et(s.processMutations.bind(s)));return a.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function ot({mouseInteractionCb:e,doc:t,mirror:r,blockClass:n,blockSelector:s,sampling:o}){if(!1===o.mouseInteraction)return()=>{};const i=!0===o.mouseInteraction||void 0===o.mouseInteraction?{}:o.mouseInteraction,a=[];let l=null;return Object.keys(Fe).filter((e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==i[e])).forEach((o=>{let i=f(o);const c=(t=>o=>{const i=nt(o);if(ge(i,n,s,!0))return;let a=null,c=t;if("pointerType"in o){switch(o.pointerType){case"mouse":a=Be.Mouse;break;case"touch":a=Be.Touch;break;case"pen":a=Be.Pen}a===Be.Touch?Fe[t]===Fe.MouseDown?c="TouchStart":Fe[t]===Fe.MouseUp&&(c="TouchEnd"):Be.Pen}else be(o)&&(a=Be.Touch);null!==a?(l=a,(c.startsWith("Touch")&&a===Be.Touch||c.startsWith("Mouse")&&a===Be.Mouse)&&(a=null)):Fe[t]===Fe.Click&&(a=l,l=null);const d=be(o)?o.changedTouches[0]:o;if(!d)return;const u=r.getId(i),{clientX:h,clientY:p}=d;et(e)(Object.assign({type:Fe[c],id:u,x:h,y:p},null!==a&&{pointerType:a}))})(o);if(window.PointerEvent)switch(Fe[o]){case Fe.MouseDown:case Fe.MouseUp:i=i.replace("mouse","pointer");break;case Fe.TouchStart:case Fe.TouchEnd:return}a.push(oe(i,c,t))})),et((()=>{a.forEach((e=>e()))}))}function it({scrollCb:e,doc:t,mirror:r,blockClass:n,blockSelector:s,sampling:o}){return oe("scroll",et(le(et((o=>{const i=nt(o);if(!i||ge(i,n,s,!0))return;const a=r.getId(i);if(i===t&&t.defaultView){const r=he(t.defaultView);e({id:a,x:r.left,y:r.top})}else e({id:a,x:i.scrollLeft,y:i.scrollTop})})),o.scroll||100)),t)}const at=["INPUT","TEXTAREA","SELECT"],lt=new WeakMap;function ct(e){return function(e,t){if(pt("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||pt("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||pt("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||pt("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){const r=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(r)}else if(e.parentStyleSheet){const r=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(r)}return t}(e,[])}function dt(e,t,r){let n,s;return e?(e.ownerNode?n=t.getId(e.ownerNode):s=r.getId(e),{styleId:s,id:n}):{}}function ut({mirror:e,stylesheetManager:t},r){var n,s,o;let i=null;i="#document"===r.nodeName?e.getId(r):e.getId(r.host);const a="#document"===r.nodeName?null===(n=r.defaultView)||void 0===n?void 0:n.Document:null===(o=null===(s=r.ownerDocument)||void 0===s?void 0:s.defaultView)||void 0===o?void 0:o.ShadowRoot,l=(null==a?void 0:a.prototype)?Object.getOwnPropertyDescriptor(null==a?void 0:a.prototype,"adoptedStyleSheets"):void 0;return null!==i&&-1!==i&&a&&l?(Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get(){var e;return null===(e=l.get)||void 0===e?void 0:e.call(this)},set(e){var r;const n=null===(r=l.set)||void 0===r?void 0:r.call(this,e);if(null!==i&&-1!==i)try{t.adoptStyleSheets(e,i)}catch(e){}return n}}),et((()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get:l.get,set:l.set})}))):()=>{}}function ht(e,t={}){const r=e.doc.defaultView;if(!r)return()=>{};let n;!function(e,t){const{mutationCb:r,mousemoveCb:n,mouseInteractionCb:s,scrollCb:o,viewportResizeCb:i,inputCb:a,mediaInteractionCb:l,styleSheetRuleCb:c,styleDeclarationCb:d,canvasMutationCb:u,fontCb:h,selectionCb:p,customElementCb:m}=e;e.mutationCb=(...e)=>{t.mutation&&t.mutation(...e),r(...e)},e.mousemoveCb=(...e)=>{t.mousemove&&t.mousemove(...e),n(...e)},e.mouseInteractionCb=(...e)=>{t.mouseInteraction&&t.mouseInteraction(...e),s(...e)},e.scrollCb=(...e)=>{t.scroll&&t.scroll(...e),o(...e)},e.viewportResizeCb=(...e)=>{t.viewportResize&&t.viewportResize(...e),i(...e)},e.inputCb=(...e)=>{t.input&&t.input(...e),a(...e)},e.mediaInteractionCb=(...e)=>{t.mediaInteaction&&t.mediaInteaction(...e),l(...e)},e.styleSheetRuleCb=(...e)=>{t.styleSheetRule&&t.styleSheetRule(...e),c(...e)},e.styleDeclarationCb=(...e)=>{t.styleDeclaration&&t.styleDeclaration(...e),d(...e)},e.canvasMutationCb=(...e)=>{t.canvasMutation&&t.canvasMutation(...e),u(...e)},e.fontCb=(...e)=>{t.font&&t.font(...e),h(...e)},e.selectionCb=(...e)=>{t.selection&&t.selection(...e),p(...e)},e.customElementCb=(...e)=>{t.customElement&&t.customElement(...e),m(...e)}}(e,t),e.recordDOM&&(n=st(e,e.doc));const s=function({mousemoveCb:e,sampling:t,doc:r,mirror:n}){if(!1===t.mousemove)return()=>{};const s="number"==typeof t.mousemove?t.mousemove:50,o="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let i,a=[];const l=le(et((t=>{const r=Date.now()-i;e(a.map((e=>(e.timeOffset-=r,e))),t),a=[],i=null})),o),c=et(le(et((e=>{const t=nt(e),{clientX:r,clientY:s}=be(e)?e.changedTouches[0]:e;i||(i=ue()),a.push({x:r,y:s,id:n.getId(t),timeOffset:ue()-i}),l("undefined"!=typeof DragEvent&&e instanceof DragEvent?Ue.Drag:e instanceof MouseEvent?Ue.MouseMove:Ue.TouchMove)})),s,{trailing:!1})),d=[oe("mousemove",c,r),oe("touchmove",c,r),oe("drag",c,r)];return et((()=>{d.forEach((e=>e()))}))}(e),o=ot(e),i=it(e),a=function({viewportResizeCb:e},{win:t}){let r=-1,n=-1;return oe("resize",et(le(et((()=>{const t=pe(),s=me();r===t&&n===s||(e({width:Number(s),height:Number(t)}),r=t,n=s)})),200)),t)}(e,{win:r}),l=function({inputCb:e,doc:t,mirror:r,blockClass:n,blockSelector:s,ignoreClass:o,ignoreSelector:i,maskInputOptions:a,maskInputFn:l,maskInputClass:c,sampling:d,userTriggeredOnInput:u}){function h(e){let r=nt(e);const d=e.isTrusted,h=r&&r.tagName;if(r&&"OPTION"===h&&(r=r.parentElement),!r||!h||at.indexOf(h)<0||ge(r,n,s,!0))return;if(r.classList.contains(o)||i&&r.matches(i))return;let f=r.value,g=!1;const v=y(r)||"";"radio"===v||"checkbox"===v?g=r.checked:a[h.toLowerCase()]||a[v]?f=m({element:r,maskInputOptions:a,tagName:h,type:v,value:f,maskInputFn:l}):r.classList.contains(c)&&(f="*".repeat(f.length)),p(r,u?{text:f,isChecked:g,userTriggered:d}:{text:f,isChecked:g});const S=r.name;"radio"===v&&S&&g&&t.querySelectorAll(`input[type="radio"][name="${S}"]`).forEach((e=>{if(e!==r){const t=e.value;p(e,u?{text:t,isChecked:!g,userTriggered:!1}:{text:t,isChecked:!g})}}))}function p(t,n){const s=lt.get(t);if(!s||s.text!==n.text||s.isChecked!==n.isChecked){lt.set(t,n);const s=r.getId(t);et(e)(Object.assign(Object.assign({},n),{id:s}))}}const f=("last"===d.input?["change"]:["input","change"]).map((e=>oe(e,et(h),t))),g=t.defaultView;if(!g)return()=>{f.forEach((e=>e()))};const v=g.Object.getOwnPropertyDescriptor(g.HTMLInputElement.prototype,"value"),S=[[g.HTMLInputElement.prototype,"value"],[g.HTMLInputElement.prototype,"checked"],[g.HTMLSelectElement.prototype,"value"],[g.HTMLTextAreaElement.prototype,"value"],[g.HTMLSelectElement.prototype,"selectedIndex"],[g.HTMLOptionElement.prototype,"selected"]];return v&&v.set&&f.push(...S.map((e=>ce(e[0],e[1],{set(){et(h)({target:this,isTrusted:!1})}},!1,g)))),et((()=>{f.forEach((e=>e()))}))}(e),c=function({mediaInteractionCb:e,blockClass:t,blockSelector:r,mirror:n,sampling:s,doc:o}){const i=et((o=>le(et((s=>{const i=nt(s);if(!i||ge(i,t,r,!0))return;const{currentTime:a,volume:l,muted:c,playbackRate:d,loop:u}=i;e({type:o,id:n.getId(i),currentTime:a,volume:l,muted:c,playbackRate:d,loop:u})})),s.media||500))),a=[oe("play",i(0),o),oe("pause",i(1),o),oe("seeked",i(2),o),oe("volumechange",i(3),o),oe("ratechange",i(4),o)];return et((()=>{a.forEach((e=>e()))}))}(e);let d=()=>{},u=()=>{},h=()=>{},p=()=>{};e.recordDOM&&(d=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:r},{win:n}){if(!n.CSSStyleSheet||!n.CSSStyleSheet.prototype)return()=>{};const s=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:et(((n,s,o)=>{const[i,a]=o,{id:l,styleId:c}=dt(s,t,r.styleMirror);return(l&&-1!==l||c&&-1!==c)&&e({id:l,styleId:c,adds:[{rule:i,index:a}]}),n.apply(s,o)}))});const o=n.CSSStyleSheet.prototype.deleteRule;let i,a;n.CSSStyleSheet.prototype.deleteRule=new Proxy(o,{apply:et(((n,s,o)=>{const[i]=o,{id:a,styleId:l}=dt(s,t,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&e({id:a,styleId:l,removes:[{index:i}]}),n.apply(s,o)}))}),n.CSSStyleSheet.prototype.replace&&(i=n.CSSStyleSheet.prototype.replace,n.CSSStyleSheet.prototype.replace=new Proxy(i,{apply:et(((n,s,o)=>{const[i]=o,{id:a,styleId:l}=dt(s,t,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&e({id:a,styleId:l,replace:i}),n.apply(s,o)}))})),n.CSSStyleSheet.prototype.replaceSync&&(a=n.CSSStyleSheet.prototype.replaceSync,n.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:et(((n,s,o)=>{const[i]=o,{id:a,styleId:l}=dt(s,t,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&e({id:a,styleId:l,replaceSync:i}),n.apply(s,o)}))}));const l={};mt("CSSGroupingRule")?l.CSSGroupingRule=n.CSSGroupingRule:(mt("CSSMediaRule")&&(l.CSSMediaRule=n.CSSMediaRule),mt("CSSConditionRule")&&(l.CSSConditionRule=n.CSSConditionRule),mt("CSSSupportsRule")&&(l.CSSSupportsRule=n.CSSSupportsRule));const c={};return Object.entries(l).forEach((([n,s])=>{c[n]={insertRule:s.prototype.insertRule,deleteRule:s.prototype.deleteRule},s.prototype.insertRule=new Proxy(c[n].insertRule,{apply:et(((n,s,o)=>{const[i,a]=o,{id:l,styleId:c}=dt(s.parentStyleSheet,t,r.styleMirror);return(l&&-1!==l||c&&-1!==c)&&e({id:l,styleId:c,adds:[{rule:i,index:[...ct(s),a||0]}]}),n.apply(s,o)}))}),s.prototype.deleteRule=new Proxy(c[n].deleteRule,{apply:et(((n,s,o)=>{const[i]=o,{id:a,styleId:l}=dt(s.parentStyleSheet,t,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&e({id:a,styleId:l,removes:[{index:[...ct(s),i]}]}),n.apply(s,o)}))})})),et((()=>{n.CSSStyleSheet.prototype.insertRule=s,n.CSSStyleSheet.prototype.deleteRule=o,i&&(n.CSSStyleSheet.prototype.replace=i),a&&(n.CSSStyleSheet.prototype.replaceSync=a),Object.entries(l).forEach((([e,t])=>{t.prototype.insertRule=c[e].insertRule,t.prototype.deleteRule=c[e].deleteRule}))}))}(e,{win:r}),u=ut(e,e.doc),h=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:r,stylesheetManager:n},{win:s}){const o=s.CSSStyleDeclaration.prototype.setProperty;s.CSSStyleDeclaration.prototype.setProperty=new Proxy(o,{apply:et(((s,i,a)=>{var l;const[c,d,u]=a;if(r.has(c))return o.apply(i,[c,d,u]);const{id:h,styleId:p}=dt(null===(l=i.parentRule)||void 0===l?void 0:l.parentStyleSheet,t,n.styleMirror);return(h&&-1!==h||p&&-1!==p)&&e({id:h,styleId:p,set:{property:c,value:d,priority:u},index:ct(i.parentRule)}),s.apply(i,a)}))});const i=s.CSSStyleDeclaration.prototype.removeProperty;return s.CSSStyleDeclaration.prototype.removeProperty=new Proxy(i,{apply:et(((s,o,a)=>{var l;const[c]=a;if(r.has(c))return i.apply(o,[c]);const{id:d,styleId:u}=dt(null===(l=o.parentRule)||void 0===l?void 0:l.parentStyleSheet,t,n.styleMirror);return(d&&-1!==d||u&&-1!==u)&&e({id:d,styleId:u,remove:{property:c},index:ct(o.parentRule)}),s.apply(o,a)}))}),et((()=>{s.CSSStyleDeclaration.prototype.setProperty=o,s.CSSStyleDeclaration.prototype.removeProperty=i}))}(e,{win:r}),e.collectFonts&&(p=function({fontCb:e,doc:t}){const r=t.defaultView;if(!r)return()=>{};const n=[],s=new WeakMap,o=r.FontFace;r.FontFace=function(e,t,r){const n=new o(e,t,r);return s.set(n,{family:e,buffer:"string"!=typeof t,descriptors:r,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),n};const i=de(t.fonts,"add",(function(t){return function(r){return setTimeout(et((()=>{const t=s.get(r);t&&(e(t),s.delete(r))})),0),t.apply(this,[r])}}));return n.push((()=>{r.FontFace=o})),n.push(i),et((()=>{n.forEach((e=>e()))}))}(e)));const f=function(e){const{doc:t,mirror:r,blockClass:n,blockSelector:s,selectionCb:o}=e;let i=!0;const a=et((()=>{const e=t.getSelection();if(!e||i&&(null==e?void 0:e.isCollapsed))return;i=e.isCollapsed||!1;const a=[],l=e.rangeCount||0;for(let t=0;t<l;t++){const o=e.getRangeAt(t),{startContainer:i,startOffset:l,endContainer:c,endOffset:d}=o;ge(i,n,s,!0)||ge(c,n,s,!0)||a.push({start:r.getId(i),startOffset:l,end:r.getId(c),endOffset:d})}o({ranges:a})}));return a(),oe("selectionchange",a)}(e),g=function({doc:e,customElementCb:t}){const r=e.defaultView;return r&&r.customElements?de(r.customElements,"define",(function(e){return function(r,n,s){try{t({define:{name:r}})}catch(e){console.warn(`Custom element callback failed for ${r}`)}return e.apply(this,[r,n,s])}})):()=>{}}(e),v=[];for(const t of e.plugins)v.push(t.observer(t.callback,r,t.options));return et((()=>{tt.forEach((e=>e.reset())),null==n||n.disconnect(),s(),o(),i(),a(),l(),c(),d(),u(),h(),p(),f(),g(),v.forEach((e=>e()))}))}function pt(e){return void 0!==window[e]}function mt(e){return Boolean(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class ft{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,r,n){const s=r||this.getIdToRemoteIdMap(e),o=n||this.getRemoteIdToIdMap(e);let i=s.get(t);return i||(i=this.generateIdFn(),s.set(t,i),o.set(i,t)),i}getIds(e,t){const r=this.getIdToRemoteIdMap(e),n=this.getRemoteIdToIdMap(e);return t.map((t=>this.getId(e,t,r,n)))}getRemoteId(e,t,r){const n=r||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;const s=n.get(t);return s||-1}getRemoteIds(e,t){const r=this.getRemoteIdToIdMap(e);return t.map((t=>this.getRemoteId(e,t,r)))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class gt{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new ft(T),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new ft(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.boundHandleMessage=this.handleMessage.bind(this),this.recordCrossOriginIframes&&window.addEventListener("message",this.boundHandleMessage)}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var r;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(r=this.loadListener)||void 0===r||r.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const r=this.crossOriginIframeMap.get(e.source);if(!r)return;const n=this.transformCrossOriginEvent(r,t.data.event);n&&this.wrappedEmit(n,t.data.isCheckout)}transformCrossOriginEvent(e,t){var r;switch(t.type){case Pe.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const r=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,r),this.patchRootIdOnNode(t.data.node,r),{timestamp:t.timestamp,type:Pe.IncrementalSnapshot,data:{source:Ue.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case Pe.Meta:case Pe.Load:case Pe.DomContentLoaded:return!1;case Pe.Plugin:return t;case Pe.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case Pe.IncrementalSnapshot:switch(t.data.source){case Ue.Mutation:return t.data.adds.forEach((t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const r=this.crossOriginIframeRootIdMap.get(e);r&&this.patchRootIdOnNode(t.node,r)})),t.data.removes.forEach((t=>{this.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((t=>{this.replaceIds(t,e,["id"])})),t.data.texts.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case Ue.Drag:case Ue.TouchMove:case Ue.MouseMove:return t.data.positions.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case Ue.ViewportResize:return!1;case Ue.MediaInteraction:case Ue.MouseInteraction:case Ue.Scroll:case Ue.CanvasMutation:case Ue.Input:return this.replaceIds(t.data,e,["id"]),t;case Ue.StyleSheetRule:case Ue.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case Ue.Font:return t;case Ue.Selection:return t.data.ranges.forEach((t=>{this.replaceIds(t,e,["start","end"])})),t;case Ue.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null===(r=t.data.styles)||void 0===r||r.forEach((t=>{this.replaceStyleIds(t,e,["styleId"])})),t}}return!1}replace(e,t,r,n){for(const s of n)(Array.isArray(t[s])||"number"==typeof t[s])&&(Array.isArray(t[s])?t[s]=e.getIds(r,t[s]):t[s]=e.getId(r,t[s]));return t}replaceIds(e,t,r){return this.replace(this.crossOriginIframeMirror,e,t,r)}replaceStyleIds(e,t,r){return this.replace(this.crossOriginIframeStyleMirror,e,t,r)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach((e=>{this.replaceIdOnNode(e,t)}))}patchRootIdOnNode(e,t){e.type===s.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach((e=>{this.patchRootIdOnNode(e,t)}))}cleanup(){window.removeEventListener("message",this.boundHandleMessage)}}class yt{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.restoreHandlersMap=new Map,this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}removeShadowRoot(e){const t=this.restoreHandlersMap.get(e);t&&(t.forEach((e=>{window.requestIdleCallback?window.requestIdleCallback(e):setTimeout(e,1)})),this.restoreHandlersMap.delete(e))}addShadowRoot(e,t){if(!l(e))return;if(this.shadowDoms.has(e))return;this.shadowDoms.add(e);const r=st(Object.assign(Object.assign({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e),n=it(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}));this.restoreHandlersMap.set(e,[()=>r.disconnect(),n]),setTimeout((()=>{var t;e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),null===(t=this.restoreHandlersMap.get(e))||void 0===t||t.push(ut({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))}),0)}observeAttachShadow(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){const r=this;this.restoreHandlers.push(de(e.prototype,"attachShadow",(function(e){return function(n){const s=e.call(this,n);return this.shadowRoot&&xe(this)&&r.addShadowRoot(this.shadowRoot,t),s}})))}reset(){this.restoreHandlers.forEach((e=>{try{e()}catch(e){}})),this.restoreHandlers=[],this.restoreHandlersMap.forEach((e=>{e.forEach((e=>{try{e()}catch(e){}}))})),this.restoreHandlersMap=new Map,this.shadowDoms=new WeakSet}}function vt(e,t,r,n){return new(r||(r=Promise))((function(s,o){function i(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}l((n=n.apply(e,t||[])).next())}))}for(var St="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bt="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Et=0;Et<St.length;Et++)bt[St.charCodeAt(Et)]=Et;var wt=function(e){var t,r=new Uint8Array(e),n=r.length,s="";for(t=0;t<n;t+=3)s+=St[r[t]>>2],s+=St[(3&r[t])<<4|r[t+1]>>4],s+=St[(15&r[t+1])<<2|r[t+2]>>6],s+=St[63&r[t+2]];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},Tt=function(e){var t,r,n,s,o,i=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var c=new ArrayBuffer(i),d=new Uint8Array(c);for(t=0;t<a;t+=4)r=bt[e.charCodeAt(t)],n=bt[e.charCodeAt(t+1)],s=bt[e.charCodeAt(t+2)],o=bt[e.charCodeAt(t+3)],d[l++]=r<<2|n>>4,d[l++]=(15&n)<<4|s>>2,d[l++]=(3&s)<<6|63&o;return c};const It=new Map;const Mt=(e,t,r)=>{if(!e||!Ot(e,t)&&"object"!=typeof e)return;const n=function(e,t){let r=It.get(e);return r||(r=new Map,It.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}(r,e.constructor.name);let s=n.indexOf(e);return-1===s&&(s=n.length,n.push(e)),s};function Nt(e,t,r){if(e instanceof Array)return e.map((e=>Nt(e,t,r)));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray){return{rr_type:e.constructor.name,args:[Object.values(e)]}}if(e instanceof ArrayBuffer){return{rr_type:e.constructor.name,base64:wt(e)}}if(e instanceof DataView){return{rr_type:e.constructor.name,args:[Nt(e.buffer,t,r),e.byteOffset,e.byteLength]}}if(e instanceof HTMLImageElement){const t=e.constructor.name,{src:r}=e;return{rr_type:t,src:r}}if(e instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:e.toDataURL()}}if(e instanceof ImageData){return{rr_type:e.constructor.name,args:[Nt(e.data,t,r),e.width,e.height]}}if(Ot(e,t)||"object"==typeof e){return{rr_type:e.constructor.name,index:Mt(e,t,r)}}return e}const Ct=(e,t,r)=>e.map((e=>Nt(e,t,r))),Ot=(e,t)=>{const r=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((e=>"function"==typeof t[e]));return Boolean(r.find((r=>e instanceof t[r])))};function At(e,t,r,n){const s=[];try{const o=de(e.HTMLCanvasElement.prototype,"getContext",(function(e){return function(s,...o){if(!ge(this,t,r,!0)){const e=function(e){return"experimental-webgl"===e?"webgl":e}(s);if("__context"in this||(this.__context=e),n&&["webgl","webgl2"].includes(e))if(o[0]&&"object"==typeof o[0]){const e=o[0];e.preserveDrawingBuffer||(e.preserveDrawingBuffer=!0)}else o.splice(0,1,{preserveDrawingBuffer:!0})}return e.apply(this,[s,...o])}}));s.push(o)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{s.forEach((e=>e()))}}function kt(e,t,r,n,s,o,i){const a=[],l=Object.getOwnPropertyNames(e);for(const o of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(o))try{if("function"!=typeof e[o])continue;const l=de(e,o,(function(e){return function(...a){const l=e.apply(this,a);if(Mt(l,i,this),"tagName"in this.canvas&&!ge(this.canvas,n,s,!0)){const e=Ct(a,i,this),n={type:t,property:o,args:e};r(this.canvas,n)}return l}}));a.push(l)}catch(n){const s=ce(e,o,{set(e){r(this.canvas,{type:t,property:o,args:[e],setter:!0})}});a.push(s)}return a}var Rt,Dt,_t,Lt,xt=(Rt=function(){!function(){function e(e,t,r,n){return new(r||(r=Promise))((function(s,o){function i(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}l((n=n.apply(e,t||[])).next())}))}for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="undefined"==typeof Uint8Array?[]:new Uint8Array(256),n=0;n<t.length;n++)r[t.charCodeAt(n)]=n;var s=function(e){var r,n=new Uint8Array(e),s=n.length,o="";for(r=0;r<s;r+=3)o+=t[n[r]>>2],o+=t[(3&n[r])<<4|n[r+1]>>4],o+=t[(15&n[r+1])<<2|n[r+2]>>6],o+=t[63&n[r+2]];return s%3==2?o=o.substring(0,o.length-1)+"=":s%3==1&&(o=o.substring(0,o.length-2)+"=="),o};const o=new Map,i=new Map,a=self;a.onmessage=function(t){return e(this,void 0,void 0,(function*(){if(!("OffscreenCanvas"in globalThis))return a.postMessage({id:t.data.id});{const{id:r,bitmap:n,width:l,height:c,dataURLOptions:d}=t.data,u=function(t,r,n){return e(this,void 0,void 0,(function*(){const e=`${t}-${r}`;if("OffscreenCanvas"in globalThis){if(i.has(e))return i.get(e);const o=new OffscreenCanvas(t,r);o.getContext("2d");const a=yield o.convertToBlob(n),l=yield a.arrayBuffer(),c=s(l);return i.set(e,c),c}return""}))}(l,c,d),h=new OffscreenCanvas(l,c);h.getContext("2d").drawImage(n,0,0),n.close();const p=yield h.convertToBlob(d),m=p.type,f=yield p.arrayBuffer(),g=s(f);if(!o.has(r)&&(yield u)===g)return o.set(r,g),a.postMessage({id:r});if(o.get(r)===g)return a.postMessage({id:r});a.postMessage({id:r,type:m,base64:g,width:l,height:c}),o.set(r,g)}}))}}()},Dt=null,function(e){return _t=_t||function(e,t){var r=function(e,t){var r=void 0===t?null:t,n=e.toString().split("\n");n.pop(),n.shift();for(var s=n[0].search(/\S/),o=/(['"])__worker_loader_strict__(['"])/g,i=0,a=n.length;i<a;++i)n[i]=n[i].substring(s).replace(o,"$1use strict$2")+"\n";return r&&n.push("//# sourceMappingURL="+r+"\n"),n}(e,t),n=new Blob(r,{type:"application/javascript"});return URL.createObjectURL(n)}(Rt,Dt),new Worker(_t,e)});class Pt{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};const{sampling:t="all",win:r,blockClass:n,blockSelector:s,recordCanvas:o,dataURLOptions:i}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,o&&"all"===t&&this.initCanvasMutationObserver(r,n,s),o&&"number"==typeof t&&this.initCanvasFPSObserver(t,r,n,s,{dataURLOptions:i})}initCanvasFPSObserver(e,t,r,n,s){const o=At(t,r,n,!0),i=new Map,a=new xt;a.onmessage=e=>{const{id:t}=e.data;if(i.set(t,!1),!("base64"in e.data))return;const{base64:r,type:n,width:s,height:o}=e.data;this.mutationCb({id:t,type:je["2D"],commands:[{property:"clearRect",args:[0,0,s,o]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:n}]},0,0]}]})};const l=1e3/e;let c,d=0;const u=e=>{d&&e-d<l||(d=e,(()=>{const e=[];return t.document.querySelectorAll("canvas").forEach((t=>{ge(t,r,n,!0)||e.push(t)})),e})().forEach((e=>vt(this,void 0,void 0,(function*(){var t;const r=this.mirror.getId(e);if(i.get(r))return;if(0===e.width||0===e.height)return;if(i.set(r,!0),["webgl","webgl2"].includes(e.__context)){const r=e.getContext(e.__context);!1===(null===(t=null==r?void 0:r.getContextAttributes())||void 0===t?void 0:t.preserveDrawingBuffer)&&r.clear(r.COLOR_BUFFER_BIT)}const n=yield createImageBitmap(e);a.postMessage({id:r,bitmap:n,width:e.width,height:e.height,dataURLOptions:s.dataURLOptions},[n])}))))),c=requestAnimationFrame(u)};c=requestAnimationFrame(u),this.resetObservers=()=>{o(),cancelAnimationFrame(c)}}initCanvasMutationObserver(e,t,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const n=At(e,t,r,!1),s=function(e,t,r,n){const s=[],o=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const i of o)try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[i])continue;const o=de(t.CanvasRenderingContext2D.prototype,i,(function(s){return function(...o){return ge(this.canvas,r,n,!0)||setTimeout((()=>{const r=Ct(o,t,this);e(this.canvas,{type:je["2D"],property:i,args:r})}),0),s.apply(this,o)}}));s.push(o)}catch(r){const n=ce(t.CanvasRenderingContext2D.prototype,i,{set(t){e(this.canvas,{type:je["2D"],property:i,args:[t],setter:!0})}});s.push(n)}return()=>{s.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,r),o=function(e,t,r,n,s){const o=[];return o.push(...kt(t.WebGLRenderingContext.prototype,je.WebGL,e,r,n,0,t)),void 0!==t.WebGL2RenderingContext&&o.push(...kt(t.WebGL2RenderingContext.prototype,je.WebGL2,e,r,n,0,t)),()=>{o.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,r,this.mirror);this.resetObservers=()=>{n(),s(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const e=t=>{this.rafStamps.latestId=t,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((e,t)=>{const r=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,r)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;const r=this.pendingCanvasMutations.get(e);if(!r||-1===t)return;const n=r.map((e=>{const t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r}(e,["type"]);return t})),{type:s}=r[0];this.mutationCb({id:t,type:s,commands:n}),this.pendingCanvasMutations.delete(e)}}class Ut{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new Re,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const r={id:t,styleIds:[]},n=[];for(const t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),n.push({styleId:e,rules:Array.from(t.rules||CSSRule,((e,t)=>({rule:d(e),index:t})))})),r.styleIds.push(e)}n.length>0&&(r.styles=n),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class Ft{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame((()=>{this.clear(),this.loop&&this.periodicallyClear()}))}inOtherBuffer(e,t){const r=this.nodeMap.get(e);return r&&Array.from(r).some((e=>e!==t))}add(e,t){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}let Bt,jt,Vt,Wt=!1;try{if(2!==Array.from([1],(e=>2*e))[0]){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=(null===(Lt=e.contentWindow)||void 0===Lt?void 0:Lt.Array.from)||Array.from,document.body.removeChild(e)}}catch(e){console.debug("Unable to override Array.from",e)}const Ht=h();function zt(e={}){const{emit:t,checkoutEveryNms:r,checkoutEveryNth:n,blockClass:s="rr-block",blockSelector:o=null,ignoreClass:i="rr-ignore",ignoreSelector:a=null,maskTextClass:l="rr-mask",maskInputClass:c="rr-input-mask",maskTextSelector:d=null,inlineStylesheet:h=!0,maskAllInputs:p,maskInputOptions:m,slimDOMOptions:f,maskInputFn:g,maskTextFn:y,hooks:v,packFn:S,sampling:b={},dataURLOptions:E={},mousemoveWait:w,recordDOM:T=!0,recordCanvas:I=!1,recordCrossOriginIframes:M=!1,recordAfter:N=("DOMContentLoaded"===e.recordAfter?e.recordAfter:"load"),userTriggeredOnInput:C=!1,collectFonts:O=!1,inlineImages:A=!1,plugins:k,keepIframeSrcFn:R=(()=>!1),ignoreCSSAttributes:D=new Set([]),errorHandler:_}=e;Je(_);const L=!M||window.parent===window;let x=!1;if(!L)try{window.parent.document&&(x=!1)}catch(e){x=!0}if(L&&!t)throw new Error("emit function is required");if(!L&&!x)return()=>{};void 0!==w&&void 0===b.mousemove&&(b.mousemove=w),Ht.reset();const P=!0===p?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==m?m:{password:!0},U=!0===f||"all"===f?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===f,headMetaDescKeywords:"all"===f}:f||{};let F;Ee();let B=0;const j=e=>{for(const t of k||[])t.eventProcessor&&(e=t.eventProcessor(e));return S&&!x&&(e=S(e)),e};Bt=(e,s)=>{var o;const i=e;if(i.timestamp=ue(),!(null===(o=tt[0])||void 0===o?void 0:o.isFrozen())||i.type===Pe.FullSnapshot||i.type===Pe.IncrementalSnapshot&&i.data.source===Ue.Mutation||tt.forEach((e=>e.unfreeze())),L)null==t||t(j(i),s);else if(x){const e={type:"rrweb",event:j(i),origin:window.location.origin,isCheckout:s};window.parent.postMessage(e,"*")}if(i.type===Pe.FullSnapshot)F=i,B=0;else if(i.type===Pe.IncrementalSnapshot){if(i.data.source===Ue.Mutation&&i.data.isAttachIframe)return;B++;const e=n&&B>=n,t=r&&i.timestamp-F.timestamp>r;(e||t)&&jt(!0)}};const V=e=>{Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.Mutation},e)})},W=e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.Scroll},e)}),z=e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.CanvasMutation},e)}),G=new Ut({mutationCb:V,adoptedStyleSheetCb:e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.AdoptedStyleSheet},e)})}),$=new gt({mirror:Ht,mutationCb:V,stylesheetManager:G,recordCrossOriginIframes:M,wrappedEmit:Bt});for(const e of k||[])e.getMirror&&e.getMirror({nodeMirror:Ht,crossOriginIframeMirror:$.crossOriginIframeMirror,crossOriginIframeStyleMirror:$.crossOriginIframeStyleMirror});const Y=new Ft;Vt=new Pt({recordCanvas:I,mutationCb:z,win:window,blockClass:s,blockSelector:o,mirror:Ht,sampling:b.canvas,dataURLOptions:E});const q=new yt({mutationCb:V,scrollCb:W,bypassOptions:{blockClass:s,blockSelector:o,maskTextClass:l,maskTextSelector:d,inlineStylesheet:h,maskInputOptions:P,dataURLOptions:E,maskTextFn:y,maskInputFn:g,recordCanvas:I,inlineImages:A,sampling:b,slimDOMOptions:U,iframeManager:$,stylesheetManager:G,canvasManager:Vt,keepIframeSrcFn:R,processedNodeManager:Y},mirror:Ht});jt=(e=!1)=>{if(!T)return;Bt({type:Pe.Meta,data:{href:window.location.href,width:me(),height:pe()}},e),G.reset(),q.init(),tt.forEach((e=>e.lock()));const t=function(e,t){const{mirror:r=new u,blockClass:n="rr-block",blockSelector:s=null,maskTextClass:o="rr-mask",maskTextSelector:i=null,inlineStylesheet:a=!0,inlineImages:l=!1,recordCanvas:c=!1,maskAllInputs:d=!1,maskTextFn:h,maskInputFn:p,slimDOM:m=!1,dataURLOptions:f,preserveWhiteSpace:g,onSerialize:y,onIframeLoad:v,iframeLoadTimeout:S,onStylesheetLoad:b,stylesheetLoadTimeout:E,keepIframeSrcFn:w=(()=>!1)}=t||{};return H(e,{doc:e,mirror:r,blockClass:n,blockSelector:s,maskTextClass:o,maskTextSelector:i,skipChild:!1,inlineStylesheet:a,maskInputOptions:!0===d?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===d?{password:!0}:d,maskTextFn:h,maskInputFn:p,slimDOMOptions:!0===m||"all"===m?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===m,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===m?{}:m,dataURLOptions:f,inlineImages:l,recordCanvas:c,preserveWhiteSpace:g,onSerialize:y,onIframeLoad:v,iframeLoadTimeout:S,onStylesheetLoad:b,stylesheetLoadTimeout:E,keepIframeSrcFn:w,newlyAddedElement:!1})}(document,{mirror:Ht,blockClass:s,blockSelector:o,maskTextClass:l,maskTextSelector:d,inlineStylesheet:h,maskAllInputs:P,maskTextFn:y,slimDOM:U,dataURLOptions:E,recordCanvas:I,inlineImages:A,onSerialize:e=>{Ie(e,Ht)&&$.addIframe(e),Me(e,Ht)&&G.trackLinkElement(e),Ce(e)&&q.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{$.attachIframe(e,t),q.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{G.attachLinkElement(e,t)},keepIframeSrcFn:R});if(!t)return console.warn("Failed to snapshot the document");Bt({type:Pe.FullSnapshot,data:{node:t,initialOffset:he(window)}},e),tt.forEach((e=>e.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&G.adoptStyleSheets(document.adoptedStyleSheets,Ht.getId(document))};try{const e=[],t=e=>{var t;return et(ht)({mutationCb:V,mousemoveCb:(e,t)=>Bt({type:Pe.IncrementalSnapshot,data:{source:t,positions:e}}),mouseInteractionCb:e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.MouseInteraction},e)}),scrollCb:W,viewportResizeCb:e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.ViewportResize},e)}),inputCb:e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.Input},e)}),mediaInteractionCb:e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.MediaInteraction},e)}),styleSheetRuleCb:e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.StyleSheetRule},e)}),styleDeclarationCb:e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.StyleDeclaration},e)}),canvasMutationCb:z,fontCb:e=>Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.Font},e)}),selectionCb:e=>{Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.Selection},e)})},customElementCb:e=>{Bt({type:Pe.IncrementalSnapshot,data:Object.assign({source:Ue.CustomElement},e)})},blockClass:s,ignoreClass:i,ignoreSelector:a,maskTextClass:l,maskInputClass:c,maskTextSelector:d,maskInputOptions:P,inlineStylesheet:h,sampling:b,recordDOM:T,recordCanvas:I,inlineImages:A,userTriggeredOnInput:C,collectFonts:O,doc:e,maskInputFn:g,maskTextFn:y,keepIframeSrcFn:R,blockSelector:o,slimDOMOptions:U,dataURLOptions:E,mirror:Ht,iframeManager:$,stylesheetManager:G,shadowDomManager:q,processedNodeManager:Y,canvasManager:Vt,ignoreCSSAttributes:D,plugins:(null===(t=null==k?void 0:k.filter((e=>e.observer)))||void 0===t?void 0:t.map((e=>({observer:e.observer,options:e.options,callback:t=>Bt({type:Pe.Plugin,data:{plugin:e.name,payload:t}})}))))||[]},v)};$.addLoadListener((r=>{try{e.push(t(r.contentDocument))}catch(e){console.warn(e)}}));const r=()=>{jt(),e.push(t(document)),Wt=!0};return"interactive"===document.readyState||"complete"===document.readyState?r():(e.push(oe("DOMContentLoaded",(()=>{Bt({type:Pe.DomContentLoaded,data:{}}),"DOMContentLoaded"===N&&r()}))),e.push(oe("load",(()=>{Bt({type:Pe.Load,data:{}}),"load"===N&&r()}),window))),()=>{e.forEach((e=>e())),Y.destroy(),Wt=!1,Ze(),rt(),$.cleanup()}}catch(e){console.warn(e)}}zt.addCustomEvent=(e,t)=>{if(!Wt)throw new Error("please add custom event after start recording");Bt({type:Pe.Custom,data:{tag:e,payload:t}})},zt.freezePage=()=>{tt.forEach((e=>e.freeze()))},zt.takeFullSnapshot=e=>{if(!Wt)throw new Error("please take full snapshot after start recording");jt(e)},zt.mirror=Ht;const{addCustomEvent:Gt}=zt,{freezePage:$t}=zt;var Yt=Uint8Array,qt=Uint16Array,Xt=Uint32Array,Kt=new Yt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Qt=new Yt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Jt=new Yt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Zt=function(e,t){for(var r=new qt(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var s=new Xt(r[30]);for(n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)s[o]=o-r[n]<<5|n;return[r,s]},er=Zt(Kt,2),tr=er[0],rr=er[1];tr[28]=258,rr[258]=28;for(var nr=Zt(Qt,0),sr=nr[0],or=nr[1],ir=new qt(32768),ar=0;ar<32768;++ar){var lr=(43690&ar)>>>1|(21845&ar)<<1;lr=(61680&(lr=(52428&lr)>>>2|(13107&lr)<<2))>>>4|(3855&lr)<<4,ir[ar]=((65280&lr)>>>8|(255&lr)<<8)>>>1}var cr=function(e,t,r){for(var n=e.length,s=0,o=new qt(t);s<n;++s)++o[e[s]-1];var i,a=new qt(t);for(s=0;s<t;++s)a[s]=a[s-1]+o[s-1]<<1;if(r){i=new qt(1<<t);var l=15-t;for(s=0;s<n;++s)if(e[s])for(var c=s<<4|e[s],d=t-e[s],u=a[e[s]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)i[ir[u]>>>l]=c}else for(i=new qt(n),s=0;s<n;++s)i[s]=ir[a[e[s]-1]++]>>>15-e[s];return i},dr=new Yt(288);for(ar=0;ar<144;++ar)dr[ar]=8;for(ar=144;ar<256;++ar)dr[ar]=9;for(ar=256;ar<280;++ar)dr[ar]=7;for(ar=280;ar<288;++ar)dr[ar]=8;var ur=new Yt(32);for(ar=0;ar<32;++ar)ur[ar]=5;var hr=cr(dr,9,0),pr=cr(dr,9,1),mr=cr(ur,5,0),fr=cr(ur,5,1),gr=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},yr=function(e,t,r){var n=t/8>>0;return(e[n]|e[n+1]<<8)>>>(7&t)&r},vr=function(e,t){var r=t/8>>0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>>(7&t)},Sr=function(e){return(e/8>>0)+(7&e&&1)},br=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(e instanceof qt?qt:e instanceof Xt?Xt:Yt)(r-t);return n.set(e.subarray(t,r)),n},Er=function(e,t,r){var n=e.length,s=!t||r,o=!r||r.i;r||(r={}),t||(t=new Yt(3*n));var i=function(e){var r=t.length;if(e>r){var n=new Yt(Math.max(2*r,e));n.set(t),t=n}},a=r.f||0,l=r.p||0,c=r.b||0,d=r.l,u=r.d,h=r.m,p=r.n,m=8*n;do{if(!d){r.f=a=yr(e,l,1);var f=yr(e,l+1,3);if(l+=3,!f){var g=e[(C=Sr(l)+4)-4]|e[C-3]<<8,y=C+g;if(y>n){if(o)throw"unexpected EOF";break}s&&i(c+g),t.set(e.subarray(C,y),c),r.b=c+=g,r.p=l=8*y;continue}if(1==f)d=pr,u=fr,h=9,p=5;else{if(2!=f)throw"invalid block type";var v=yr(e,l,31)+257,S=yr(e,l+10,15)+4,b=v+yr(e,l+5,31)+1;l+=14;for(var E=new Yt(b),w=new Yt(19),T=0;T<S;++T)w[Jt[T]]=yr(e,l+3*T,7);l+=3*S;var I=gr(w),M=(1<<I)-1;if(!o&&l+b*(I+7)>m)break;var N=cr(w,I,1);for(T=0;T<b;){var C,O=N[yr(e,l,M)];if(l+=15&O,(C=O>>>4)<16)E[T++]=C;else{var A=0,k=0;for(16==C?(k=3+yr(e,l,3),l+=2,A=E[T-1]):17==C?(k=3+yr(e,l,7),l+=3):18==C&&(k=11+yr(e,l,127),l+=7);k--;)E[T++]=A}}var R=E.subarray(0,v),D=E.subarray(v);h=gr(R),p=gr(D),d=cr(R,h,1),u=cr(D,p,1)}if(l>m)throw"unexpected EOF"}s&&i(c+131072);for(var _=(1<<h)-1,L=(1<<p)-1,x=h+p+18;o||l+x<m;){var P=(A=d[vr(e,l)&_])>>>4;if((l+=15&A)>m)throw"unexpected EOF";if(!A)throw"invalid length/literal";if(P<256)t[c++]=P;else{if(256==P){d=null;break}var U=P-254;if(P>264){var F=Kt[T=P-257];U=yr(e,l,(1<<F)-1)+tr[T],l+=F}var B=u[vr(e,l)&L],j=B>>>4;if(!B)throw"invalid distance";l+=15&B;D=sr[j];if(j>3){F=Qt[j];D+=vr(e,l)&(1<<F)-1,l+=F}if(l>m)throw"unexpected EOF";s&&i(c+131072);for(var V=c+U;c<V;c+=4)t[c]=t[c-D],t[c+1]=t[c+1-D],t[c+2]=t[c+2-D],t[c+3]=t[c+3-D];c=V}}r.l=d,r.p=l,r.b=c,d&&(a=1,r.m=h,r.d=u,r.n=p)}while(!a);return c==t.length?t:br(t,0,c)},wr=function(e,t,r){r<<=7&t;var n=t/8>>0;e[n]|=r,e[n+1]|=r>>>8},Tr=function(e,t,r){r<<=7&t;var n=t/8>>0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},Ir=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,o=r.slice();if(!s)return[new Yt(0),0];if(1==s){var i=new Yt(r[0].s+1);return i[r[0].s]=1,[i,1]}r.sort((function(e,t){return e.f-t.f})),r.push({s:-1,f:25001});var a=r[0],l=r[1],c=0,d=1,u=2;for(r[0]={s:-1,f:a.f+l.f,l:a,r:l};d!=s-1;)a=r[r[c].f<r[u].f?c++:u++],l=r[c!=d&&r[c].f<r[u].f?c++:u++],r[d++]={s:-1,f:a.f+l.f,l:a,r:l};var h=o[0].s;for(n=1;n<s;++n)o[n].s>h&&(h=o[n].s);var p=new qt(h+1),m=Mr(r[d-1],p,0);if(m>t){n=0;var f=0,g=m-t,y=1<<g;for(o.sort((function(e,t){return p[t.s]-p[e.s]||e.f-t.f}));n<s;++n){var v=o[n].s;if(!(p[v]>t))break;f+=y-(1<<m-p[v]),p[v]=t}for(f>>>=g;f>0;){var S=o[n].s;p[S]<t?f-=1<<t-p[S]++-1:++n}for(;n>=0&&f;--n){var b=o[n].s;p[b]==t&&(--p[b],++f)}m=t}return[new Yt(p),m]},Mr=function(e,t,r){return-1==e.s?Math.max(Mr(e.l,t,r+1),Mr(e.r,t,r+1)):t[e.s]=r},Nr=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new qt(++t),n=0,s=e[0],o=1,i=function(e){r[n++]=e},a=1;a<=t;++a)if(e[a]==s&&a!=t)++o;else{if(!s&&o>2){for(;o>138;o-=138)i(32754);o>2&&(i(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(i(s),--o;o>6;o-=6)i(8304);o>2&&(i(o-3<<5|8208),o=0)}for(;o--;)i(s);o=1,s=e[a]}return[r.subarray(0,n),t]},Cr=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},Or=function(e,t,r){var n=r.length,s=Sr(t+2);e[s]=255&n,e[s+1]=n>>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var o=0;o<n;++o)e[s+o+4]=r[o];return 8*(s+4+n)},Ar=function(e,t,r,n,s,o,i,a,l,c,d){wr(t,d++,r),++s[256];for(var u=Ir(s,15),h=u[0],p=u[1],m=Ir(o,15),f=m[0],g=m[1],y=Nr(h),v=y[0],S=y[1],b=Nr(f),E=b[0],w=b[1],T=new qt(19),I=0;I<v.length;++I)T[31&v[I]]++;for(I=0;I<E.length;++I)T[31&E[I]]++;for(var M=Ir(T,7),N=M[0],C=M[1],O=19;O>4&&!N[Jt[O-1]];--O);var A,k,R,D,_=c+5<<3,L=Cr(s,dr)+Cr(o,ur)+i,x=Cr(s,h)+Cr(o,f)+i+14+3*O+Cr(T,N)+(2*T[16]+3*T[17]+7*T[18]);if(_<=L&&_<=x)return Or(t,d,e.subarray(l,l+c));if(wr(t,d,1+(x<L)),d+=2,x<L){A=cr(h,p,0),k=h,R=cr(f,g,0),D=f;var P=cr(N,C,0);wr(t,d,S-257),wr(t,d+5,w-1),wr(t,d+10,O-4),d+=14;for(I=0;I<O;++I)wr(t,d+3*I,N[Jt[I]]);d+=3*O;for(var U=[v,E],F=0;F<2;++F){var B=U[F];for(I=0;I<B.length;++I){var j=31&B[I];wr(t,d,P[j]),d+=N[j],j>15&&(wr(t,d,B[I]>>>5&127),d+=B[I]>>>12)}}}else A=hr,k=dr,R=mr,D=ur;for(I=0;I<a;++I)if(n[I]>255){j=n[I]>>>18&31;Tr(t,d,A[j+257]),d+=k[j+257],j>7&&(wr(t,d,n[I]>>>23&31),d+=Kt[j]);var V=31&n[I];Tr(t,d,R[V]),d+=D[V],V>3&&(Tr(t,d,n[I]>>>5&8191),d+=Qt[V])}else Tr(t,d,A[n[I]]),d+=k[n[I]];return Tr(t,d,A[256]),d+k[256]},kr=new Xt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Rr=new Yt(0),Dr=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,o=r.length,i=0;i!=o;){for(var a=Math.min(i+5552,o);i<a;++i)s+=n+=r[i];n%=65521,s%=65521}e=n,t=s},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+2*((255&e)<<23)}}},_r=function(e,t,r,n,s){return function(e,t,r,n,s,o){var i=e.length,a=new Yt(n+i+5*(1+Math.floor(i/7e3))+s),l=a.subarray(n,a.length-s),c=0;if(!t||i<8)for(var d=0;d<=i;d+=65535){var u=d+65535;u<i?c=Or(l,c,e.subarray(d,u)):(l[d]=o,c=Or(l,c,e.subarray(d,i)))}else{for(var h=kr[t-1],p=h>>>13,m=8191&h,f=(1<<r)-1,g=new qt(32768),y=new qt(f+1),v=Math.ceil(r/3),S=2*v,b=function(t){return(e[t]^e[t+1]<<v^e[t+2]<<S)&f},E=new Xt(25e3),w=new qt(288),T=new qt(32),I=0,M=0,N=(d=0,0),C=0,O=0;d<i;++d){var A=b(d),k=32767&d,R=y[A];if(g[k]=R,y[A]=k,C<=d){var D=i-d;if((I>7e3||N>24576)&&D>423){c=Ar(e,l,0,E,w,T,M,N,O,d-O,c),N=I=M=0,O=d;for(var _=0;_<286;++_)w[_]=0;for(_=0;_<30;++_)T[_]=0}var L=2,x=0,P=m,U=k-R&32767;if(D>2&&A==b(d-U))for(var F=Math.min(p,D)-1,B=Math.min(32767,d),j=Math.min(258,D);U<=B&&--P&&k!=R;){if(e[d+L]==e[d+L-U]){for(var V=0;V<j&&e[d+V]==e[d+V-U];++V);if(V>L){if(L=V,x=U,V>F)break;var W=Math.min(U,V-2),H=0;for(_=0;_<W;++_){var z=d-U+_+32768&32767,G=z-g[z]+32768&32767;G>H&&(H=G,R=z)}}}U+=(k=R)-(R=g[k])+32768&32767}if(x){E[N++]=268435456|rr[L]<<18|or[x];var $=31&rr[L],Y=31&or[x];M+=Kt[$]+Qt[Y],++w[257+$],++T[Y],C=d+L,++I}else E[N++]=e[d],++w[e[d]]}}c=Ar(e,l,o,E,w,T,M,N,O,d-O,c),o||(c=Or(l,c,Rr))}return br(a,0,n+Sr(c)+s)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,r,n,!s)},Lr=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},xr=function(e,t){var r=t.level,n=0==r?0:r<6?1:9==r?3:2;e[0]=120,e[1]=n<<6|(n?32-2*n:1)},Pr=function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function Ur(e,t){var r=e.length;if(!t&&"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var n=new Yt(e.length+(e.length>>>1)),s=0,o=function(e){n[s++]=e},i=0;i<r;++i){if(s+5>n.length){var a=new Yt(s+8+(r-i<<1));a.set(n),n=a}var l=e.charCodeAt(i);l<128||t?o(l):l<2048?(o(192|l>>>6),o(128|63&l)):l>55295&&l<57344?(o(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++i))>>>18),o(128|l>>>12&63),o(128|l>>>6&63),o(128|63&l)):(o(224|l>>>12),o(128|l>>>6&63),o(128|63&l))}return br(n,0,s)}function Fr(e,t){var r="";if(!t&&"undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var n=0;n<e.length;){var s=e[n++];s<128||t?r+=String.fromCharCode(s):s<224?r+=String.fromCharCode((31&s)<<6|63&e[n++]):s<240?r+=String.fromCharCode((15&s)<<12|(63&e[n++])<<6|63&e[n++]):(s=((15&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,r+=String.fromCharCode(55296|s>>10,56320|1023&s))}return r}const Br="v1",jr=e=>{const t=Object.assign(Object.assign({},e),{v:Br});return Fr(function(e,t){void 0===t&&(t={});var r=Dr();r.p(e);var n=_r(e,t,2,4);return xr(n,t),Lr(n,n.length-4,r.d()),n}(Ur(JSON.stringify(t))),!0)},Vr=e=>{if("string"!=typeof e)return e;try{const t=JSON.parse(e);if(t.timestamp)return t}catch(e){}try{const n=JSON.parse(Fr((t=Ur(e,!0),Er((Pr(t),t.subarray(2,-4)),r))));if(n.v===Br)return n;throw new Error(`These events were packed with packer ${n.v} which is incompatible with current packer ${Br}.`)}catch(e){throw console.error(e),new Error("Unknown data format.")}var t,r};class Wr{constructor(e){this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}toString(){const e=this.lineNumber||"",t=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${e}:${t})`:`${this.fileName}:${e}:${t}`}}const Hr=/(^|@)\S+:\d+/,zr=/^\s*at .*(\S+:\d+|\(native\))/m,Gr=/^(eval@)?(\[native code])?$/,$r={parse:function(e){return e?void 0!==e.stacktrace||void 0!==e["opera#sourceloc"]?this.parseOpera(e):e.stack&&e.stack.match(zr)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):(console.warn("[console-record-plugin]: Failed to parse error object:",e),[]):[]},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];const t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!t)throw new Error(`Cannot parse given url: ${e}`);return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(zr)}),this).map((function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(");const r=t.match(/ (\((.+):(\d+):(\d+)\)$)/);t=r?t.replace(r[0],""):t;const n=t.split(/\s+/).slice(1),s=this.extractLocation(r?r[1]:n.pop()),o=n.join(" ")||void 0,i=["eval","<anonymous>"].indexOf(s[0])>-1?void 0:s[0];return new Wr({functionName:o,fileName:i,lineNumber:s[1],columnNumber:s[2]})}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(e){return!e.match(Gr)}),this).map((function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new Wr({functionName:e});{const t=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=e.match(t),n=r&&r[1]?r[1]:void 0,s=this.extractLocation(e.replace(t,""));return new Wr({functionName:n,fileName:s[0],lineNumber:s[1],columnNumber:s[2]})}}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){const t=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),n=[];for(let e=2,s=r.length;e<s;e+=2){const s=t.exec(r[e]);s&&n.push(new Wr({fileName:s[2],lineNumber:parseFloat(s[1])}))}return n},parseOpera10:function(e){const t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),n=[];for(let e=0,s=r.length;e<s;e+=2){const s=t.exec(r[e]);s&&n.push(new Wr({functionName:s[3]||void 0,fileName:s[2],lineNumber:parseFloat(s[1])}))}return n},parseOpera11:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(Hr)&&!e.match(/^Error created at/)}),this).map((function(e){const t=e.split("@"),r=this.extractLocation(t.pop()),n=(t.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new Wr({functionName:n,fileName:r[0],lineNumber:r[1],columnNumber:r[2]})}),this)}};function Yr(e){if(!e||!e.outerHTML)return"";let t="";for(;e.parentElement;){let r=e.localName;if(!r)break;r=r.toLowerCase();const n=e.parentElement,s=[];if(n.children&&n.children.length>0)for(let e=0;e<n.children.length;e++){const t=n.children[e];t.localName&&t.localName.toLowerCase&&t.localName.toLowerCase()===r&&s.push(t)}s.length>1&&(r+=`:eq(${s.indexOf(e)})`),t=r+(t?">"+t:""),e=n}return t}function qr(e){return"[object Object]"===Object.prototype.toString.call(e)}function Xr(e,t){if(0===t)return!0;const r=Object.keys(e);for(const n of r)if(qr(e[n])&&Xr(e[n],t-1))return!0;return!1}function Kr(e,t){const r={numOfKeysLimit:50,depthOfLimit:4};Object.assign(r,t);const n=[],s=[];return JSON.stringify(e,(function(e,t){if(n.length>0){const r=n.indexOf(this);~r?n.splice(r+1):n.push(this),~r?s.splice(r,1/0,e):s.push(e),~n.indexOf(t)&&(t=n[0]===t?"[Circular ~]":"[Circular ~."+s.slice(0,n.indexOf(t)).join(".")+"]")}else n.push(t);if(null===t)return t;if(void 0===t)return"undefined";if(function(e){if(qr(e)&&Object.keys(e).length>r.numOfKeysLimit)return!0;if("function"==typeof e)return!0;if(qr(e)&&Xr(e,r.depthOfLimit))return!0;return!1}(t))return function(e){let t=e.toString();r.stringLengthLimit&&t.length>r.stringLengthLimit&&(t=`${t.slice(0,r.stringLengthLimit)}...`);return t}(t);if("bigint"==typeof t)return t.toString()+"n";if(t instanceof Event){const e={};for(const r in t){const n=t[r];Array.isArray(n)?e[r]=Yr(n.length?n[0]:null):e[r]=n}return e}return t instanceof Node?t instanceof HTMLElement?t?t.outerHTML:"":t.nodeName:t instanceof Error?t.stack?t.stack+"\nEnd of stack for Error object":t.name+": "+t.message:t}))}const Qr={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function Jr(e,t,r){const n=r?Object.assign({},Qr,r):Qr,s=n.logger;if(!s)return()=>{};let o;o="string"==typeof s?t[s]:s;let i=0,a=!1;const l=[];if(n.level.includes("error")){const r=t=>{const r=t.message,s=t.error,o=$r.parse(s).map((e=>e.toString())),i=[Kr(r,n.stringifyOptions)];e({level:"error",trace:o,payload:i})};t.addEventListener("error",r),l.push((()=>{t.removeEventListener("error",r)}));const s=t=>{let r,s;t.reason instanceof Error?(r=t.reason,s=[Kr(`Uncaught (in promise) ${r.name}: ${r.message}`,n.stringifyOptions)]):(r=new Error,s=[Kr("Uncaught (in promise)",n.stringifyOptions),Kr(t.reason,n.stringifyOptions)]);const o=$r.parse(r).map((e=>e.toString()));e({level:"error",trace:o,payload:s})};t.addEventListener("unhandledrejection",s),l.push((()=>{t.removeEventListener("unhandledrejection",s)}))}for(const e of n.level)l.push(c(o,e));return()=>{l.forEach((e=>e()))};function c(t,r){return t[r]?de(t,r,(t=>(...s)=>{if(t.apply(this,s),!a){a=!0;try{const t=$r.parse(new Error).map((e=>e.toString())).splice(1),o=s.map((e=>Kr(e,n.stringifyOptions)));i++,i<n.lengthThreshold?e({level:r,trace:t,payload:o}):i===n.lengthThreshold&&e({level:"warn",trace:[],payload:[Kr("The number of log records reached the threshold.")]})}catch(e){t("rrweb logger error:",e,...s)}finally{a=!1}}})):()=>{}}}const Zr="rrweb/console@1",en=e=>({name:Zr,observer:Jr,options:e}),tn="__rrweb_original__",rn={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],replayLogger:void 0};class nn{constructor(e){this.config=Object.assign(rn,e)}getConsoleLogger(){const e={};for(const t of this.config.level)e[t]="trace"===t?e=>{(console.log[tn]?console.log[tn]:console.log)(...e.payload.map((e=>JSON.parse(e))),this.formatMessage(e))}:e=>{(console[t][tn]?console[t][tn]:console[t])(...e.payload.map((e=>JSON.parse(e))),this.formatMessage(e))};return e}formatMessage(e){if(0===e.trace.length)return"";const t="\n\tat ";let r=t;return r+=e.trace.join(t),r}}const sn=e=>{const t=(null==e?void 0:e.replayLogger)||new nn(e).getConsoleLogger();return{handler(e,r,n){let s=null;if(e.type===Pe.IncrementalSnapshot&&e.data.source===Ue.Log?s=e.data:e.type===Pe.Plugin&&e.data.plugin===Zr&&(s=e.data.payload),s)try{"function"==typeof t[s.level]&&t[s.level](s)}catch(e){n.replayer.config.showWarning&&console.warn(e)}}}},on=new Map;function an(e,t){let r=on.get(e);return r||(r=new Map,on.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}function ln(e,t,r){return n=>vt(this,void 0,void 0,(function*(){if(n&&"object"==typeof n&&"rr_type"in n){if(r&&(r.isUnchanged=!1),"ImageBitmap"===n.rr_type&&"args"in n){const s=yield ln(e,t,r)(n.args);return yield createImageBitmap.apply(null,s)}if("index"in n){if(r||null===t)return n;const{rr_type:e,index:s}=n;return an(t,e)[s]}if("args"in n){const{rr_type:s,args:o}=n;return new(0,window[s])(...yield Promise.all(o.map(ln(e,t,r))))}if("base64"in n)return Tt(n.base64);if("src"in n){const t=e.get(n.src);if(t)return t;{const t=new Image;return t.src=n.src,e.set(n.src,t),t}}if("data"in n&&"Blob"===n.rr_type){const s=yield Promise.all(n.data.map(ln(e,t,r)));return new Blob(s,{type:n.type})}}else if(Array.isArray(n)){return yield Promise.all(n.map(ln(e,t,r)))}return n}))}const cn=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function dn({mutation:e,target:t,type:r,imageMap:n,errorHandler:s}){return vt(this,void 0,void 0,(function*(){try{const s=function(e,t){try{return t===je.WebGL?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}catch(e){return null}}(t,r);if(!s)return;if(e.setter)return void(s[e.property]=e.args[0]);const o=s[e.property],i=yield Promise.all(e.args.map(ln(n,s)));!function(e,t){if(!(null==t?void 0:t.constructor))return;const{name:r}=t.constructor;if(!cn.includes(r))return;const n=an(e,r);n.includes(t)||n.push(t)}(s,o.apply(s,i))}catch(t){s(e,t)}}))}function un({event:e,mutation:t,target:r,imageMap:n,canvasEventMap:s,errorHandler:o}){return vt(this,void 0,void 0,(function*(){try{const i=s.get(e)||t,a="commands"in i?i.commands:[i];if([je.WebGL,je.WebGL2].includes(t.type)){for(let e=0;e<a.length;e++){const s=a[e];yield dn({mutation:s,type:t.type,target:r,imageMap:n,errorHandler:o})}return}yield function({event:e,mutations:t,target:r,imageMap:n,errorHandler:s}){return vt(this,void 0,void 0,(function*(){const o=r.getContext("2d");if(!o)return void s(t[0],new Error("Canvas context is null"));const i=t.map((e=>vt(this,void 0,void 0,(function*(){return Promise.all(e.args.map(ln(n,o)))}))));(yield Promise.all(i)).forEach(((r,i)=>{const a=t[i];try{if(a.setter)return void(o[a.property]=a.args[0]);const t=o[a.property];"drawImage"===a.property&&"string"==typeof a.args[0]?(n.get(e),t.apply(o,a.args)):t.apply(o,r)}catch(e){s(a,e)}}))}))}({event:e,mutations:a,target:r,imageMap:n,errorHandler:o})}catch(e){o(t,e)}}))}var hn;!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(hn||(hn={}));class pn{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return-1;const r=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=r?r:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e,t){const r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e,t))),null==t||t(e)}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)}replace(e,t){const r=this.getNode(e);if(r){const e=this.nodeMetaMap.get(r);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function mn(e){const t=[];for(const r in e){const n=e[r];if("string"!=typeof n)continue;const s=Sn(r);t.push(`${s}: ${n};`)}return t.join(" ")}const fn=/-([a-z])/g,gn=/^--[a-zA-Z0-9-]+$/,yn=e=>gn.test(e)?e:e.replace(fn,((e,t)=>t?t.toUpperCase():"")),vn=/\B([A-Z])/g,Sn=e=>e.replace(vn,"-$1").toLowerCase();class bn{constructor(...e){this.parentElement=null,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.ELEMENT_NODE=kn.ELEMENT_NODE,this.TEXT_NODE=kn.TEXT_NODE}get childNodes(){const e=[];let t=this.firstChild;for(;t;)e.push(t),t=t.nextSibling;return e}contains(e){if(!(e instanceof bn))return!1;if(e.ownerDocument!==this.ownerDocument)return!1;if(e===this)return!0;for(;e.parentNode;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,t){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function En(e){return class extends e{constructor(e,t,r){super(),this.nodeType=kn.DOCUMENT_TYPE_NODE,this.RRNodeType=hn.DocumentType,this.name=e,this.publicId=t,this.systemId=r,this.nodeName=e,this.textContent=null}toString(){return"RRDocumentType"}}}function wn(e){return class extends e{constructor(e){super(),this.nodeType=kn.ELEMENT_NODE,this.RRNodeType=hn.Element,this.attributes={},this.shadowRoot=null,this.tagName=e.toUpperCase(),this.nodeName=e.toUpperCase()}get textContent(){let e="";return this.childNodes.forEach((t=>e+=t.textContent)),e}set textContent(e){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(e))}get classList(){return new Nn(this.attributes.class,(e=>{this.attributes.class=e}))}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const e=this.attributes.style?function(e){const t={},r=/:(.+)/;return e.replace(/\/\*.*?\*\//g,"").split(/;(?![^(]*\))/g).forEach((function(e){if(e){const n=e.split(r);n.length>1&&(t[yn(n[0].trim())]=n[1].trim())}})),t}(this.attributes.style):{},t=/\B([A-Z])/g;return e.setProperty=(r,n,s)=>{if(t.test(r))return;const o=yn(r);n?e[o]=n:delete e[o],"important"===s&&(e[o]+=" !important"),this.attributes.style=mn(e)},e.removeProperty=r=>{if(t.test(r))return"";const n=yn(r),s=e[n]||"";return delete e[n],this.attributes.style=mn(e),s},e}getAttribute(e){return this.attributes[e]||null}setAttribute(e,t){this.attributes[e]=t}setAttributeNS(e,t,r){this.setAttribute(t,r)}removeAttribute(e){delete this.attributes[e]}appendChild(e){return Cn(this,e)}insertBefore(e,t){return On(this,e,t)}removeChild(e){return An(this,e)}attachShadow(e){const t=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=t,t}dispatchEvent(e){return!0}toString(){let e="";for(const t in this.attributes)e+=`${t}="${this.attributes[t]}" `;return`${this.tagName} ${e}`}}}function Tn(e){return class extends e{constructor(e){super(),this.nodeType=kn.TEXT_NODE,this.nodeName="#text",this.RRNodeType=hn.Text,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function In(e){return class extends e{constructor(e){super(),this.nodeType=kn.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=hn.Comment,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function Mn(e){return class extends e{constructor(e){super(),this.nodeName="#cdata-section",this.nodeType=kn.CDATA_SECTION_NODE,this.RRNodeType=hn.CDATA,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class Nn{constructor(e,t){if(this.classes=[],this.add=(...e)=>{for(const t of e){const e=String(t);this.classes.indexOf(e)>=0||this.classes.push(e)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...e)=>{this.classes=this.classes.filter((t=>-1===e.indexOf(t))),this.onChange&&this.onChange(this.classes.join(" "))},e){const t=e.trim().split(/\s+/);this.classes.push(...t)}this.onChange=t}}function Cn(e,t){return t.parentNode&&t.parentNode.removeChild(t),e.lastChild?(e.lastChild.nextSibling=t,t.previousSibling=e.lastChild):(e.firstChild=t,t.previousSibling=null),e.lastChild=t,t.nextSibling=null,t.parentNode=e,t.parentElement=e,t.ownerDocument=e.ownerDocument,t}function On(e,t,r){if(!r)return Cn(e,t);if(r.parentNode!==e)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return t===r||(t.parentNode&&t.parentNode.removeChild(t),t.previousSibling=r.previousSibling,r.previousSibling=t,t.nextSibling=r,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,t.parentElement=e,t.parentNode=e,t.ownerDocument=e.ownerDocument),t}function An(e,t){if(t.parentNode!==e)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return t.previousSibling?t.previousSibling.nextSibling=t.nextSibling:e.firstChild=t.nextSibling,t.nextSibling?t.nextSibling.previousSibling=t.previousSibling:e.lastChild=t.previousSibling,t.previousSibling=null,t.nextSibling=null,t.parentElement=null,t.parentNode=null,t}var kn;!function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"}(kn||(kn={}));const Rn={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},Dn={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};let _n=null;function Ln(e,t,r,n=t.mirror||t.ownerDocument.mirror){e=function(e,t,r,n){var s;r.afterAppend&&!_n&&(_n=new WeakSet,setTimeout((()=>{_n=null}),0));if(!Un(e,t)){const o=Pn(t,r.mirror,n);null===(s=e.parentNode)||void 0===s||s.replaceChild(o,e),e=o}switch(t.RRNodeType){case hn.Document:if(!Fn(e,t,r.mirror,n)){const s=n.getMeta(t);s&&(r.mirror.removeNodeFromMap(e),e.close(),e.open(),r.mirror.add(e,s),null==_n||_n.add(e))}break;case hn.Element:{const s=e,o=t;switch(o.tagName){case"IFRAME":{const s=e.contentDocument;if(!s)break;Ln(s,t.contentDocument,r,n);break}}o.shadowRoot&&(s.shadowRoot||s.attachShadow({mode:"open"}),xn(s.shadowRoot,o.shadowRoot,r,n)),function(e,t,r){const n=e.attributes,s=t.attributes;for(const n in s){const o=s[n],i=r.getMeta(t);if((null==i?void 0:i.isSVG)&&Rn[n])e.setAttributeNS(Rn[n],n,o);else if("CANVAS"===t.tagName&&"rr_dataURL"===n){const t=document.createElement("img");t.src=o,t.onload=()=>{const r=e.getContext("2d");r&&r.drawImage(t,0,0,t.width,t.height)}}else{if("IFRAME"===t.tagName&&"srcdoc"===n)continue;e.setAttribute(n,o)}}for(const{name:t}of Array.from(n))t in s||e.removeAttribute(t);t.scrollLeft&&(e.scrollLeft=t.scrollLeft),t.scrollTop&&(e.scrollTop=t.scrollTop)}(s,o,n);break}}return e}(e,t,r,n),xn(e,t,r,n),function(e,t,r){var n;switch(t.RRNodeType){case hn.Document:{const e=t.scrollData;e&&r.applyScroll(e,!0);break}case hn.Element:{const n=e,s=t;switch(s.scrollData&&r.applyScroll(s.scrollData,!0),s.inputData&&r.applyInput(s.inputData),s.tagName){case"AUDIO":case"VIDEO":{const t=e,r=s;void 0!==r.paused&&(r.paused?t.pause():t.play()),void 0!==r.muted&&(t.muted=r.muted),void 0!==r.volume&&(t.volume=r.volume),void 0!==r.currentTime&&(t.currentTime=r.currentTime),void 0!==r.playbackRate&&(t.playbackRate=r.playbackRate),void 0!==r.loop&&(t.loop=r.loop);break}case"CANVAS":{const s=t;if(null!==s.rr_dataURL){const e=document.createElement("img");e.onload=()=>{const t=n.getContext("2d");t&&t.drawImage(e,0,0,e.width,e.height)},e.src=s.rr_dataURL}s.canvasMutations.forEach((t=>r.applyCanvas(t.event,t.mutation,e)));break}case"STYLE":{const e=n.sheet;e&&t.rules.forEach((t=>r.applyStyleSheetMutation(t,e)));break}}break}case hn.Text:case hn.Comment:case hn.CDATA:e.textContent!==t.data&&(e.textContent=t.data)}(null==_n?void 0:_n.has(e))&&(_n.delete(e),null===(n=r.afterAppend)||void 0===n||n.call(r,e,r.mirror.getId(e)))}(e,t,r)}function xn(e,t,r,n){const s=Array.from(e.childNodes),o=t.childNodes;if(0===s.length&&0===o.length)return;let i,a,l=0,c=s.length-1,d=0,u=o.length-1,h=s[l],p=s[c],m=o[d],f=o[u];for(;l<=c&&d<=u;)if(void 0===h)h=s[++l];else if(void 0===p)p=s[--c];else if(Fn(h,m,r.mirror,n))h=s[++l],m=o[++d];else if(Fn(p,f,r.mirror,n))p=s[--c],f=o[--u];else if(Fn(h,f,r.mirror,n)){try{e.insertBefore(h,p.nextSibling)}catch(e){console.warn(e)}h=s[++l],f=o[--u]}else if(Fn(p,m,r.mirror,n)){try{e.insertBefore(p,h)}catch(e){console.warn(e)}p=s[--c],m=o[++d]}else{if(!i){i={};for(let e=l;e<=c;e++){const t=s[e];t&&r.mirror.hasNode(t)&&(i[r.mirror.getId(t)]=e)}}a=i[n.getId(m)];const t=s[a];if(void 0!==a&&t&&Fn(t,m,r.mirror,n)){try{e.insertBefore(t,h)}catch(e){console.warn(e)}s[a]=void 0}else{const t=Pn(m,r.mirror,n);"#document"===e.nodeName&&h&&(t.nodeType===t.DOCUMENT_TYPE_NODE&&h.nodeType===h.DOCUMENT_TYPE_NODE||t.nodeType===t.ELEMENT_NODE&&h.nodeType===h.ELEMENT_NODE)&&(e.removeChild(h),r.mirror.removeNodeFromMap(h),h=s[++l]);try{e.insertBefore(t,h||null)}catch(e){console.warn(e)}}m=o[++d]}if(l>c){const t=o[u+1];let s=null;for(t&&(s=r.mirror.getNode(n.getId(t)));d<=u;++d){const t=Pn(o[d],r.mirror,n);try{e.insertBefore(t,s)}catch(e){console.warn(e)}}}else if(d>u)for(;l<=c;l++){const t=s[l];if(t&&t.parentNode===e)try{e.removeChild(t),r.mirror.removeNodeFromMap(t)}catch(e){console.warn(e)}}let g=e.firstChild,y=t.firstChild;for(;null!==g&&null!==y;)Ln(g,y,r,n),g=g.nextSibling,y=y.nextSibling}function Pn(e,t,r){const n=r.getId(e),s=r.getMeta(e);let o=null;if(n>-1&&(o=t.getNode(n)),null!==o&&Un(o,e))return o;switch(e.RRNodeType){case hn.Document:o=new Document;break;case hn.DocumentType:o=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case hn.Element:{let t=e.tagName.toLowerCase();t=Dn[t]||t,o=s&&"isSVG"in s&&(null==s?void 0:s.isSVG)?document.createElementNS(Rn.svg,t):document.createElement(e.tagName);break}case hn.Text:o=document.createTextNode(e.data);break;case hn.Comment:o=document.createComment(e.data);break;case hn.CDATA:o=document.createCDATASection(e.data)}s&&t.add(o,Object.assign({},s));try{null==_n||_n.add(o)}catch(e){}return o}function Un(e,t){return e.nodeType===t.nodeType&&(e.nodeType!==e.ELEMENT_NODE||e.tagName.toUpperCase()===t.tagName)}function Fn(e,t,r,n){const s=r.getId(e),o=n.getId(t);return-1!==s&&s===o&&Un(e,t)}class Bn extends(function(e){return class t extends e{constructor(...e){super(e),this.nodeType=kn.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=hn.Document,this.textContent=null,this.ownerDocument=this}get documentElement(){return this.childNodes.find((e=>e.RRNodeType===hn.Element&&"HTML"===e.tagName))||null}get body(){var e;return(null===(e=this.documentElement)||void 0===e?void 0:e.childNodes.find((e=>e.RRNodeType===hn.Element&&"BODY"===e.tagName)))||null}get head(){var e;return(null===(e=this.documentElement)||void 0===e?void 0:e.childNodes.find((e=>e.RRNodeType===hn.Element&&"HEAD"===e.tagName)))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(e){const t=e.RRNodeType;if((t===hn.Element||t===hn.DocumentType)&&this.childNodes.some((e=>e.RRNodeType===t)))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${t===hn.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const r=Cn(this,e);return r.parentElement=null,r}insertBefore(e,t){const r=e.RRNodeType;if((r===hn.Element||r===hn.DocumentType)&&this.childNodes.some((e=>e.RRNodeType===r)))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${r===hn.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const n=On(this,e,t);return n.parentElement=null,n}removeChild(e){return An(this,e)}open(){this.firstChild=null,this.lastChild=null}close(){}write(e){let t;if('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'===e?t="-//W3C//DTD XHTML 1.0 Transitional//EN":'<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'===e&&(t="-//W3C//DTD HTML 4.0 Transitional//EN"),t){const e=this.createDocumentType("html",t,"");this.open(),this.appendChild(e)}}createDocument(e,r,n){return new t}createDocumentType(e,t,r){const n=new(En(bn))(e,t,r);return n.ownerDocument=this,n}createElement(e){const t=new(wn(bn))(e);return t.ownerDocument=this,t}createElementNS(e,t){return this.createElement(t)}createTextNode(e){const t=new(Tn(bn))(e);return t.ownerDocument=this,t}createComment(e){const t=new(In(bn))(e);return t.ownerDocument=this,t}createCDATASection(e){const t=new(Mn(bn))(e);return t.ownerDocument=this,t}toString(){return"RRDocument"}}}(bn)){get unserializedId(){return this._unserializedId--}constructor(e){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=new Qn,this.scrollData=null,e&&(this.mirror=e)}createDocument(e,t,r){return new Bn}createDocumentType(e,t,r){const n=new jn(e,t,r);return n.ownerDocument=this,n}createElement(e){const t=e.toUpperCase();let r;switch(t){case"AUDIO":case"VIDEO":r=new Wn(t);break;case"IFRAME":r=new Gn(t,this.mirror);break;case"CANVAS":r=new Hn(t);break;case"STYLE":r=new zn(t);break;default:r=new Vn(t)}return r.ownerDocument=this,r}createComment(e){const t=new Yn(e);return t.ownerDocument=this,t}createCDATASection(e){const t=new qn(e);return t.ownerDocument=this,t}createTextNode(e){const t=new $n(e);return t.ownerDocument=this,t}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const jn=En(bn);class Vn extends(wn(bn)){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class Wn extends(function(e){return class extends e{attachShadow(e){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}(Vn)){}class Hn extends Vn{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class zn extends Vn{constructor(){super(...arguments),this.rules=[]}}class Gn extends Vn{constructor(e,t){super(e),this.contentDocument=new Bn,this.contentDocument.mirror=t}}const $n=Tn(bn),Yn=In(bn),qn=Mn(bn);function Xn(e,t,r,n){let s;switch(e.nodeType){case kn.DOCUMENT_NODE:n&&"IFRAME"===n.nodeName?s=n.contentDocument:(s=t,s.compatMode=e.compatMode);break;case kn.DOCUMENT_TYPE_NODE:{const r=e;s=t.createDocumentType(r.name,r.publicId,r.systemId);break}case kn.ELEMENT_NODE:{const r=e,n=(o=r)instanceof HTMLFormElement?"FORM":o.tagName.toUpperCase();s=t.createElement(n);const i=s;for(const{name:e,value:t}of Array.from(r.attributes))i.attributes[e]=t;r.scrollLeft&&(i.scrollLeft=r.scrollLeft),r.scrollTop&&(i.scrollTop=r.scrollTop);break}case kn.TEXT_NODE:s=t.createTextNode(e.textContent||"");break;case kn.CDATA_SECTION_NODE:s=t.createCDATASection(e.data);break;case kn.COMMENT_NODE:s=t.createComment(e.textContent||"");break;case kn.DOCUMENT_FRAGMENT_NODE:s=n.attachShadow({mode:"open"});break;default:return null}var o;let i=r.getMeta(e);return t instanceof Bn&&(i||(i=Jn(s,t.unserializedId),r.add(e,i)),t.mirror.add(s,Object.assign({},i))),s}function Kn(e,t=function(){return new pn}(),r=new Bn){return function e(n,s){const o=Xn(n,r,t,s);if(null!==o)if("IFRAME"!==(null==s?void 0:s.nodeName)&&n.nodeType!==kn.DOCUMENT_FRAGMENT_NODE&&(null==s||s.appendChild(o),o.parentNode=s,o.parentElement=s),"IFRAME"===n.nodeName){const t=n.contentDocument;t&&e(t,o)}else n.nodeType!==kn.DOCUMENT_NODE&&n.nodeType!==kn.ELEMENT_NODE&&n.nodeType!==kn.DOCUMENT_FRAGMENT_NODE||(n.nodeType===kn.ELEMENT_NODE&&n.shadowRoot&&e(n.shadowRoot,o),n.childNodes.forEach((t=>e(t,o))))}(e,null),r}class Qn{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return-1;const r=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=r?r:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e)))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)}replace(e,t){const r=this.getNode(e);if(r){const e=this.nodeMetaMap.get(r);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Jn(e,t){switch(e.RRNodeType){case hn.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case hn.DocumentType:{const r=e;return{id:t,type:e.RRNodeType,name:r.name,publicId:r.publicId,systemId:r.systemId}}case hn.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case hn.Text:case hn.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case hn.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}function Zn(e){return{all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map((function(e){e(r)})),(n=e.get("*"))&&n.slice().map((function(e){e(t,r)}))}}}function es(e=window,t=document){if("scrollBehavior"in t.documentElement.style&&!0!==e.__forceSmoothScrollPolyfill__)return;const r=e.HTMLElement||e.Element,n=468,s={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:r.prototype.scroll||l,scrollIntoView:r.prototype.scrollIntoView},o=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now;const i=(a=e.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(a)?1:0);var a;function l(e,t){this.scrollLeft=e,this.scrollTop=t}function c(e){if(null===e||"object"!=typeof e||void 0===e.behavior||"auto"===e.behavior||"instant"===e.behavior)return!0;if("object"==typeof e&&"smooth"===e.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+e.behavior+" is not a valid value for enumeration ScrollBehavior.")}function d(e,t){return"Y"===t?e.clientHeight+i<e.scrollHeight:"X"===t?e.clientWidth+i<e.scrollWidth:void 0}function u(t,r){const n=e.getComputedStyle(t,null)["overflow"+r];return"auto"===n||"scroll"===n}function h(e){const t=d(e,"Y")&&u(e,"Y"),r=d(e,"X")&&u(e,"X");return t||r}function p(t){let r,s,i,a=(o()-t.startTime)/n;var l;a=a>1?1:a,l=a,r=.5*(1-Math.cos(Math.PI*l)),s=t.startX+(t.x-t.startX)*r,i=t.startY+(t.y-t.startY)*r,t.method.call(t.scrollable,s,i),s===t.x&&i===t.y||e.requestAnimationFrame(p.bind(e,t))}function m(r,n,i){let a,c,d,u;const h=o();r===t.body?(a=e,c=e.scrollX||e.pageXOffset,d=e.scrollY||e.pageYOffset,u=s.scroll):(a=r,c=r.scrollLeft,d=r.scrollTop,u=l),p({scrollable:a,method:u,startTime:h,startX:c,startY:d,x:n,y:i})}e.scroll=e.scrollTo=function(){void 0!==arguments[0]&&(!0!==c(arguments[0])?m.call(e,t.body,void 0!==arguments[0].left?~~arguments[0].left:e.scrollX||e.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:e.scrollY||e.pageYOffset):s.scroll.call(e,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:e.scrollX||e.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:e.scrollY||e.pageYOffset))},e.scrollBy=function(){void 0!==arguments[0]&&(c(arguments[0])?s.scrollBy.call(e,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0):m.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset)))},r.prototype.scroll=r.prototype.scrollTo=function(){if(void 0===arguments[0])return;if(!0===c(arguments[0])){if("number"==typeof arguments[0]&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");return void s.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!=typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}const e=arguments[0].left,t=arguments[0].top;m.call(this,this,void 0===e?this.scrollLeft:~~e,void 0===t?this.scrollTop:~~t)},r.prototype.scrollBy=function(){void 0!==arguments[0]&&(!0!==c(arguments[0])?this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}):s.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop))},r.prototype.scrollIntoView=function(){if(!0===c(arguments[0]))return void s.scrollIntoView.call(this,void 0===arguments[0]||arguments[0]);const r=function(e){for(;e!==t.body&&!1===h(e);)e=e.parentNode||e.host;return e}(this),n=r.getBoundingClientRect(),o=this.getBoundingClientRect();r!==t.body?(m.call(this,r,r.scrollLeft+o.left-n.left,r.scrollTop+o.top-n.top),"fixed"!==e.getComputedStyle(r).position&&e.scrollBy({left:n.left,top:n.top,behavior:"smooth"})):e.scrollBy({left:o.left,top:o.top,behavior:"smooth"})}}class ts{constructor(e=[],t){this.timeOffset=0,this.raf=null,this.actions=e,this.speed=t.speed}addAction(e){const t=!0===this.raf;if(!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay)this.actions.push(e);else{const t=this.findActionIndex(e);this.actions.splice(t,0,e)}t&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){const e=performance.now();for(this.timeOffset+=(e-this.lastTimestamp)*this.speed,this.lastTimestamp=e;this.actions.length;){const e=this.actions[0];if(!(this.timeOffset>=e.delay))break;this.actions.shift(),e.doAction()}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(!0!==this.raf&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}isActive(){return null!==this.raf}findActionIndex(e){let t=0,r=this.actions.length-1;for(;t<=r;){const n=Math.floor((t+r)/2);if(this.actions[n].delay<e.delay)t=n+1;else{if(!(this.actions[n].delay>e.delay))return n+1;r=n-1}}return t}}function rs(e,t){if(e.type===Pe.IncrementalSnapshot&&e.data.source===Ue.MouseMove&&e.data.positions&&e.data.positions.length){const r=e.data.positions[0].timeOffset,n=e.timestamp+r;return e.delay=n-t,n-t}return e.delay=e.timestamp-t,e.delay}function ns(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,s,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(s)throw s.error}}return i}var ss;!function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(ss||(ss={}));var os={type:"xstate.init"};function is(e){return void 0===e?[]:[].concat(e)}function as(e){return{type:"xstate.assign",assignment:e}}function ls(e,t){return"string"==typeof(e="string"==typeof e&&t&&t[e]?t[e]:e)?{type:e}:"function"==typeof e?{type:e.name,exec:e}:e}function cs(e){return function(t){return e===t}}function ds(e){return"string"==typeof e?{type:e}:e}function us(e,t){return{value:e,context:t,actions:[],changed:!1,matches:cs(e)}}function hs(e,t,r){var n=t,s=!1;return[e.filter((function(e){if("xstate.assign"===e.type){s=!0;var t=Object.assign({},n);return"function"==typeof e.assignment?t=e.assignment(n,r):Object.keys(e.assignment).forEach((function(s){t[s]="function"==typeof e.assignment[s]?e.assignment[s](n,r):e.assignment[s]})),n=t,!1}return!0})),n,s]}function ps(e,t){void 0===t&&(t={});var r=ns(hs(is(e.states[e.initial].entry).map((function(e){return ls(e,t.actions)})),e.context,os),2),n=r[0],s=r[1],o={config:e,_options:t,initialState:{value:e.initial,actions:n,context:s,matches:cs(e.initial)},transition:function(t,r){var n,s,i="string"==typeof t?{value:t,context:e.context}:t,a=i.value,l=i.context,c=ds(r),d=e.states[a];if(d.on){var u=is(d.on[c.type]);try{for(var h=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(u),p=h.next();!p.done;p=h.next()){var m=p.value;if(void 0===m)return us(a,l);var f="string"==typeof m?{target:m}:m,g=f.target,y=f.actions,v=void 0===y?[]:y,S=f.cond,b=void 0===S?function(){return!0}:S,E=void 0===g,w=null!=g?g:a,T=e.states[w];if(b(l,c)){var I=ns(hs((E?is(v):[].concat(d.exit,v,T.entry).filter((function(e){return e}))).map((function(e){return ls(e,o._options.actions)})),l,c),3),M=I[0],N=I[1],C=I[2],O=null!=g?g:a;return{value:O,context:N,actions:M,changed:g!==a||M.length>0||C,matches:cs(O)}}}}catch(e){n={error:e}}finally{try{p&&!p.done&&(s=h.return)&&s.call(h)}finally{if(n)throw n.error}}}return us(a,l)}};return o}var ms=function(e,t){return e.actions.forEach((function(r){var n=r.exec;return n&&n(e.context,t)}))};function fs(e){var t=e.initialState,r=ss.NotStarted,n=new Set,s={_machine:e,send:function(s){r===ss.Running&&(t=e.transition(t,s),ms(t,ds(s)),n.forEach((function(e){return e(t)})))},subscribe:function(e){return n.add(e),e(t),{unsubscribe:function(){return n.delete(e)}}},start:function(n){if(n){var o="object"==typeof n?n:{context:e.config.context,value:n};t={value:o.value,actions:[],context:o.context,matches:cs(o.value)}}return r=ss.Running,ms(t,os),s},stop:function(){return r=ss.Stopped,n.clear(),s},get state(){return t},get status(){return r}};return s}function gs(e,{getCastFn:t,applyEventsSynchronously:r,emitter:n}){const s=ps({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:as({lastPlayedEvent:(e,t)=>"CAST_EVENT"===t.type?t.payload.event:e.lastPlayedEvent}),recordTimeOffset:as(((e,t)=>{let r=e.timeOffset;return"payload"in t&&"timeOffset"in t.payload&&(r=t.payload.timeOffset),Object.assign(Object.assign({},e),{timeOffset:r,baselineTime:e.events[0].timestamp+r})})),play(e){var s;const{timer:o,events:i,baselineTime:a,lastPlayedEvent:l}=e;o.clear();for(const e of i)rs(e,a);const c=function(e,t){for(let r=e.length-1;r>=0;r--){const n=e[r];if(n.type===Pe.Meta&&n.timestamp<=t)return e.slice(r)}return e}(i,a);let d=null==l?void 0:l.timestamp;(null==l?void 0:l.type)===Pe.IncrementalSnapshot&&l.data.source===Ue.MouseMove&&(d=l.timestamp+(null===(s=l.data.positions[0])||void 0===s?void 0:s.timeOffset)),a<(d||0)&&n.emit(Ve.PlayBack);const u=new Array;for(const e of c)if(!(d&&d<a&&(e.timestamp<=d||e===l)))if(e.timestamp<a)u.push(e);else{const r=t(e,!1);o.addAction({doAction:()=>{r()},delay:e.delay})}r(u),n.emit(Ve.Flush),o.start()},pause(e){e.timer.clear()},resetLastPlayedEvent:as((e=>Object.assign(Object.assign({},e),{lastPlayedEvent:null}))),startLive:as({baselineTime:(e,t)=>(e.timer.start(),"TO_LIVE"===t.type&&t.payload.baselineTime?t.payload.baselineTime:Date.now())}),addEvent:as(((e,r)=>{const{baselineTime:n,timer:s,events:o}=e;if("ADD_EVENT"===r.type){const{event:e}=r.payload;rs(e,n);let i=o.length-1;if(!o[i]||o[i].timestamp<=e.timestamp)o.push(e);else{let t=-1,r=0;for(;r<=i;){const t=Math.floor((r+i)/2);o[t].timestamp<=e.timestamp?r=t+1:i=t-1}-1===t&&(t=r),o.splice(t,0,e)}const a=e.timestamp<n,l=t(e,a);a?l():s.isActive()&&s.addAction({doAction:()=>{l()},delay:e.delay})}return Object.assign(Object.assign({},e),{events:o})}))}});return fs(s)}class ys{constructor(e){this.mediaMap=new Map,this.metadataCallbackMap=new Map,this.warn=e.warn,this.service=e.service,this.speedService=e.speedService,this.emitter=e.emitter,this.getCurrentTime=e.getCurrentTime,this.emitter.on(Ve.Start,this.start.bind(this)),this.emitter.on(Ve.SkipStart,this.start.bind(this)),this.emitter.on(Ve.Pause,this.pause.bind(this)),this.emitter.on(Ve.Finish,this.pause.bind(this)),this.speedService.subscribe((()=>{this.syncAllMediaElements()}))}syncAllMediaElements(e={pause:!1}){this.mediaMap.forEach(((t,r)=>{this.syncTargetWithState(r),e.pause&&r.pause()}))}start(){this.syncAllMediaElements()}pause(){this.syncAllMediaElements({pause:!0})}seekTo({time:e,target:t,mediaState:r}){if(r.isPlaying){const n=(e-r.lastInteractionTimeOffset)/1e3*r.playbackRate,s="duration"in t&&t.duration;if(Number.isNaN(s))return void this.waitForMetadata(t);let o=r.currentTimeAtLastInteraction+n;t.loop&&!1!==s&&(o%=s),t.currentTime=o}else t.pause(),t.currentTime=r.currentTimeAtLastInteraction}waitForMetadata(e){if(this.metadataCallbackMap.has(e))return;if(!("addEventListener"in e))return;const t=()=>{this.metadataCallbackMap.delete(e);const t=this.mediaMap.get(e);t&&this.seekTo({time:this.getCurrentTime(),target:e,mediaState:t})};this.metadataCallbackMap.set(e,t),e.addEventListener("loadedmetadata",t,{once:!0})}getMediaStateFromMutation({target:e,timeOffset:t,mutation:r}){var n,s,o,i,a;const l=this.mediaMap.get(e),{type:c,playbackRate:d,currentTime:u,muted:h,volume:p,loop:m}=r;return{isPlaying:0===c||1!==c&&((null==l?void 0:l.isPlaying)||null!==e.getAttribute("autoplay")),currentTimeAtLastInteraction:null!==(n=null!=u?u:null==l?void 0:l.currentTimeAtLastInteraction)&&void 0!==n?n:0,lastInteractionTimeOffset:t,playbackRate:null!==(s=null!=d?d:null==l?void 0:l.playbackRate)&&void 0!==s?s:1,volume:null!==(o=null!=p?p:null==l?void 0:l.volume)&&void 0!==o?o:1,muted:null!==(i=null!=h?h:null==l?void 0:l.muted)&&void 0!==i?i:null===e.getAttribute("muted"),loop:null!==(a=null!=m?m:null==l?void 0:l.loop)&&void 0!==a?a:null===e.getAttribute("loop")}}syncTargetWithState(e){const t=this.mediaMap.get(e);if(!t)return;const{muted:r,loop:n,volume:s,isPlaying:o}=t,i=this.service.state.matches("paused"),a=t.playbackRate*this.speedService.state.context.timer.speed;try{this.seekTo({time:this.getCurrentTime(),target:e,mediaState:t}),e.volume!==s&&(e.volume=s),e.muted=r,e.loop=n,e.playbackRate!==a&&(e.playbackRate=a),o&&!i?e.play():e.pause()}catch(e){this.warn(`Failed to replay media interactions: ${e.message||e}`)}}addMediaElements(e,t,r){if(!["AUDIO","VIDEO"].includes(e.nodeName))return;const n=e,s=r.getMeta(n);if(!s||!("attributes"in s))return;const o=this.service.state.matches("paused"),i=s.attributes;let a=!1;a=i.rr_mediaState?"played"===i.rr_mediaState:null!==n.getAttribute("autoplay"),a&&o&&n.pause();let l=1;"number"==typeof i.rr_mediaPlaybackRate&&(l=i.rr_mediaPlaybackRate);let c=!1;c="boolean"==typeof i.rr_mediaMuted?i.rr_mediaMuted:null!==n.getAttribute("muted");let d=!1;d="boolean"==typeof i.rr_mediaLoop?i.rr_mediaLoop:null!==n.getAttribute("loop");let u=1;"number"==typeof i.rr_mediaVolume&&(u=i.rr_mediaVolume);let h=0;"number"==typeof i.rr_mediaCurrentTime&&(h=i.rr_mediaCurrentTime),this.mediaMap.set(n,{isPlaying:a,currentTimeAtLastInteraction:h,lastInteractionTimeOffset:t,playbackRate:l,volume:u,muted:c,loop:d}),this.syncTargetWithState(n)}mediaMutation({target:e,timeOffset:t,mutation:r}){this.mediaMap.set(e,this.getMediaStateFromMutation({target:e,timeOffset:t,mutation:r})),this.syncTargetWithState(e)}isSupportedMediaElement(e){return["AUDIO","VIDEO"].includes(e.nodeName)}reset(){this.mediaMap.clear()}}const vs=Zn||o,Ss="[replayer]",bs={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Es(e){return e.type==Pe.IncrementalSnapshot&&(e.data.source==Ue.TouchMove||e.data.source==Ue.MouseInteraction&&e.data.type==Fe.TouchStart)}class ws{get timer(){return this.service.state.context.timer}constructor(e,t){if(this.usingVirtualDom=!1,this.virtualDom=new Bn,this.mouseTail=null,this.tailPositions=[],this.emitter=vs(),this.legacy_missingNodeRetryMap={},this.cache=te(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=h(),this.styleMirror=new Re,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastMouseDownEvent=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=e=>{this.iframe.style.display="inherit";for(const t of[this.mouseTail,this.iframe])t&&(t.setAttribute("width",String(e.width)),t.setAttribute("height",String(e.height)))},this.applyEventsSynchronously=e=>{for(const t of e){switch(t.type){case Pe.DomContentLoaded:case Pe.Load:case Pe.Custom:continue;case Pe.FullSnapshot:case Pe.Meta:case Pe.Plugin:case Pe.IncrementalSnapshot:}this.getCastFn(t,!0)()}},this.getCastFn=(e,t=!1)=>{let r;switch(e.type){case Pe.DomContentLoaded:case Pe.Load:break;case Pe.Custom:r=()=>{this.emitter.emit(Ve.CustomEvent,e)};break;case Pe.Meta:r=()=>this.emitter.emit(Ve.Resize,{width:e.data.width,height:e.data.height});break;case Pe.FullSnapshot:r=()=>{var r;if(this.firstFullSnapshot){if(this.firstFullSnapshot===e)return void(this.firstFullSnapshot=!0)}else this.firstFullSnapshot=!0;this.mediaManager.reset(),this.styleMirror.reset(),this.rebuildFullSnapshot(e,t),null===(r=this.iframe.contentWindow)||void 0===r||r.scrollTo(e.data.initialOffset)};break;case Pe.IncrementalSnapshot:r=()=>{if(this.applyIncremental(e,t),!t&&(e===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const t of this.service.state.context.events)if(!(t.timestamp<=e.timestamp)&&this.isUserInteraction(t)){t.delay-e.delay>this.config.inactivePeriodThreshold*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=t);break}if(this.nextUserInteractionEvent){const t=this.nextUserInteractionEvent.delay-e.delay,r={speed:Math.min(Math.round(t/5e3),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:r}),this.emitter.emit(Ve.SkipStart,r)}}}}return()=>{r&&r();for(const r of this.config.plugins||[])r.handler&&r.handler(e,t,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:e}});const n=this.service.state.context.events.length-1;if(!this.config.liveMode&&e===this.service.state.context.events[n]){const t=()=>{n<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(Ve.Finish))};let r=50;e.type===Pe.IncrementalSnapshot&&e.data.source===Ue.MouseMove&&e.data.positions.length&&(r+=Math.max(0,-e.data.positions[0].timeOffset)),setTimeout(t,r)}this.emitter.emit(Ve.EventCast,e)}},!(null==t?void 0:t.liveMode)&&e.length<2)throw new Error("Replayer need at least 2 events.");const r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,inactivePeriodThreshold:1e4,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:bs,useVirtualDom:!0,logger:console};this.config=Object.assign({},r,t),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(Ve.Resize,this.handleResize),this.setupDom();for(const e of this.config.plugins||[])e.getMirror&&e.getMirror({nodeMirror:this.mirror});this.emitter.on(Ve.Flush,(()=>{if(this.usingVirtualDom){const e={mirror:this.mirror,applyCanvas:(e,t,r)=>{un({event:e,mutation:t,target:r,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(e,t)=>{e.source===Ue.StyleSheetRule?this.applyStyleSheetRule(e,t):e.source===Ue.StyleDeclaration&&this.applyStyleDeclaration(e,t)},afterAppend:(e,t)=>{for(const r of this.config.plugins||[])r.onBuild&&r.onBuild(e,{id:t,replayer:this})}};if(this.iframe.contentDocument)try{Ln(this.iframe.contentDocument,this.virtualDom,e,this.virtualDom.mirror)}catch(e){console.warn(e)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const t in this.legacy_missingNodeRetryMap)try{const r=this.legacy_missingNodeRetryMap[t],n=Pn(r.node,this.mirror,this.virtualDom.mirror);Ln(n,r.node,e,this.virtualDom.mirror),r.node=n}catch(e){this.warn(e)}this.constructedStyleMutations.forEach((e=>{this.applyStyleSheetMutation(e)})),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach((e=>{this.applyAdoptedStyleSheet(e)})),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),!0===this.touchActive?this.mouse.classList.add("touch-active"):!1===this.touchActive&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){const[e,t]=this.lastMouseDownEvent;e.dispatchEvent(t)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)})),this.emitter.on(Ve.PlayBack,(()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset()}));const n=new ts([],{speed:this.config.speed});this.service=gs({events:e.map((e=>t&&t.unpackFn?t.unpackFn(e):e)).sort(((e,t)=>e.timestamp-t.timestamp)),timer:n,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe((e=>{this.emitter.emit(Ve.StateChange,{player:e})})),this.speedService=fs(ps({id:"speed",context:{normalSpeed:-1,timer:n},initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(e,t)=>{"payload"in t&&e.timer.setSpeed(t.payload.speed)},recordSpeed:as({normalSpeed:e=>e.timer.speed}),restoreSpeed:e=>{e.timer.setSpeed(e.normalSpeed)}}})),this.speedService.start(),this.speedService.subscribe((e=>{this.emitter.emit(Ve.StateChange,{speed:e})})),this.mediaManager=new ys({warn:this.warn.bind(this),service:this.service,speedService:this.speedService,emitter:this.emitter,getCurrentTime:this.getCurrentTime.bind(this)});const s=this.service.state.context.events.find((e=>e.type===Pe.Meta)),o=this.service.state.context.events.find((e=>e.type===Pe.FullSnapshot));if(s){const{width:e,height:t}=s.data;setTimeout((()=>{this.emitter.emit(Ve.Resize,{width:e,height:t})}),0)}o&&setTimeout((()=>{var e;this.firstFullSnapshot||(this.firstFullSnapshot=o,this.rebuildFullSnapshot(o),null===(e=this.iframe.contentWindow)||void 0===e||e.scrollTo(o.data.initialOffset))}),1),this.service.state.context.events.find(Es)&&this.mouse.classList.add("touch-device")}on(e,t){return this.emitter.on(e,t),this}off(e,t){return this.emitter.off(e,t),this}setConfig(e){Object.keys(e).forEach((t=>{e[t],this.config[t]=e[t]})),this.config.skipInactive||this.backToNormal(),void 0!==e.speed&&this.speedService.send({type:"SET_SPEED",payload:{speed:e.speed}}),void 0!==e.mouseTail&&(!1===e.mouseTail?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const e=this.service.state.context.events[0],t=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:t.timestamp,totalTime:t.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:e,events:t}=this.service.state.context;return e-t[0].timestamp}getMirror(){return this.mirror}play(e=0){var t,r;this.service.state.matches("paused")||this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}}),null===(r=null===(t=this.iframe.contentDocument)||void 0===t?void 0:t.getElementsByTagName("html")[0])||void 0===r||r.classList.remove("rrweb-paused"),this.emitter.emit(Ve.Start)}pause(e){var t,r;void 0===e&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),"number"==typeof e&&(this.play(e),this.service.send({type:"PAUSE"})),null===(r=null===(t=this.iframe.contentDocument)||void 0===t?void 0:t.getElementsByTagName("html")[0])||void 0===r||r.classList.add("rrweb-paused"),this.emitter.emit(Ve.Pause)}resume(e=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(Ve.Resume)}destroy(){this.pause(),this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset(),this.config.root.removeChild(this.wrapper),this.emitter.emit(Ve.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){const t=this.config.unpackFn?this.config.unpackFn(e):e;Es(t)&&this.mouse.classList.add("touch-device"),Promise.resolve().then((()=>this.service.send({type:"ADD_EVENT",payload:{event:t}})))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=te()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),!1!==this.config.mouseTail&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(es(this.iframe.contentWindow,this.iframe.contentDocument),Ee(this.iframe.contentWindow))}rebuildFullSnapshot(e,t=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const r=[],n=(t,n)=>{if(this.collectIframeAndAttachDocument(r,t),this.mediaManager.isSupportedMediaElement(t)){const{events:r}=this.service.state.context;this.mediaManager.addMediaElements(t,e.timestamp-r[0].timestamp,this.mirror)}for(const e of this.config.plugins||[])e.onBuild&&e.onBuild(t,{id:n,replayer:this})};this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),se(e.data.node,{doc:this.iframe.contentDocument,afterAppend:n,cache:this.cache,mirror:this.mirror}),n(this.iframe.contentDocument,e.data.node.id);for(const{mutationInQueue:e,builtNode:t}of r)this.attachDocumentToIframe(e,t),this.newDocumentQueue=this.newDocumentQueue.filter((t=>t!==e));const{documentElement:s,head:o}=this.iframe.contentDocument;this.insertStyleRules(s,o),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(Ve.FullsnapshotRebuilded,e),t||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,t){var r;const n=(s=this.config.blockClass,[`.${s} { background: currentColor }`,"noscript { display: none !important; }"]).concat(this.config.insertStyleRules);var s;if(this.config.pauseAnimation&&n.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const r=this.virtualDom.createElement("style");this.virtualDom.mirror.add(r,Jn(r,this.virtualDom.unserializedId)),e.insertBefore(r,t),r.rules.push({source:Ue.StyleSheetRule,adds:n.map(((e,t)=>({rule:e,index:t})))})}else{const s=document.createElement("style");e.insertBefore(s,t);for(let e=0;e<n.length;e++)null===(r=s.sheet)||void 0===r||r.insertRule(n[e],e)}}attachDocumentToIframe(e,t){const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,n=[],o=(e,o)=>{this.collectIframeAndAttachDocument(n,e);const i=r.getMeta(e);if((null==i?void 0:i.type)===s.Element&&"HTML"===(null==i?void 0:i.tagName.toUpperCase())){const{documentElement:e,head:r}=t.contentDocument;this.insertStyleRules(e,r)}if(!this.usingVirtualDom)for(const t of this.config.plugins||[])t.onBuild&&t.onBuild(e,{id:o,replayer:this})};ne(e.node,{doc:t.contentDocument,mirror:r,hackCss:!0,skipChild:!1,afterAppend:o,cache:this.cache}),o(t.contentDocument,e.node.id);for(const{mutationInQueue:e,builtNode:t}of n)this.attachDocumentToIframe(e,t),this.newDocumentQueue=this.newDocumentQueue.filter((t=>t!==e))}collectIframeAndAttachDocument(e,t){if(Ie(t,this.mirror)){const r=this.newDocumentQueue.find((e=>e.parentId===this.mirror.getId(t)));r&&e.push({mutationInQueue:r,builtNode:t})}}waitForStylesheetLoad(){var e;const t=null===(e=this.iframe.contentDocument)||void 0===e?void 0:e.head;if(t){const e=new Set;let r,n=this.service.state;const s=()=>{n=this.service.state};this.emitter.on(Ve.Start,s),this.emitter.on(Ve.Pause,s);const o=()=>{this.emitter.off(Ve.Start,s),this.emitter.off(Ve.Pause,s)};t.querySelectorAll('link[rel="stylesheet"]').forEach((t=>{t.sheet||(e.add(t),t.addEventListener("load",(()=>{e.delete(t),0===e.size&&-1!==r&&(n.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(Ve.LoadStylesheetEnd),r&&clearTimeout(r),o())})))})),e.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(Ve.LoadStylesheetStart),r=setTimeout((()=>{n.matches("playing")&&this.play(this.getCurrentTime()),r=-1,o()}),this.config.loadTimeout))}}preloadAllImages(){return vt(this,void 0,void 0,(function*(){this.service.state;const e=()=>{this.service.state};this.emitter.on(Ve.Start,e),this.emitter.on(Ve.Pause,e);const t=[];for(const e of this.service.state.context.events)if(e.type===Pe.IncrementalSnapshot&&e.data.source===Ue.CanvasMutation){t.push(this.deserializeAndPreloadCanvasEvents(e.data,e));("commands"in e.data?e.data.commands:[e.data]).forEach((t=>{this.preloadImages(t,e)}))}return Promise.all(t)}))}preloadImages(e,t){if("drawImage"===e.property&&"string"==typeof e.args[0]&&!this.imageMap.has(t)){const t=document.createElement("canvas"),r=t.getContext("2d"),n=null==r?void 0:r.createImageData(t.width,t.height);null==n||n.data,JSON.parse(e.args[0]),null==r||r.putImageData(n,0,0)}}deserializeAndPreloadCanvasEvents(e,t){return vt(this,void 0,void 0,(function*(){if(!this.canvasEventMap.has(t)){const r={isUnchanged:!0};if("commands"in e){const n=yield Promise.all(e.commands.map((e=>vt(this,void 0,void 0,(function*(){const t=yield Promise.all(e.args.map(ln(this.imageMap,null,r)));return Object.assign(Object.assign({},e),{args:t})})))));!1===r.isUnchanged&&this.canvasEventMap.set(t,Object.assign(Object.assign({},e),{commands:n}))}else{const n=yield Promise.all(e.args.map(ln(this.imageMap,null,r)));!1===r.isUnchanged&&this.canvasEventMap.set(t,Object.assign(Object.assign({},e),{args:n}))}}}))}applyIncremental(e,t){var r,n,s;const{data:o}=e;switch(o.source){case Ue.Mutation:try{this.applyMutation(o,t)}catch(e){this.warn(`Exception in mutation ${e.message||e}`,o)}break;case Ue.Drag:case Ue.TouchMove:case Ue.MouseMove:if(t){const e=o.positions[o.positions.length-1];this.mousePos={x:e.x,y:e.y,id:e.id,debugData:o}}else o.positions.forEach((r=>{const n={doAction:()=>{this.moveAndHover(r.x,r.y,r.id,t,o)},delay:r.timeOffset+e.timestamp-this.service.state.context.baselineTime};this.timer.addAction(n)})),this.timer.addAction({doAction(){},delay:e.delay-(null===(r=o.positions[0])||void 0===r?void 0:r.timeOffset)});break;case Ue.MouseInteraction:{if(-1===o.id)break;const e=new Event(f(Fe[o.type])),r=this.mirror.getNode(o.id);if(!r)return this.debugNodeNotFound(o,o.id);this.emitter.emit(Ve.MouseInteraction,{type:o.type,target:r});const{triggerFocus:n}=this.config;switch(o.type){case Fe.Blur:"blur"in r&&r.blur();break;case Fe.Focus:n&&r.focus&&r.focus({preventScroll:!0});break;case Fe.Click:case Fe.TouchStart:case Fe.TouchEnd:case Fe.MouseDown:case Fe.MouseUp:t?(o.type===Fe.TouchStart?this.touchActive=!0:o.type===Fe.TouchEnd&&(this.touchActive=!1),o.type===Fe.MouseDown?this.lastMouseDownEvent=[r,e]:o.type===Fe.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:o.x||0,y:o.y||0,id:o.id,debugData:o}):(o.type===Fe.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(o.x||0,o.y||0,o.id,t,o),o.type===Fe.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):o.type===Fe.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):o.type===Fe.TouchEnd?this.mouse.classList.remove("touch-active"):r.dispatchEvent(e));break;case Fe.TouchCancel:t?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:r.dispatchEvent(e)}break}case Ue.Scroll:if(-1===o.id)break;if(this.usingVirtualDom){const e=this.virtualDom.mirror.getNode(o.id);if(!e)return this.debugNodeNotFound(o,o.id);e.scrollData=o;break}this.applyScroll(o,t);break;case Ue.ViewportResize:this.emitter.emit(Ve.Resize,{width:o.width,height:o.height});break;case Ue.Input:if(-1===o.id)break;if(this.usingVirtualDom){const e=this.virtualDom.mirror.getNode(o.id);if(!e)return this.debugNodeNotFound(o,o.id);e.inputData=o;break}this.applyInput(o);break;case Ue.MediaInteraction:{const t=this.usingVirtualDom?this.virtualDom.mirror.getNode(o.id):this.mirror.getNode(o.id);if(!t)return this.debugNodeNotFound(o,o.id);const r=t,{events:n}=this.service.state.context;this.mediaManager.mediaMutation({target:r,timeOffset:e.timestamp-n[0].timestamp,mutation:o});break}case Ue.StyleSheetRule:case Ue.StyleDeclaration:this.usingVirtualDom?o.styleId?this.constructedStyleMutations.push(o):o.id&&(null===(n=this.virtualDom.mirror.getNode(o.id))||void 0===n||n.rules.push(o)):this.applyStyleSheetMutation(o);break;case Ue.CanvasMutation:if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const t=this.virtualDom.mirror.getNode(o.id);if(!t)return this.debugNodeNotFound(o,o.id);t.canvasMutations.push({event:e,mutation:o})}else{const t=this.mirror.getNode(o.id);if(!t)return this.debugNodeNotFound(o,o.id);un({event:e,mutation:o,target:t,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break;case Ue.Font:try{const e=new FontFace(o.family,o.buffer?new Uint8Array(JSON.parse(o.fontSource)):o.fontSource,o.descriptors);null===(s=this.iframe.contentDocument)||void 0===s||s.fonts.add(e)}catch(e){this.warn(e)}break;case Ue.Selection:if(t){this.lastSelectionData=o;break}this.applySelection(o);break;case Ue.AdoptedStyleSheet:this.usingVirtualDom?this.adoptedStyleSheets.push(o):this.applyAdoptedStyleSheet(o)}}applyMutation(e,t){if(this.config.useVirtualDom&&!this.usingVirtualDom&&t&&(this.usingVirtualDom=!0,Kn(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const e in this.legacy_missingNodeRetryMap)try{const t=this.legacy_missingNodeRetryMap[e],r=Xn(t.node,this.virtualDom,this.mirror);r&&(t.node=r)}catch(e){this.warn(e)}const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;e.removes=e.removes.filter((t=>!!r.getNode(t.id)||(this.warnNodeNotFound(e,t.id),!1))),e.removes.forEach((t=>{var n;const s=r.getNode(t.id);if(!s)return;let o=r.getNode(t.parentId);if(!o)return this.warnNodeNotFound(e,t.parentId);if(t.isShadow&&Ce(o)&&(o=o.shadowRoot),r.removeNodeFromMap(s),o)try{o.removeChild(s),this.usingVirtualDom&&"#text"===s.nodeName&&"STYLE"===o.nodeName&&(null===(n=o.rules)||void 0===n?void 0:n.length)>0&&(o.rules=[])}catch(t){if(!(t instanceof DOMException))throw t;this.warn("parent could not remove child in mutation",o,s,e)}}));const n=Object.assign({},this.legacy_missingNodeRetryMap),o=[],i=e=>{var t,i;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let a=r.getNode(e.parentId);if(!a)return e.node.type===s.Document?this.newDocumentQueue.push(e):o.push(e);e.node.isShadow&&(Ce(a)||a.attachShadow({mode:"open"}),a=a.shadowRoot);let l=null,c=null;if(e.previousId&&(l=r.getNode(e.previousId)),e.nextId&&(c=r.getNode(e.nextId)),(e=>{let t=null;return e.nextId&&(t=r.getNode(e.nextId)),null!==e.nextId&&void 0!==e.nextId&&-1!==e.nextId&&!t})(e))return o.push(e);if(e.node.rootId&&!r.getNode(e.node.rootId))return;const d=e.node.rootId?r.getNode(e.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Ie(a,r))return void this.attachDocumentToIframe(e,a);const u=(e,t)=>{if(!this.usingVirtualDom)for(const r of this.config.plugins||[])r.onBuild&&r.onBuild(e,{id:t,replayer:this})},h=ne(e.node,{doc:d,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:u});if(-1===e.previousId||-1===e.nextId)return void(n[e.node.id]={node:h,mutation:e});const p=r.getMeta(a);if(p&&p.type===s.Element&&"textarea"===p.tagName&&e.node.type===s.Text){const e=Array.isArray(a.childNodes)?a.childNodes:Array.from(a.childNodes);for(const t of e)t.nodeType===a.TEXT_NODE&&a.removeChild(t)}else if((null==p?void 0:p.type)===s.Document){const r=a;e.node.type===s.DocumentType&&(null===(t=r.childNodes[0])||void 0===t?void 0:t.nodeType)===Node.DOCUMENT_TYPE_NODE&&r.removeChild(r.childNodes[0]),"HTML"===h.nodeName&&r.documentElement&&r.removeChild(r.documentElement)}if(l&&l.nextSibling&&l.nextSibling.parentNode?a.insertBefore(h,l.nextSibling):c&&c.parentNode?a.contains(c)?a.insertBefore(h,c):a.insertBefore(h,null):a.appendChild(h),u(h,e.node.id),this.usingVirtualDom&&"#text"===h.nodeName&&"STYLE"===a.nodeName&&(null===(i=a.rules)||void 0===i?void 0:i.length)>0&&(a.rules=[]),Ie(h,this.mirror)){const e=this.mirror.getId(h),t=this.newDocumentQueue.find((t=>t.parentId===e));t&&(this.attachDocumentToIframe(t,h),this.newDocumentQueue=this.newDocumentQueue.filter((e=>e!==t)))}(e.previousId||e.nextId)&&this.legacy_resolveMissingNode(n,a,h,e)};e.adds.forEach((e=>{i(e)}));const a=Date.now();for(;o.length;){const e=we(o);if(o.length=0,Date.now()-a>500){this.warn("Timeout in the loop, please check the resolve tree data:",e);break}for(const t of e){r.getNode(t.value.parentId)?Te(t,(e=>{i(e)})):this.debug("Drop resolve tree since there is no parent for the root node.",t)}}Object.keys(n).length&&Object.assign(this.legacy_missingNodeRetryMap,n),ke(e.texts).forEach((t=>{var n;const s=r.getNode(t.id);if(!s){if(e.removes.find((e=>e.id===t.id)))return;return this.warnNodeNotFound(e,t.id)}if(s.textContent=t.value,this.usingVirtualDom){const e=s.parentNode;(null===(n=null==e?void 0:e.rules)||void 0===n?void 0:n.length)>0&&(e.rules=[])}})),e.attributes.forEach((t=>{var n;const s=r.getNode(t.id);if(!s){if(e.removes.find((e=>e.id===t.id)))return;return this.warnNodeNotFound(e,t.id)}for(const e in t.attributes)if("string"==typeof e){const o=t.attributes[e];if(null===o)s.removeAttribute(e);else if("string"==typeof o)try{if("_cssText"===e&&("LINK"===s.nodeName||"STYLE"===s.nodeName))try{const e=r.getMeta(s);Object.assign(e.attributes,t.attributes);const n=ne(e,{doc:s.ownerDocument,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache}),o=s.nextSibling,i=s.parentNode;if(n&&i){i.removeChild(s),i.insertBefore(n,o),r.replace(t.id,n);break}}catch(e){}if("value"===e&&"TEXTAREA"===s.nodeName){const e=s;e.childNodes.forEach((t=>e.removeChild(t)));const t=null===(n=s.ownerDocument)||void 0===n?void 0:n.createTextNode(o);t&&e.appendChild(t)}else s.setAttribute(e,o)}catch(e){this.warn("An error occurred may due to the checkout feature.",e)}else if("style"===e){const e=o,t=s;for(const r in e)if(!1===e[r])t.style.removeProperty(r);else if(e[r]instanceof Array){const n=e[r];t.style.setProperty(r,n[0],n[1])}else{const n=e[r];t.style.setProperty(r,n)}}}}))}applyScroll(e,t){var r,n;const o=this.mirror.getNode(e.id);if(!o)return this.debugNodeNotFound(e,e.id);const i=this.mirror.getMeta(o);if(o===this.iframe.contentDocument)null===(r=this.iframe.contentWindow)||void 0===r||r.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else if((null==i?void 0:i.type)===s.Document)null===(n=o.defaultView)||void 0===n||n.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else try{o.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"})}catch(e){}}applyInput(e){const t=this.mirror.getNode(e.id);if(!t)return this.debugNodeNotFound(e,e.id);try{t.checked=e.isChecked,t.value=e.text}catch(e){}}applySelection(e){try{const t=new Set,r=e.ranges.map((({start:e,startOffset:r,end:n,endOffset:s})=>{const o=this.mirror.getNode(e),i=this.mirror.getNode(n);if(!o||!i)return;const a=new Range;a.setStart(o,r),a.setEnd(i,s);const l=o.ownerDocument,c=null==l?void 0:l.getSelection();return c&&t.add(c),{range:a,selection:c}}));t.forEach((e=>e.removeAllRanges())),r.forEach((e=>{var t;return e&&(null===(t=e.selection)||void 0===t?void 0:t.addRange(e.range))}))}catch(e){}}applyStyleSheetMutation(e){var t;let r=null;e.styleId?r=this.styleMirror.getStyle(e.styleId):e.id&&(r=(null===(t=this.mirror.getNode(e.id))||void 0===t?void 0:t.sheet)||null),r&&(e.source===Ue.StyleSheetRule?this.applyStyleSheetRule(e,r):e.source===Ue.StyleDeclaration&&this.applyStyleDeclaration(e,r))}applyStyleSheetRule(e,t){var r,n,s,o;if(null===(r=e.adds)||void 0===r||r.forEach((({rule:e,index:r})=>{try{if(Array.isArray(r)){const{positions:n,index:s}=Ae(r);Oe(t.cssRules,n).insertRule(e,s)}else{const n=void 0===r?void 0:Math.min(r,t.cssRules.length);null==t||t.insertRule(e,n)}}catch(e){}})),null===(n=e.removes)||void 0===n||n.forEach((({index:e})=>{try{if(Array.isArray(e)){const{positions:r,index:n}=Ae(e);Oe(t.cssRules,r).deleteRule(n||0)}else null==t||t.deleteRule(e)}catch(e){}})),e.replace)try{null===(s=t.replace)||void 0===s||s.call(t,e.replace)}catch(e){}if(e.replaceSync)try{null===(o=t.replaceSync)||void 0===o||o.call(t,e.replaceSync)}catch(e){}}applyStyleDeclaration(e,t){if(e.set){Oe(t.rules,e.index).style.setProperty(e.set.property,e.set.value,e.set.priority)}if(e.remove){Oe(t.rules,e.index).style.removeProperty(e.remove.property)}}applyAdoptedStyleSheet(e){var t;const r=this.mirror.getNode(e.id);if(!r)return;null===(t=e.styles)||void 0===t||t.forEach((e=>{var t;let n=null,s=null;if(Ce(r)?s=(null===(t=r.ownerDocument)||void 0===t?void 0:t.defaultView)||null:"#document"===r.nodeName&&(s=r.defaultView),s)try{n=new s.CSSStyleSheet,this.styleMirror.add(n,e.styleId),this.applyStyleSheetRule({source:Ue.StyleSheetRule,adds:e.rules},n)}catch(e){}}));let n=0;const s=(e,t)=>{const r=t.map((e=>this.styleMirror.getStyle(e))).filter((e=>null!==e));Ce(e)?e.shadowRoot.adoptedStyleSheets=r:"#document"===e.nodeName&&(e.adoptedStyleSheets=r),r.length!==t.length&&n<10&&(setTimeout((()=>s(e,t)),0+100*n),n++)};s(r,e.styleIds)}legacy_resolveMissingNode(e,t,r,n){const{previousId:s,nextId:o}=n,i=s&&e[s],a=o&&e[o];if(i){const{node:n,mutation:s}=i;t.insertBefore(n,r),delete e[s.node.id],delete this.legacy_missingNodeRetryMap[s.node.id],(s.previousId||s.nextId)&&this.legacy_resolveMissingNode(e,t,n,s)}if(a){const{node:n,mutation:s}=a;t.insertBefore(n,r.nextSibling),delete e[s.node.id],delete this.legacy_missingNodeRetryMap[s.node.id],(s.previousId||s.nextId)&&this.legacy_resolveMissingNode(e,t,n,s)}}moveAndHover(e,t,r,n,s){const o=this.mirror.getNode(r);if(!o)return this.debugNodeNotFound(s,r);const i=Ne(o,this.iframe),a=e*i.absoluteScale+i.x,l=t*i.absoluteScale+i.y;this.mouse.style.left=`${a}px`,this.mouse.style.top=`${l}px`,n||this.drawMouseTail({x:a,y:l}),this.hoverElements(o)}drawMouseTail(e){if(!this.mouseTail)return;const{lineCap:t,lineWidth:r,strokeStyle:n,duration:s}=!0===this.config.mouseTail?bs:Object.assign({},bs,this.config.mouseTail),o=()=>{if(!this.mouseTail)return;const e=this.mouseTail.getContext("2d");e&&this.tailPositions.length&&(e.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),e.beginPath(),e.lineWidth=r,e.lineCap=t,e.strokeStyle=n,e.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach((t=>e.lineTo(t.x,t.y))),e.stroke())};this.tailPositions.push(e),o(),setTimeout((()=>{this.tailPositions=this.tailPositions.filter((t=>t!==e)),o()}),s/this.speedService.state.context.timer.speed)}hoverElements(e){var t;null===(t=this.lastHoveredRootNode||this.iframe.contentDocument)||void 0===t||t.querySelectorAll(".\\:hover").forEach((e=>{e.classList.remove(":hover")})),this.lastHoveredRootNode=e.getRootNode();let r=e;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(e){return e.type===Pe.IncrementalSnapshot&&(e.data.source>Ue.Mutation&&e.data.source<=Ue.Input)}backToNormal(){this.nextUserInteractionEvent=null,this.speedService.state.matches("normal")||(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(Ve.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,t){this.warn(`Node with id '${t}' not found. `,e)}warnCanvasMutationFailed(e,t){this.warn("Has error on canvas update",t,"canvas mutation:",e)}debugNodeNotFound(e,t){this.debug(`Node with id '${t}' not found. `,e)}warn(...e){this.config.showWarning&&this.config.logger.warn(Ss,...e)}debug(...e){this.config.showDebug&&this.config.logger.log(Ss,...e)}}}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(607)})()));
//# sourceMappingURL=ue-web-bundle.js.map